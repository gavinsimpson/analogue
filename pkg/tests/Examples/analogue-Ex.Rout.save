
R version 2.14.1 Patched (2012-01-10 r58088)
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> pkgname <- "analogue"
> source(file.path(R.home("share"), "R", "examples-header.R"))
> options(warn = 1)
> library('analogue')
Loading required package: vegan
Loading required package: permute
This is vegan 2.0-1
Loading required package: lattice
Loading required package: grid
Loading required package: MASS
Loading required package: princurve
This is analogue 0.8-0
> 
> assign(".oldSearch", search(), pos = 'CheckExEnv')
> cleanEx()
> nameEx("ImbrieKipp")
> ### * ImbrieKipp
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ImbrieKipp
> ### Title: Imbrie and Kipp foraminifera training set
> ### Aliases: ImbrieKipp SumSST WinSST Salinity V12.122
> ### Keywords: datasets
> 
> ### ** Examples
> 
> data(ImbrieKipp)
> head(ImbrieKipp)
        O.univ G.cglob G.ruber G.tenel G.saccu G.rubes G.pacL G.pacR G.bullo
V14.61       0       0    0.00       0    0.00    0.00  98.97   0.90    0.00
V17.196      0       0    0.00       0    0.00    0.00  98.13   0.94    0.47
V18.110      0       0    0.00       0    0.00    0.00  96.29   1.71    1.00
V16.227      0       0    0.00       0    0.00    0.00  94.33   4.82    0.85
V14.47       0       0    0.11       0    0.11    0.11  68.50   2.71   10.95
V23.22       0       0    0.00       0    0.00    0.00  55.69  16.62   19.90
        G.falco G.calid G.aequi G.gluti G.duter G.infla G.trnL G.trnR G.crasf
V14.61        0       0       0    0.00       0    0.00   0.00      0    0.00
V17.196       0       0       0    0.47       0    0.00   0.00      0    0.00
V18.110       0       0       0    0.00       0    0.57   0.00      0    0.00
V16.227       0       0       0    0.00       0    0.00   0.00      0    0.00
V14.47        0       0       0    1.95       0   14.20   0.11      0    0.43
V23.22        0       0       0    2.29       0    1.57   0.00      0    0.00
        G.scitu G.mentu P.obliq C.nitid S.dehis G.digit Other G.quin G.hirsu
V14.61     0.00    0.00    0.00       0       0       0  0.13   0.00    0.00
V17.196    0.00    0.00    0.00       0       0       0  0.00   0.00    0.00
V18.110    0.00    0.00    0.00       0       0       0  0.43   0.00    0.00
V16.227    0.00    0.00    0.00       0       0       0  0.00   0.00    0.00
V14.47     0.11    0.11    0.11       0       0       0  0.18   0.32    0.00
V23.22     0.00    0.00    0.00       0       0       0  0.65   3.14    0.13
> 
> data(SumSST)
> data(WinSST)
> data(Salinity)
> 
> plot(cbind(SumSST, WinSST, Salinity))
> 
> data(V12.122)
> head(V12.122)
    O.univ G.cglob G.ruber G.tenel G.saccu G.rubes G.pacL  G.pacR G.bullo
0  0.01792 0.00489 0.43485 0.00814 0.25570 0.00651      0 0.00163 0.00000
10 0.03203 0.00712 0.37722 0.00356 0.30961 0.00712      0 0.00356 0.00000
20 0.02564 0.01709 0.47009 0.00855 0.20513 0.01709      0 0.01282 0.00427
30 0.01124 0.00562 0.47190 0.01124 0.12360 0.02247      0 0.03933 0.00562
40 0.00671 0.01007 0.43623 0.03020 0.15436 0.01007      0 0.00336 0.00671
50 0.01149 0.00766 0.52873 0.00766 0.12261 0.00000      0 0.00383 0.02299
   G.falco G.calid G.aequi G.gluti G.duter G.infla  G.trnL  G.trnR G.crasf
0  0.00163 0.00326 0.03257 0.08958 0.04560 0.00163 0.00163 0.00000 0.00000
10 0.00000 0.00000 0.02491 0.08185 0.05694 0.00000 0.00712 0.00356 0.00000
20 0.00000 0.00855 0.00855 0.09402 0.05556 0.00000 0.00427 0.00855 0.00000
30 0.00562 0.02247 0.05056 0.07865 0.06742 0.01124 0.00000 0.01685 0.00562
40 0.00336 0.01678 0.08054 0.09396 0.03691 0.04698 0.00336 0.02349 0.01342
50 0.00000 0.01916 0.06897 0.07663 0.04981 0.04215 0.00000 0.02682 0.00766
   G.scitu G.mentu P.obliq C.nitid S.dehis G.digit   Other G.quin G.hirsu
0  0.00163 0.07492 0.00977 0.00651 0.00163       0 0.00000      0       0
10 0.00000 0.05694 0.01423 0.00000 0.00356       0 0.01068      0       0
20 0.00855 0.02991 0.00855 0.00855 0.00000       0 0.00427      0       0
30 0.00562 0.01124 0.02247 0.00000 0.00000       0 0.01124      0       0
40 0.00336 0.01007 0.00671 0.00000 0.00000       0 0.00336      0       0
50 0.00000 0.00000 0.00000 0.00000 0.00000       0 0.00383      0       0
   G.hexag G.cglom cfH.pel
0        0       0       0
10       0       0       0
20       0       0       0
30       0       0       0
40       0       0       0
50       0       0       0
> 
> 
> 
> cleanEx()
> nameEx("Pollen")
> ### * Pollen
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Pollen
> ### Title: North American Modern Pollen Database
> ### Aliases: Pollen Biome Climate Location
> ### Keywords: datasets
> 
> ### ** Examples
> 
> data(Pollen)
> 
> data(Climate)
> 
> data(Biome)
> 
> data(Location)
> 
> 
> 
> cleanEx()
> nameEx("RMSEP")
> ### * RMSEP
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: RMSEP
> ### Title: Root mean square error of prediction
> ### Aliases: RMSEP RMSEP.default RMSEP.mat RMSEP.bootstrap.mat
> ###   RMSEP.bootstrap.wa
> ### Keywords: methods utilities
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## fit the MAT model using the squared chord distance measure
> (ik.mat <- mat(ImbrieKipp, SumSST, method = "chord"))

	Modern Analogue Technique

Call:
mat(x = ImbrieKipp, y = SumSST, method = "chord") 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

Inferences based on the mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.875 0.931    0.284    6.000
  3 1.713 0.941    0.133    5.167
  4 1.796 0.935    0.177    5.125
  5 1.748 0.939    0.209    5.100
  6 1.716 0.943    0.284    5.667
  7 1.763 0.943    0.381    6.429
  8 1.831 0.941    0.390    6.625
  9 1.913 0.940    0.449    7.222
 10 2.040 0.935    0.577    7.500

Inferences based on the weighted mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.894 0.929    0.263    6.183
  3 1.733 0.940    0.138    5.470
  4 1.773 0.937    0.173    5.384
  5 1.750 0.939    0.187    5.366
  6 1.709 0.942    0.218    5.493
  7 1.712 0.942    0.254    5.635
  8 1.758 0.940    0.253    5.693
  9 1.777 0.939    0.274    5.838
 10 1.857 0.935    0.362    5.927

> 
> ## Leave-one-out RMSEP for the MAT model
> RMSEP(ik.mat)
[1] 1.733353
> 
> ## bootstrap training set
> (ik.boot <- bootstrap(ik.mat, n.boot = 100))

	Bootstrap results for palaeoecological models

Model type: MAT 
Weighted mean: FALSE 
Number of bootstrap cycles: 100 

Leave-one-out and bootstrap-derived error estimates:

          k RMSEP     S1    S2 r.squared avg.bias max.bias
LOO       3 1.713      -     -    0.9409   0.1328    5.167
Bootstrap 5 1.953 0.9133 1.726    0.9707   0.3017    5.484

> 
> ## extract the Birks et al (1990) RMSEP
> RMSEP(ik.boot)
[1] 1.952979
> 
> ## Calculate the alternative formulation
> RMSEP(ik.boot, type = "standard")
[1] 1.726244
> 
> 
> 
> cleanEx()
> nameEx("Stratiplot")
> ### * Stratiplot
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Stratiplot
> ### Title: Palaeoecological stratigraphic diagrams
> ### Aliases: Stratiplot Stratiplot.default Stratiplot.formula
> ### Keywords: hplot
> 
> ### ** Examples
> 
> data(V12.122)
> Depths <- as.numeric(rownames(V12.122))
> 
> (plt <- Stratiplot(Depths ~ O.univ + G.ruber + G.tenel + G.pacR,
+                    data = V12.122,  type = c("h","l","g","smooth")))
> 
> ## Order taxa by WA in depth --- ephasises change over time
> (plt <- Stratiplot(Depths ~ O.univ + G.ruber + G.tenel + G.pacR,
+                    data = V12.122, type = c("h"), sort = "wa"))
> 
> ## Using the default interface
> spp.want <- c("O.univ","G.ruber","G.tenel","G.pacR")
> (plt <- Stratiplot(V12.122[, spp.want], y = Depths,
+                    type = c("poly", "g")))
> 
> ## Adding zones to a Stratigraphic plot
> ## Default labelling and draw zone legend
> ## Here we choose 4 arbitrary Depths as the zone boundaries
> set.seed(123)
> Zones <-sample(Depths, 4)
> (plt <- Stratiplot(Depths ~ O.univ + G.ruber + G.tenel + G.pacR,
+                    data = V12.122, type = c("poly","g"),
+                    zones = Zones))
> 
> ## As before, but supplying your own zone labels
> zone.labs <- c("A","B","C","D","E")
> (plt <- Stratiplot(Depths ~ O.univ + G.ruber + G.tenel + G.pacR,
+                    data = V12.122, type = c("poly","g"),
+                    zones = Zones, zoneNames = zone.labs))
> 
> ## Suppress the drawing of the zone legend
> (plt <- Stratiplot(Depths ~ O.univ + G.ruber + G.tenel + G.pacR,
+                    data = V12.122, type = c("poly","g"),
+                    zones = Zones, drawLegend = FALSE))
> 
> ## Add zones and draw a legend, but do not label the zones
> (plt <- Stratiplot(Depths ~ O.univ + G.ruber + G.tenel + G.pacR,
+                    data = V12.122, type = c("poly","g"),
+                    zones = Zones, zoneNames = ""))
> 
> 
> 
> cleanEx()
> nameEx("abernethy")
> ### * abernethy
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: abernethy
> ### Title: Abernethy Forest Pollen Sequence
> ### Aliases: abernethy
> ### Keywords: datasets
> 
> ### ** Examples
> 
> data(abernethy)
> head(abernethy)
  Betula Pinus sylvestris Ulmus Quercus Alnus glutinosa Corylus-Myrica Salix
1  15.11            51.82  2.68    3.44            5.54           6.88  0.00
2  21.00            59.48  0.93    1.86            0.93           7.81  0.93
3   9.26            76.23  0.54    1.09            0.73           7.08  0.00
4  20.70            74.84  0.80    0.48            0.00           0.96  0.16
5   6.07            88.06  0.39    1.37            0.20           1.17  0.20
6  11.32            81.57  1.15    1.34            0.19           2.30  0.58
  Juniperus communis Calluna vulgaris Empetrum Gramineae Cyperaceae
1                  0             7.07     0.76      1.34       4.78
2                  0             3.35     0.74      0.56       2.04
3                  0             2.36     0.36      0.18       2.18
4                  0             0.64     0.00      0.32       0.64
5                  0             0.78     0.59      0.39       0.59
6                  0             0.38     0.00      0.38       0.58
  Solidago-type Compositae Artemisia Caryophyllaceae Sagina Silene
1             0          0         0               0      0      0
2             0          0         0               0      0      0
3             0          0         0               0      0      0
4             0          0         0               0      0      0
5             0          0         0               0      0      0
6             0          0         0               0      0      0
  Chenopodiaceae Epilobium-type Papilionaceae Anthyllis vulneraria
1              0              0             0                    0
2              0              0             0                    0
3              0              0             0                    0
4              0              0             0                    0
5              0              0             0                    0
6              0              0             0                    0
  Astragalus alpinus Ononis-type Rosaceae Rubiaceae Ranunculaceae Thalictrum
1                  0           0     0.00         0             0          0
2                  0           0     0.19         0             0          0
3                  0           0     0.00         0             0          0
4                  0           0     0.00         0             0          0
5                  0           0     0.00         0             0          0
6                  0           0     0.19         0             0          0
  Rumex acetosa-type Oxyria-type Parnassia palustris Saxifraga spp1
1                  0           0                   0              0
2                  0           0                   0              0
3                  0           0                   0              0
4                  0           0                   0              0
5                  0           0                   0              0
6                  0           0                   0              0
  Saxifraga spp2 Sedum Urtica Veronica Depth  Age
1              0     0      0        0   300 5515
2              0     0      0        0   305 5632
3              0     0      0        0   310 5749
4              0     0      0        0   315 5866
5              0     0      0        0   320 5983
6              0     0      0        0   325 6100
> 
> (plt <- Stratiplot(Age ~ . - Depth,
+                    data = chooseTaxa(abernethy, n.occ = 5,
+                                      max.abun = 10),
+                    type = "poly"))
> 
> 
> 
> cleanEx()
> nameEx("analog")
> ### * analog
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: analog
> ### Title: Analogue matching
> ### Aliases: analog analog.default print.analog
> ### Keywords: multivariate
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## Imbrie and Kipp foraminfera sea-surface temperature
> 
> ## analog matching between SWAP and RLGH core
> ik.analog <- analog(ImbrieKipp, V12.122, method = "chord")
> ik.analog

	Analogue matching for fossil samples

Call: analog(x = ImbrieKipp, y = V12.122, method = "chord") 
Dissimilarity: chord 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

	Minimum dissimilarity per sample

Dissimilarity: chord 

    0    10    20    30    40    50    60    70    80    90   100   110   120 
0.900 0.902 0.903 0.904 0.904 0.907 0.907 0.908 0.908 0.908 0.910 0.908 0.910 
  130   140   150   160   170   180   190   200   210   220   230   240   250 
0.909 0.911 0.908 0.908 0.906 0.908 0.909 0.906 0.907 0.906 0.906 0.906 0.906 
  260   270   280   290   300   310   320   330   340   350   360   370   380 
0.906 0.909 0.910 0.907 0.907 0.912 0.910 0.911 0.907 0.908 0.908 0.910 0.908 
  390   400   410   420   430   440   450   460   470   480   490   500   510 
0.910 0.907 0.911 0.906 0.909 0.905 0.906 0.907 0.906 0.909 0.907 0.906 0.911 
  520   530   540   550   560   570   580   590   600   610   620   630   640 
0.907 0.910 0.910 0.910 0.907 0.907 0.906 0.904 0.906 0.910 0.913 0.906 0.907 
  650   660   670   680   690   700   710   720   730   740   750   760   770 
0.906 0.910 0.911 0.913 0.907 0.909 0.909 0.912 0.914 0.908 0.907 0.909 0.911 
  780   790   800   810   820   830   840   850   860   870   880   890   900 
0.914 0.907 0.907 0.908 0.908 0.906 0.907 0.910 0.910 0.910 0.909 0.913 0.912 
  910   920   930   940   950   960   970   980   990  1000  1010  1020  1030 
0.908 0.909 0.909 0.907 0.910 0.909 0.908 0.907 0.911 0.908 0.913 0.910 0.910 
 1040  1050  1060  1070  1080  1090 
0.912 0.906 0.910 0.910 0.908 0.907 

> summary(ik.analog)

	Analogue matching for fossil samples

Call: analog(x = ImbrieKipp, y = V12.122, method = "chord") 
Dissimilarity: chord 
k-closest: 10 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

k-closest analogues

   k         0        10        20        30        40        50        60
   1  V12.122   V12.122   V12.122   V20.230   V22.172   V22.172   V22.172 
   2  V14.5     V20.234   V20.234   V14.90    V20.167   V20.167   A153.154
   3  V20.234   V14.5     V16.21    V22.172   V19.216   V19.216   V10.89  
   4  V18.21    V18.21    A180.76   V9.31     V10.89    V10.89    A179.13 
   5  A180.76   A180.76   V14.5     V12.79    V22.204   V16.21    V16.21  
   6  A180.72   A180.72   V15.164   V19.216   V16.21    V15.164   V20.167 
   7  V15.164   V20.230   V20.230   A180.72   V20.234   V20.234   V22.219 
   8  V16.21    V20.167   V14.90    V22.204   V20.230   A153.154  V19.308 
   9  V20.167   V16.21    A180.72   A180.76   V14.90    V20.230   V12.18  
  10  V20.230   V20.7     V20.167   V20.167   V15.164   A179.13   V19.216 
        70        80        90       100       110       120       130
  V10.89    V22.172   V19.216   V19.216   V9.31     V9.31     V9.31   
  V22.172   V19.216   V22.172   V22.204   V14.90    V19.216   V14.90  
  V16.21    V20.167   V22.204   V9.31     V20.230   V22.172   V19.216 
  V14.90    V16.21    V16.190   V22.172   V19.216   V14.90    V22.172 
  V19.216   V10.89    A153.154  V20.234   V22.204   V20.230   V20.230 
  A153.154  V15.164   V14.90    V14.90    V12.79    V20.167   V12.79  
  V20.167   A179.13   V9.31     V16.21    V22.172   A153.154  V22.204 
  V20.234   V20.230   V20.167   V10.89    A180.72   V22.204   A153.154
  V22.204   V20.234   V12.18    A153.154  A180.76   V12.79    V16.190 
  V9.31     V14.90    V10.89    V15.164   V20.234   V3.128    A180.72 
       140       150       160       170       180       190       200
  V9.31     V10.89    V20.167   V20.167   A179.13   V19.216   V20.230 
  V22.172   V22.172   V20.230   V10.89    V20.167   V20.230   V14.90  
  V20.230   V20.167   V10.89    V20.230   V14.90    V14.90    V22.172 
  V20.234   V19.216   V19.216   V16.21    V20.230   V9.31     V9.31   
  V14.90    V16.21    V9.31     V22.172   V10.89    V22.172   V20.167 
  V20.167   A153.154  V14.90    A153.154  V16.21    V20.167   V20.234 
  V12.122   V14.90    A153.154  V14.90    V22.172   V12.79    V12.122 
  V19.216   V20.234   V16.190   A179.13   V9.31     V12.122   V12.79  
  A180.72   V15.164   V16.33    V9.31     V15.164   V20.234   V16.21  
  V16.21    V20.230   V22.172   V22.219   V19.216   V3.128    A180.72 
       210       220       230       240       250       260       270
  V14.90    V12.122   V12.122   V3.128    V14.90    V14.90    V14.90  
  V22.172   V14.90    V18.21    V20.167   V22.204   V20.167   V22.172 
  V20.167   V20.230   V14.90    V12.122   V22.172   V22.172   A180.72 
  V3.128    V18.21    V14.5     V14.90    A180.72   V3.128    V12.122 
  V12.122   V20.167   A180.76   V18.21    V12.79    V12.122   V12.79  
  V20.230   V20.234   V20.234   V22.172   V12.122   A180.72   V22.204 
  V20.234   V14.5     V3.128    A180.76   A180.76   V22.204   V3.128  
  A180.72   V22.172   A180.72   V15.164   V20.167   V12.79    A180.78 
  V15.164   A180.72   V20.167   A180.72   V10.89    A180.76   V18.21  
  A180.76   A180.76   V15.164   V14.5     V15.164   V20.230   V20.167 
       280       290       300       310       320       330       340
  V22.172   V12.122   V22.172   V19.216   V19.216   V22.172   V19.216 
  V14.90    V14.90    V20.167   V16.33    V9.31     V19.216   V10.89  
  V12.122   A180.72   V19.216   V14.90    V22.172   V14.90    V22.172 
  V22.204   V14.5     V15.164   V22.172   V20.230   V10.89    A153.154
  V19.216   V20.167   V16.21    V9.31     V20.234   A153.154  V20.167 
  V15.164   V18.21    V10.89    V10.89    V20.167   V22.204   A179.13 
  V18.21    A180.76   V14.90    V20.167   V22.204   V9.31     V22.204 
  V12.79    V20.234   V20.234   V20.230   V14.90    A180.39   V19.308 
  V14.5     V3.128    V20.230   V16.190   V16.21    V16.190   V16.21  
  V20.234   V22.172   A179.13   V16.21    V10.89    V22.219   V22.219 
       350       360       370       380       390       400       410
  V20.230   V20.167   V19.216   V9.31     V19.216   V9.31     V3.128  
  V20.167   V22.172   V22.172   V12.122   V22.172   V14.90    V12.122 
  V9.31     V16.21    V20.167   V20.234   V3.128    V22.204   V20.167 
  V19.216   V10.89    V3.128    V14.90    V12.122   A180.76   V20.230 
  V14.90    V14.90    V22.204   V20.230   V14.90    V20.230   V14.90  
  V16.21    V20.234   V12.122   A180.76   V9.31     A180.72   V9.31   
  V22.172   V15.164   V20.234   V3.128    V20.234   V22.172   V22.172 
  V16.33    V12.122   V20.230   A180.72   V16.33    V12.79    V20.7   
  V10.89    A179.13   V15.164   V22.204   V20.167   V19.216   V20.234 
  V15.164   V20.230   V16.33    V20.167   V22.204   V20.234   V19.216 
       420       430       440       450       460       470       480
  V9.31     V12.122   V9.31     A180.76   V20.167   V20.167   V14.90  
  V20.234   V9.31     V14.90    V18.21    V3.128    V22.172   A180.76 
  V14.90    V14.90    V20.234   V20.234   V14.5     V20.234   V22.204 
  V20.230   V20.234   V20.230   A180.72   V18.21    V3.128    V22.172 
  V22.172   A180.76   V12.122   V12.122   A180.76   V14.90    A180.72 
  V12.122   V20.230   A180.72   V14.5     V20.234   V20.230   V12.79  
  V20.167   V3.128    V22.204   V20.230   V12.122   A180.76   V20.230 
  V15.164   A180.72   A180.76   V15.164   V20.230   A180.72   V20.234 
  V3.128    V20.167   V12.79    V3.128    A180.72   V22.204   V3.128  
  A180.76   V22.172   V19.216   V14.90    V15.164   V19.216   A180.78 
       490       500       510       520       530       540       550
  V20.234   V12.122   V9.31     V14.90    V20.167   V10.89    V22.204 
  V3.128    V20.234   V22.204   V22.204   V19.216   A153.154  V16.190 
  A180.76   A180.76   V14.90    V9.31     V22.172   V22.219   V19.216 
  A180.72   V20.230   V20.234   V3.128    V10.89    V19.216   V22.172 
  V12.122   V18.21    V20.230   V19.216   V16.21    V12.18    V14.90  
  V22.204   A180.72   V12.122   A180.76   V22.204   V16.190   V20.230 
  V18.21    V3.128    A180.72   A180.72   V12.122   V22.172   V12.79  
  V14.90    V14.5     V19.216   A180.78   V15.164   V16.21    V9.31   
  V14.5     V20.7     A180.76   V12.79    V20.234   V20.167   A180.72 
  V20.230   V20.167   V22.172   V22.172   V20.230   V22.204   V10.89  
       560       570       580       590       600       610       620
  V14.90    V20.230   V22.204   V20.167   V14.90    V20.167   V22.204 
  V20.230   V9.31     V12.79    V22.172   A180.72   V14.90    V20.167 
  A180.76   A180.78   V14.90    V15.164   A180.76   V22.204   V19.216 
  V9.31     V14.90    A180.72   V16.21    V22.204   V12.122   V12.122 
  A180.72   A180.72   V22.172   V10.89    V12.122   V22.172   V22.172 
  A180.78   V22.204   V20.230   V19.216   V9.31     V20.230   V3.128  
  V3.128    A180.76   A180.76   V20.230   V20.234   V19.216   V20.234 
  V12.79    V3.128    V9.31     V20.234   V22.172   V3.128    V14.90  
  V22.172   V12.79    V19.216   V3.128    V12.79    V12.79    V20.230 
  V22.204   V20.234   V20.234   V14.90    V20.230   A180.72   V16.33  
       630       640       650       660       670       680       690
  V14.90    V12.122   V22.204   V14.90    V9.31     V3.128    A179.13 
  V9.31     V14.90    V12.122   V19.216   V20.234   V14.90    V16.21  
  A180.76   V20.234   V20.234   V22.204   V22.204   V22.172   V10.89  
  A180.72   V20.167   V14.90    V20.167   V14.90    V20.167   V15.164 
  V12.122   V14.5     V22.172   V22.172   A180.72   V19.216   V20.167 
  V22.204   V22.204   A180.72   V9.31     V22.172   V9.31     V22.172 
  V20.230   A180.72   V20.167   V3.128    V20.230   V22.204   V22.204 
  V20.234   V3.128    V14.5     V16.33    V12.122   V16.190   V22.219 
  V22.172   V18.21    A180.76   A180.72   V20.167   V20.230   V12.18  
  V20.167   V20.230   V15.164   V10.89    V15.164   A180.72   V19.308 
       700       710       720       730       740       750       760
  V12.122   V20.167   V22.204   V14.90    V14.90    V22.204   V20.234 
  V22.204   V3.128    V22.172   V3.128    V22.204   V20.234   V22.204 
  V20.167   V16.21    V9.31     V9.31     A180.72   V14.90    V14.90  
  V20.234   V15.164   V20.230   V22.172   V12.122   A180.72   A180.76 
  V22.172   V10.89    V14.90    V22.204   V22.172   V12.79    A180.72 
  V19.216   V20.234   V3.128    V20.230   V20.234   V22.172   V3.128  
  V16.21    V12.122   V10.89    V20.167   V20.230   V20.230   V20.167 
  V10.89    V20.230   V19.216   V12.122   V12.79    V12.122   V12.122 
  V15.164   V22.172   V20.167   V19.216   V20.167   V9.31     V20.230 
  A180.72   V22.204   A180.72   V20.234   V3.128    A180.76   V9.31   
       770       780       790       800       810       820       830
  V3.128    V3.128    V18.21    V12.122   V12.122   V14.90    V19.216 
  V20.167   V18.21    V12.122   V18.21    V14.90    V22.204   V22.172 
  V15.164   A180.78   V14.5     V14.5     V22.172   V19.216   V20.167 
  V20.230   V14.90    V20.167   V20.234   V22.204   V12.79    V16.33  
  V14.90    V12.122   V14.90    V20.167   V15.164   V22.172   V22.204 
  V16.21    V22.172   A180.72   V15.164   V20.234   V20.230   V14.90  
  V22.204   V20.167   V3.128    A180.72   V12.79    A180.72   V12.122 
  A180.76   A180.72   A180.76   V14.90    V14.5     V20.167   V16.190 
  V9.31     V20.230   V20.234   V12.79    V18.21    V10.89    V12.79  
  V12.122   V14.5     V15.164   V16.21    A180.72   A180.76   V10.89  
       840       850       860       870       880       890       900
  V19.216   V22.204   V22.204   V19.216   V19.216   V19.216   V19.216 
  V16.33    V20.234   V14.90    V22.172   V9.31     V19.222   V9.31   
  V22.204   V19.216   V22.172   V20.167   V22.172   V16.190   V12.79  
  V20.167   V9.31     V20.167   V22.204   V20.230   V10.98    V22.204 
  V20.234   V14.90    V19.216   V15.164   V12.122   V22.204   V14.90  
  V10.89    V12.122   V10.89    V14.90    V14.90    A180.39   V22.172 
  V22.172   V20.167   A179.13   V3.128    V20.234   V14.90    V20.230 
  A180.72   V20.230   V15.164   V10.89    V12.79    V22.172   V16.190 
  V9.31     A180.76   V12.18    V20.230   V20.167   V12.79    A180.39 
  V14.90    A180.72   V9.31     V16.21    A180.72   V9.31     V19.222 
       910       920       930       940       950       960       970
  V19.216   V19.216   V9.31     V19.216   V20.167   V20.230   V9.31   
  V22.204   V9.31     V20.230   V20.230   V14.90    V12.122   V20.234 
  V16.190   V16.190   V19.216   V9.31     V16.21    V20.234   V20.230 
  V22.172   V14.90    V22.204   V20.167   V20.230   V12.79    V22.172 
  V19.222   V22.204   V22.172   V14.90    V12.122   V22.172   A180.76 
  V12.79    V22.172   V14.90    V22.172   V9.31     V16.21    V19.216 
  A180.39   V20.230   V20.234   V12.79    V20.234   V19.216   V16.21  
  V14.90    A180.39   V20.167   V16.21    V15.164   V9.31     V20.167 
  A153.154  V10.98    V12.79    A180.72   V22.172   V14.90    A180.72 
  V9.31     V12.79    A180.72   V20.234   A179.13   A180.72   V14.90  
       980       990      1000      1010      1020      1030      1040
  V9.31     V9.31     V19.216   V14.90    V19.216   V14.90    V9.31   
  V20.230   V20.234   V14.90    V9.31     V16.190   V19.216   V14.90  
  V14.90    V20.230   V22.172   V20.230   V22.204   V22.172   V22.204 
  V20.234   V14.90    V9.31     V22.172   V22.172   V22.204   V19.216 
  A180.76   V22.172   V20.230   V12.79    V19.222   V9.31     V20.234 
  V22.172   V22.204   V12.79    A180.72   V14.90    V12.79    V12.79  
  A180.72   V12.79    V20.167   V19.216   A180.39   V16.190   V22.172 
  V12.79    V12.122   A180.72   V22.204   V12.66    A180.72   A180.72 
  V19.216   V19.216   V22.204   A180.39   V10.98    V20.234   A180.78 
  V12.122   A180.72   V16.21    V12.122   V12.79    V20.230   A180.76 
      1050      1060      1070      1080      1090
  V19.216   V22.204   V16.190   V19.216   V22.172 
  V22.204   V19.216   V19.216   V12.122   V22.204 
  V14.90    V14.90    V22.172   V22.172   V14.90  
  V22.172   V12.122   V22.204   V14.90    V19.216 
  V12.79    V22.172   V14.90    V22.204   V10.89  
  V9.31     V12.79    V12.18    V20.167   V20.167 
  V12.122   A180.72   V10.89    V12.79    V12.79  
  A180.72   V9.31     V20.167   A180.72   V20.234 
  V16.33    V20.234   V22.219   V20.230   V9.31   
  V16.190   A180.78   V9.31     V20.234   A180.72 

Dissimilarities for k-closest analogues

   k      0     10     20     30     40     50     60     70     80     90
   1  0.900  0.902  0.903  0.904  0.904  0.907  0.907  0.908  0.908  0.908
   2  0.903  0.904  0.904  0.904  0.905  0.908  0.908  0.909  0.908  0.910
   3  0.903  0.904  0.906  0.904  0.906  0.908  0.909  0.910  0.909  0.913
   4  0.903  0.906  0.906  0.905  0.906  0.909  0.910  0.910  0.909  0.913
   5  0.905  0.906  0.906  0.905  0.908  0.909  0.910  0.910  0.909  0.914
   6  0.905  0.907  0.906  0.905  0.908  0.909  0.910  0.911  0.910  0.914
   7  0.907  0.907  0.907  0.906  0.908  0.911  0.910  0.911  0.910  0.914
   8  0.907  0.908  0.907  0.906  0.908  0.911  0.911  0.911  0.910  0.914
   9  0.907  0.909  0.907  0.906  0.908  0.911  0.911  0.911  0.911  0.915
  10  0.908  0.910  0.907  0.906  0.908  0.912  0.911  0.911  0.911  0.915
    100    110    120    130    140    150    160    170    180    190    200
  0.910  0.908  0.910  0.909  0.911  0.908  0.908  0.906  0.908  0.909  0.906
  0.911  0.910  0.910  0.909  0.911  0.909  0.910  0.907  0.910  0.910  0.908
  0.911  0.912  0.911  0.910  0.912  0.909  0.910  0.907  0.910  0.910  0.908
  0.912  0.913  0.911  0.911  0.912  0.910  0.910  0.907  0.911  0.910  0.908
  0.913  0.914  0.912  0.911  0.914  0.910  0.910  0.907  0.911  0.912  0.908
  0.913  0.914  0.914  0.913  0.914  0.910  0.910  0.908  0.911  0.912  0.909
  0.913  0.914  0.914  0.913  0.915  0.911  0.910  0.908  0.911  0.912  0.909
  0.913  0.915  0.914  0.914  0.915  0.911  0.910  0.908  0.912  0.913  0.910
  0.914  0.915  0.915  0.914  0.915  0.911  0.911  0.909  0.913  0.914  0.910
  0.914  0.915  0.915  0.914  0.915  0.912  0.911  0.910  0.914  0.914  0.910
    210    220    230    240    250    260    270    280    290    300    310
  0.907  0.906  0.906  0.906  0.906  0.906  0.909  0.910  0.907  0.907  0.912
  0.908  0.909  0.908  0.910  0.908  0.908  0.910  0.911  0.908  0.908  0.913
  0.908  0.909  0.908  0.911  0.909  0.908  0.911  0.911  0.909  0.908  0.913
  0.908  0.909  0.908  0.911  0.910  0.908  0.912  0.911  0.909  0.909  0.914
  0.909  0.909  0.909  0.911  0.910  0.908  0.912  0.912  0.910  0.909  0.915
  0.910  0.909  0.909  0.912  0.911  0.909  0.912  0.912  0.910  0.909  0.916
  0.910  0.909  0.910  0.912  0.911  0.909  0.913  0.912  0.910  0.909  0.916
  0.910  0.910  0.910  0.913  0.911  0.910  0.913  0.912  0.911  0.910  0.916
  0.910  0.910  0.910  0.913  0.911  0.910  0.913  0.913  0.912  0.910  0.916
  0.910  0.910  0.911  0.913  0.911  0.910  0.914  0.914  0.912  0.910  0.917
    320    330    340    350    360    370    380    390    400    410    420
  0.910  0.911  0.907  0.908  0.908  0.910  0.908  0.910  0.907  0.911  0.906
  0.911  0.911  0.908  0.909  0.909  0.910  0.909  0.910  0.907  0.911  0.907
  0.911  0.911  0.908  0.909  0.909  0.911  0.909  0.912  0.909  0.912  0.907
  0.912  0.911  0.909  0.910  0.909  0.912  0.909  0.912  0.910  0.912  0.907
  0.912  0.912  0.909  0.910  0.909  0.912  0.910  0.912  0.910  0.912  0.908
  0.912  0.912  0.910  0.910  0.909  0.912  0.911  0.912  0.910  0.912  0.908
  0.913  0.913  0.911  0.911  0.909  0.913  0.911  0.913  0.910  0.913  0.909
  0.913  0.913  0.911  0.911  0.909  0.913  0.911  0.913  0.911  0.913  0.909
  0.913  0.913  0.911  0.912  0.910  0.914  0.911  0.913  0.911  0.913  0.909
  0.913  0.913  0.911  0.912  0.910  0.914  0.911  0.913  0.911  0.914  0.909
    430    440    450    460    470    480    490    500    510    520    530
  0.909  0.905  0.906  0.907  0.906  0.909  0.907  0.906  0.911  0.907  0.910
  0.911  0.908  0.907  0.907  0.906  0.909  0.907  0.907  0.912  0.910  0.911
  0.911  0.909  0.907  0.909  0.907  0.909  0.908  0.908  0.912  0.910  0.911
  0.911  0.909  0.908  0.910  0.907  0.910  0.908  0.908  0.913  0.911  0.911
  0.911  0.910  0.908  0.911  0.907  0.910  0.908  0.908  0.914  0.911  0.911
  0.912  0.911  0.908  0.912  0.907  0.911  0.908  0.909  0.914  0.912  0.911
  0.913  0.911  0.908  0.912  0.907  0.911  0.908  0.909  0.914  0.912  0.912
  0.913  0.911  0.909  0.912  0.907  0.911  0.909  0.910  0.915  0.912  0.912
  0.913  0.911  0.909  0.912  0.908  0.912  0.909  0.911  0.915  0.913  0.913
  0.914  0.911  0.909  0.912  0.908  0.912  0.909  0.911  0.915  0.913  0.913
    540    550    560    570    580    590    600    610    620    630    640
  0.910  0.910  0.907  0.907  0.906  0.904  0.906  0.910  0.913  0.906  0.907
  0.911  0.910  0.908  0.907  0.907  0.907  0.908  0.911  0.913  0.910  0.908
  0.911  0.911  0.910  0.909  0.907  0.907  0.908  0.911  0.914  0.910  0.909
  0.911  0.911  0.910  0.909  0.907  0.907  0.909  0.911  0.914  0.910  0.909
  0.912  0.911  0.910  0.909  0.908  0.907  0.910  0.911  0.915  0.910  0.909
  0.912  0.912  0.911  0.909  0.908  0.907  0.910  0.912  0.915  0.910  0.909
  0.913  0.913  0.911  0.910  0.910  0.907  0.910  0.913  0.915  0.911  0.910
  0.913  0.914  0.912  0.910  0.910  0.908  0.911  0.913  0.916  0.911  0.910
  0.913  0.914  0.912  0.910  0.911  0.908  0.911  0.913  0.916  0.912  0.910
  0.914  0.914  0.913  0.911  0.911  0.908  0.911  0.914  0.916  0.912  0.910
    650    660    670    680    690    700    710    720    730    740    750
  0.906  0.910  0.911  0.913  0.907  0.909  0.909  0.912  0.914  0.908  0.907
  0.907  0.910  0.911  0.913  0.909  0.909  0.911  0.913  0.914  0.909  0.909
  0.909  0.910  0.912  0.914  0.909  0.910  0.911  0.914  0.915  0.910  0.909
  0.909  0.910  0.912  0.916  0.909  0.911  0.912  0.914  0.915  0.910  0.910
  0.910  0.911  0.913  0.916  0.910  0.912  0.912  0.914  0.915  0.910  0.910
  0.910  0.911  0.913  0.916  0.914  0.913  0.913  0.915  0.915  0.910  0.910
  0.910  0.911  0.913  0.917  0.914  0.913  0.913  0.915  0.916  0.911  0.910
  0.911  0.912  0.913  0.918  0.914  0.913  0.913  0.916  0.916  0.911  0.911
  0.911  0.912  0.914  0.918  0.914  0.913  0.913  0.916  0.917  0.911  0.911
  0.911  0.913  0.914  0.919  0.915  0.913  0.914  0.916  0.917  0.911  0.911
    760    770    780    790    800    810    820    830    840    850    860
  0.909  0.911  0.914  0.907  0.907  0.908  0.908  0.906  0.907  0.910  0.910
  0.910  0.911  0.914  0.908  0.908  0.908  0.910  0.910  0.909  0.911  0.911
  0.910  0.913  0.917  0.910  0.909  0.909  0.910  0.910  0.911  0.911  0.912
  0.910  0.913  0.917  0.910  0.910  0.909  0.911  0.910  0.911  0.911  0.912
  0.910  0.913  0.917  0.911  0.910  0.909  0.912  0.911  0.912  0.912  0.912
  0.910  0.913  0.918  0.911  0.911  0.909  0.912  0.912  0.912  0.912  0.912
  0.911  0.914  0.918  0.911  0.911  0.909  0.913  0.912  0.913  0.913  0.913
  0.911  0.914  0.919  0.911  0.911  0.910  0.913  0.913  0.913  0.913  0.914
  0.912  0.914  0.919  0.911  0.912  0.910  0.914  0.913  0.914  0.913  0.914
  0.912  0.914  0.919  0.912  0.912  0.910  0.914  0.913  0.914  0.913  0.915
    870    880    890    900    910    920    930    940    950    960    970
  0.910  0.909  0.913  0.912  0.908  0.909  0.909  0.907  0.910  0.909  0.908
  0.910  0.912  0.914  0.915  0.912  0.913  0.910  0.908  0.910  0.910  0.908
  0.910  0.912  0.914  0.916  0.912  0.915  0.912  0.909  0.911  0.910  0.909
  0.911  0.913  0.915  0.916  0.913  0.916  0.913  0.909  0.911  0.911  0.909
  0.912  0.913  0.915  0.917  0.913  0.917  0.914  0.909  0.911  0.911  0.909
  0.913  0.913  0.915  0.918  0.913  0.917  0.915  0.910  0.911  0.911  0.909
  0.913  0.914  0.917  0.918  0.914  0.917  0.915  0.911  0.911  0.911  0.909
  0.913  0.914  0.918  0.918  0.914  0.917  0.915  0.911  0.912  0.911  0.910
  0.915  0.914  0.918  0.919  0.915  0.918  0.915  0.912  0.912  0.912  0.910
  0.915  0.915  0.918  0.920  0.915  0.918  0.916  0.912  0.913  0.912  0.910
    980    990   1000   1010   1020   1030   1040   1050   1060   1070   1080
  0.907  0.911  0.908  0.913  0.910  0.910  0.912  0.906  0.910  0.910  0.908
  0.909  0.912  0.908  0.913  0.914  0.911  0.914  0.909  0.911  0.910  0.908
  0.909  0.912  0.909  0.914  0.914  0.911  0.916  0.909  0.914  0.911  0.909
  0.911  0.912  0.909  0.915  0.915  0.912  0.917  0.909  0.915  0.911  0.909
  0.911  0.913  0.909  0.915  0.915  0.912  0.917  0.911  0.915  0.912  0.910
  0.912  0.914  0.910  0.916  0.916  0.914  0.917  0.912  0.915  0.913  0.911
  0.912  0.914  0.912  0.916  0.916  0.915  0.917  0.912  0.916  0.913  0.911
  0.912  0.915  0.912  0.917  0.917  0.916  0.918  0.912  0.916  0.914  0.911
  0.912  0.915  0.912  0.918  0.918  0.916  0.918  0.913  0.917  0.914  0.911
  0.913  0.915  0.913  0.918  0.918  0.916  0.918  0.913  0.917  0.915  0.911
   1090
  0.907
  0.908
  0.908
  0.908
  0.910
  0.910
  0.911
  0.911
  0.911
  0.911

> 
> 
> 
> 
> cleanEx()
> nameEx("bayesF")
> ### * bayesF
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: bayesF
> ### Title: Bayes factors
> ### Aliases: bayesF print.bayesF plot.bayesF
> ### Keywords: univar methods
> 
> ### ** Examples
> 
> ## load the example data
> data(swapdiat, swappH, rlgh)
> 
> ## merge training and test set on columns
> dat <- join(swapdiat, rlgh, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:  167  277
Data set 2:  101  139
Merged:      268  277

> 
> ## extract the merged data sets and convert to proportions
> swapdiat <- dat[[1]] / 100
> rlgh <- dat[[2]] / 100
> 
> ## fit an analogue matching (AM) model using the squared chord distance
> ## measure - need to keep the training set dissimilarities
> swap.ana <- analog(swapdiat, rlgh, method = "SQchord",
+                    keep.train = TRUE)
> 
> ## fit the ROC curve to the SWAP diatom data using the AM results
> ## Generate a grouping for the SWAP lakes
> clust <- hclust(as.dist(swap.ana$train), method = "ward")
> grps <- cutree(clust, 12)
> 
> ## fit the ROC curve
> swap.roc <- roc(swap.ana, groups = grps)
> swap.roc

	ROC curve of dissimilarities

Discrimination for all groups:

Optimal Dissimilarity = 0.575 

AUC = 0.998, p-value: < 2.22e-16
No. within: 167   No. outside: 1837 

> 
> ## calculate the Bayes factors of analogue and no-analogue
> ## (uses observed probabilities of analogue/no-analogue
> swap.bayes <- bayesF(swap.roc)
> swap.bayes

	Bayes factors (likelihood ratios)

Object: swap.roc 

Groups (N = 12):
  1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12


Prior probabilities:
Positive: 0.5   Negative: 0.5 

> 
> ## plot the probability of analogue
> plot(swap.bayes)
> 
> ## Not run: 
> ##D ## calculate the Bayes factors of analogue and no-analogue
> ##D ## with prior probabilities c(0.5, 0.05)
> ##D swap.bayes2 <- bayesF(swap.roc, prior = c(0.5, 0.05))
> ##D swap.bayes
> ##D 
> ##D ## plot the probability of analogue
> ##D plot(swap.bayes2)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("bootstrap")
> ### * bootstrap
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: bootstrap
> ### Title: Bootstrap estimation and errors
> ### Aliases: bootstrap bootstrap.default bootstrap.mat print.bootstrap.mat
> ###   residuals.bootstrap.mat resid.bootstrap.mat
> ###   print.residuals.bootstrap.mat fitted.bootstrap.mat
> ###   print.fitted.bootstrap.mat
> ### Keywords: multivariate methods
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## Imbrie and Kipp foraminfera sea-surface temperature 
> ## fit the MAT model using the squared chord distance measure
> ik.mat <- mat(ImbrieKipp, SumSST, method = "SQchord")
> 
> ## bootstrap training set
> ik.boot <- bootstrap(ik.mat, n.boot = 100)
> ik.boot

	Bootstrap results for palaeoecological models

Model type: MAT 
Weighted mean: FALSE 
Number of bootstrap cycles: 100 

Leave-one-out and bootstrap-derived error estimates:

          k RMSEP     S1    S2 r.squared avg.bias max.bias
LOO       3 1.713      -     -    0.9409   0.1328    5.167
Bootstrap 5 1.953 0.9133 1.726    0.9707   0.3017    5.484

> summary(ik.boot)

	Bootstrap results for palaeoecological models

Model type: MAT 
Weighted mean: FALSE 
Number of bootstrap cycles: 100 

Leave-one-out and bootstrap-derived error estimates:

          k RMSEP     S1    S2 r.squared avg.bias max.bias
LOO       3 1.713      -     -    0.9409   0.1328    5.167
Bootstrap 5 1.953 0.9133 1.726    0.9707   0.3017    5.484


Bootstrap estimated values for training set:
  V14.61  V17.196  V18.110  V16.227   V14.47   V23.22    V2.12   V23.29 
   7.484    6.697    6.831    7.121    7.748    9.164    5.731   13.332 
  V12.43     R9.7   A157.3   V23.81   V23.82   V12.53   V23.83   V12.56 
  13.465   13.969   15.566   15.070   14.451   17.200   14.167   20.237 
 A152.84   V16.50  V22.122   V16.41    V4.32   V12.66  V19.245     V4.8 
  21.208   18.618   16.955   23.597   24.000   21.665   22.544   23.500 
 A180.15   V18.34  V20.213  V19.222  A180.39  V16.189   V12.18    V7.67 
  23.417   24.941   24.504   23.125   23.922   25.633   25.558   24.925 
 V17.165  V19.310  V16.190 A153.154  V19.308  V22.172   V10.98  V22.219 
  24.837   24.668   25.240   25.705   26.011   26.743   24.352   25.476 
  V16.33  V22.204  V20.167   V10.89   V12.79  V19.216   V14.90  A180.72 
  26.420   26.671   26.695   26.718   26.746   26.070   26.828   26.808 
  V16.21  A180.76  V15.164  A180.78    V14.5   V3.128  A179.13    V9.31 
  26.828   27.166   26.582   27.057   27.274   26.591   26.438   27.202 
 V20.230    V20.7  V20.234   V18.21  V12.122 
  27.085   27.251   27.280   27.184   27.031 

Training set assessment:

          Obs    Est    Resid Boot.Est Boot.Resid      s1     s2 RMSEP
V14.61    2.0  7.167  5.16667    7.484    5.48438 1.39633 5.6540 2.466
V17.196   5.0  4.833 -0.16667    6.697    1.69677 1.91685 2.5367 2.650
V18.110   5.5  4.667 -0.83333    6.831    1.33077 1.68322 2.1287 2.428
V16.227   7.0  7.167  0.16667    7.121    0.12105 1.75733 1.7383 2.455
V14.47    7.0  7.667  0.66667    7.748    0.74848 1.41181 1.5789 2.230
V23.22   10.5 10.000 -0.50000    9.164   -1.33636 1.54976 2.0285 2.345
V2.12    11.0  4.833 -6.16667    5.731   -5.26857 1.40499 5.4475 2.290
V23.29   10.0 11.833  1.83333   13.332    3.33200 1.39485 3.6014 2.333
V12.43   13.0 13.500  0.50000   13.465    0.46500 0.98360 1.0768 2.184
R9.7     12.0 13.667  1.66667   13.969    1.96944 1.08676 2.2421 2.308
A157.3   14.0 14.500  0.50000   15.566    1.56579 1.08211 1.8952 2.402
V23.81   14.5 14.333 -0.16667   15.070    0.56977 1.17078 1.2898 2.546
V23.82   15.0 14.167 -0.83333   14.451   -0.54884 1.13376 1.2477 2.636
V12.53   14.5 17.000  2.50000   17.200    2.70000 1.01784 2.8811 2.704
V23.83   16.0 14.500 -1.50000   14.167   -1.83256 0.93852 2.0539 2.794
V12.56   18.0 20.667  2.66667   20.237    2.23714 1.61848 2.7476 3.191
A152.84  20.0 22.000  2.00000   21.208    1.20811 1.54639 1.9458 3.259
V16.50   18.0 17.167 -0.83333   18.618    0.61765 1.41667 1.5262 3.304
V22.122  19.0 15.500 -3.50000   16.955   -2.04524 1.30556 2.4180 3.365
V16.41   18.5 23.333  4.83333   23.597    5.09737 0.84485 5.1651 3.325
V4.32    21.5 24.000  2.50000   24.000    2.50000 0.63896 2.5777 3.388
V12.66   21.0 21.833  0.83333   21.665    0.66486 0.80077 1.0324 3.525
V19.245  21.0 20.833 -0.16667   22.544    1.54390 1.27182 1.9904 3.767
V4.8     24.0 23.833 -0.16667   23.500   -0.50000 1.05603 1.1499 3.804
A180.15  24.0 23.333 -0.66667   23.417   -0.58333 1.02051 1.1606 3.899
V18.34   23.0 25.333  2.33333   24.941    1.94063 0.78200 2.0877 3.937
V20.213  24.0 24.500  0.50000   24.504    0.50387 0.62280 0.7933 4.002
V19.222  23.0 23.833  0.83333   23.125    0.12500 1.05969 1.0538 4.184
A180.39  23.0 24.000  1.00000   23.922    0.92154 0.96338 1.3242 4.254
V16.189  24.0 25.733  1.73333   25.633    1.63333 0.25994 1.6533 4.248
V12.18   25.0 26.067  1.06667   25.558    0.55760 0.41954 0.6927 4.350
V7.67    26.0 25.333 -0.66667   24.925   -1.07500 0.67776 1.2663 4.471
V17.165  26.0 25.333 -0.66667   24.837   -1.16250 0.52397 1.2718 4.539
V19.310  26.0 25.333 -0.66667   24.668   -1.33158 0.85142 1.5745 4.673
V16.190  25.0 25.000  0.00000   25.240    0.24000 0.59783 0.6357 4.718
A153.154 26.0 25.733 -0.26667   25.705   -0.29500 0.27433 0.4002 4.772
V19.308  26.0 25.733 -0.26667   26.011    0.01125 0.46207 0.4574 4.868
V22.172  24.5 26.400  1.90000   26.743    2.24267 0.23326 2.2545 4.934
V10.98   27.0 24.667 -2.33333   24.352   -2.64778 0.63662 2.7212 5.052
V22.219  26.2 25.667 -0.53333   25.476   -0.72381 0.31220 0.7868 5.105
V16.33   25.0 25.733  0.73333   26.420    1.42041 0.52193 1.5114 5.200
V22.204  26.5 26.000 -0.50000   26.671    0.17135 0.44750 0.4735 5.270
V20.167  26.2 26.167 -0.03333   26.695    0.49487 0.56520 0.7458 5.358
V10.89   26.0 27.233  1.23333   26.718    0.71800 0.50893 0.8764 5.427
V12.79   26.0 27.000  1.00000   26.746    0.74615 0.44358 0.8651 5.498
V19.216  27.0 25.667 -1.33333   26.070   -0.92973 0.45195 1.0311 5.577
V14.90   27.0 26.833 -0.16667   26.828   -0.17241 0.35244 0.3869 5.649
A180.72  27.5 26.667 -0.83333   26.808   -0.69231 0.33932 0.7681 5.730
V16.21   27.0 26.400 -0.60000   26.828   -0.17176 0.40392 0.4334 5.820
A180.76  27.0 27.167  0.16667   27.166    0.16579 0.15816 0.2277 5.899
V15.164  27.0 26.733 -0.26667   26.582   -0.41758 0.41239 0.5825 6.004
A180.78  27.0 26.833 -0.16667   27.057    0.05714 0.33544 0.3355 6.099
V14.5    27.0 27.333  0.33333   27.274    0.27371 0.19450 0.3342 6.197
V3.128   29.0 26.067 -2.93333   26.591   -2.40882 0.52035 2.4628 6.320
A179.13  28.5 26.667 -1.83333   26.438   -2.06211 0.29558 2.0826 6.415
V9.31    27.5 27.167 -0.33333   27.202   -0.29765 0.33134 0.4418 6.527
V20.230  27.5 27.333 -0.16667   27.085   -0.41471 0.26115 0.4880 6.637
V20.7    27.5 27.333 -0.16667   27.251   -0.24903 0.23697 0.3411 6.750
V20.234  27.0 27.333  0.33333   27.280    0.28000 0.24160 0.3671 6.864
V18.21   27.0 27.333  0.33333   27.184    0.18364 0.24431 0.3027 6.987
V12.122  28.0 27.000 -1.00000   27.031   -0.96857 0.08908 0.9725 7.122
> 
> ## Bootstrap fitted values for training set
> fitted(ik.boot)

	Modern Analogue Technique: Bootstrap fitted values for the training
	set

No. of analogues (k) : 5 
User supplied k?     : FALSE 
Weighted analysis?   : FALSE 

  V14.61  V17.196  V18.110  V16.227   V14.47   V23.22    V2.12   V23.29 
   7.484    6.697    6.831    7.121    7.748    9.164    5.731   13.332 
  V12.43     R9.7   A157.3   V23.81   V23.82   V12.53   V23.83   V12.56 
  13.465   13.969   15.566   15.070   14.451   17.200   14.167   20.237 
 A152.84   V16.50  V22.122   V16.41    V4.32   V12.66  V19.245     V4.8 
  21.208   18.618   16.955   23.597   24.000   21.665   22.544   23.500 
 A180.15   V18.34  V20.213  V19.222  A180.39  V16.189   V12.18    V7.67 
  23.417   24.941   24.504   23.125   23.922   25.633   25.558   24.925 
 V17.165  V19.310  V16.190 A153.154  V19.308  V22.172   V10.98  V22.219 
  24.837   24.668   25.240   25.705   26.011   26.743   24.352   25.476 
  V16.33  V22.204  V20.167   V10.89   V12.79  V19.216   V14.90  A180.72 
  26.420   26.671   26.695   26.718   26.746   26.070   26.828   26.808 
  V16.21  A180.76  V15.164  A180.78    V14.5   V3.128  A179.13    V9.31 
  26.828   27.166   26.582   27.057   27.274   26.591   26.438   27.202 
 V20.230    V20.7  V20.234   V18.21  V12.122 
  27.085   27.251   27.280   27.184   27.031 
> 
> ## residuals
> resid(ik.boot) # uses abbreviated form

	Bootstrap residuals
Model type: MAT 
Weighted: FALSE 

(k chosen from model with lowest RMSEP)

Model residuals:
  V14.61  V17.196  V18.110  V16.227   V14.47   V23.22    V2.12   V23.29 
  5.1667  -0.1667  -0.8333   0.1667   0.6667  -0.5000  -6.1667   1.8333 
  V12.43     R9.7   A157.3   V23.81   V23.82   V12.53   V23.83   V12.56 
  0.5000   1.6667   0.5000  -0.1667  -0.8333   2.5000  -1.5000   2.6667 
 A152.84   V16.50  V22.122   V16.41    V4.32   V12.66  V19.245     V4.8 
  2.0000  -0.8333  -3.5000   4.8333   2.5000   0.8333  -0.1667  -0.1667 
 A180.15   V18.34  V20.213  V19.222  A180.39  V16.189   V12.18    V7.67 
 -0.6667   2.3333   0.5000   0.8333   1.0000   1.7333   1.0667  -0.6667 
 V17.165  V19.310  V16.190 A153.154  V19.308  V22.172   V10.98  V22.219 
 -0.6667  -0.6667   0.0000  -0.2667  -0.2667   1.9000  -2.3333  -0.5333 
  V16.33  V22.204  V20.167   V10.89   V12.79  V19.216   V14.90  A180.72 
  0.7333  -0.5000  -0.0333   1.2333   1.0000  -1.3333  -0.1667  -0.8333 
  V16.21  A180.76  V15.164  A180.78    V14.5   V3.128  A179.13    V9.31 
 -0.6000   0.1667  -0.2667  -0.1667   0.3333  -2.9333  -1.8333  -0.3333 
 V20.230    V20.7  V20.234   V18.21  V12.122 
 -0.1667  -0.1667   0.3333   0.3333  -1.0000 

Bootstrap residuals:
  V14.61  V17.196  V18.110  V16.227   V14.47   V23.22    V2.12   V23.29 
  5.5052   0.4839   0.4103   0.3947   0.7424  -1.6212  -6.3095   2.7267 
  V12.43     R9.7   A157.3   V23.81   V23.82   V12.53   V23.83   V12.56 
  0.8000   1.5926   1.2807   0.1202  -0.5659   2.9065  -1.8333   1.9095 
 A152.84   V16.50  V22.122   V16.41    V4.32   V12.66  V19.245     V4.8 
  1.6982   0.3039  -2.4484   5.0614   2.5667   0.6306   0.5407  -0.4551 
 A180.15   V18.34  V20.213  V19.222  A180.39  V16.189   V12.18    V7.67 
 -0.6389   2.4896   0.8441   0.6417   1.0043   1.5970   0.8427  -0.6417 
 V17.165  V19.310  V16.190 A153.154  V19.308  V22.172   V10.98  V22.219 
 -0.8104  -0.8465  -0.0283  -0.2333  -0.0556   2.0059  -2.7130  -0.6048 
  V16.33  V22.204  V20.167   V10.89   V12.79  V19.216   V14.90  A180.72 
  1.1959   0.1081   0.4111   0.8508   0.8718  -1.1928  -0.0575  -0.7179 
  V16.21  A180.76  V15.164  A180.78    V14.5   V3.128  A179.13    V9.31 
 -0.2598   0.1974  -0.3182  -0.0762   0.3400  -2.5049  -2.0246  -0.2500 
 V20.230    V20.7  V20.234   V18.21  V12.122 
 -0.3245  -0.1989   0.3069   0.2838  -0.9848 

> 
> 
> 
> cleanEx()
> nameEx("bootstrap.wa")
> ### * bootstrap.wa
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: bootstrap.wa
> ### Title: Bootstrap estimation and errors for WA models
> ### Aliases: bootstrap.wa print.bootstrap.wa
> ### Keywords: multivariate methods
> 
> ### ** Examples
> 
> ## Imbrie and Kipp
> data(ImbrieKipp)
> data(SumSST)
> ik.wa <- wa(SumSST ~ ., data = ImbrieKipp, tol.dw = TRUE,
+             min.tol = 2, small.tol = "min")
> ik.wa

	Weighted Averaging Transfer Function

Call:
wa(formula = SumSST ~ ., data = ImbrieKipp, tol.dw = TRUE, small.tol = "min",  

     min.tol = 2) 

Deshrinking  : Inverse 
Tolerance DW : Yes 
No. samples  : 61 
No. species  : 27 

Performance:
     RMSE  R-squared  Avg. Bias  Max. Bias  
   2.0268     0.9166     0.0000    -2.4507  

> 
> ## compare actual tolerances to working values
> with(ik.wa, rbind(tolerances, model.tol))
             O.univ  G.cglob  G.ruber  G.tenel  G.saccu  G.rubes   G.pacL
tolerances 3.746359 1.895600 1.909561 2.124799 1.979651 1.968294 3.941352
model.tol  3.746359 2.124799 2.124799 2.124799 2.124799 2.124799 3.941352
             G.pacR G.bullo  G.falco  G.calid  G.aequi  G.gluti  G.duter
tolerances 5.181162 5.82798 3.109193 2.973112 2.561697 5.898256 1.998304
model.tol  5.181162 5.82798 3.109193 2.973112 2.561697 5.898256 2.124799
            G.infla   G.trnL  G.trnR  G.crasf  G.scitu  G.mentu  P.obliq
tolerances 4.723884 4.161704 3.43492 3.354021 3.990673 2.386584 1.554762
model.tol  4.723884 4.161704 3.43492 3.354021 3.990673 2.386584 2.124799
            C.nitid S.dehis  G.digit    Other   G.quin  G.hirsu
tolerances 1.461725 3.84473 3.108881 5.112464 4.268777 3.942135
model.tol  2.124799 3.84473 3.108881 5.112464 4.268777 3.942135
> 
> ## bootstrap the WA model
> ik.boot <- bootstrap(ik.wa, n.boot = 100)
Bootstrap sample 100 
> 
> ## performance statistics
> performance(ik.boot)
   RMSEP       R2 Avg.Bias Max.Bias 
  2.3846   0.8948  -0.1778  -3.2058 
> 
> 
> 
> cleanEx()
> nameEx("chooseTaxa")
> ### * chooseTaxa
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: chooseTaxa
> ### Title: Select taxa (variables) on basis of maximum abundance attained
> ###   and number of occurrences
> ### Aliases: chooseTaxa chooseTaxa.default
> ### Keywords: methods multivariate
> 
> ### ** Examples
> 
> data(ImbrieKipp)
> IK2 <- chooseTaxa(ImbrieKipp, n.occ = 5)
> dim(ImbrieKipp)
[1] 61 27
> dim(IK2)
[1] 61 27
> 
> 
> 
> cleanEx()
> nameEx("cma")
> ### * cma
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: cma
> ### Title: Close modern analogues
> ### Aliases: cma cma.default cma.analog cma.mat cma.predict.mat print.cma
> ###   plot.cma
> ### Keywords: methods manip hplot
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## analog matching between SWAP and RLGH reference samples
> (ik.ana <- analog(ImbrieKipp, V12.122, method = "chord"))

	Analogue matching for fossil samples

Call: analog(x = ImbrieKipp, y = V12.122, method = "chord") 
Dissimilarity: chord 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

	Minimum dissimilarity per sample

Dissimilarity: chord 

    0    10    20    30    40    50    60    70    80    90   100   110   120 
0.900 0.902 0.903 0.904 0.904 0.907 0.907 0.908 0.908 0.908 0.910 0.908 0.910 
  130   140   150   160   170   180   190   200   210   220   230   240   250 
0.909 0.911 0.908 0.908 0.906 0.908 0.909 0.906 0.907 0.906 0.906 0.906 0.906 
  260   270   280   290   300   310   320   330   340   350   360   370   380 
0.906 0.909 0.910 0.907 0.907 0.912 0.910 0.911 0.907 0.908 0.908 0.910 0.908 
  390   400   410   420   430   440   450   460   470   480   490   500   510 
0.910 0.907 0.911 0.906 0.909 0.905 0.906 0.907 0.906 0.909 0.907 0.906 0.911 
  520   530   540   550   560   570   580   590   600   610   620   630   640 
0.907 0.910 0.910 0.910 0.907 0.907 0.906 0.904 0.906 0.910 0.913 0.906 0.907 
  650   660   670   680   690   700   710   720   730   740   750   760   770 
0.906 0.910 0.911 0.913 0.907 0.909 0.909 0.912 0.914 0.908 0.907 0.909 0.911 
  780   790   800   810   820   830   840   850   860   870   880   890   900 
0.914 0.907 0.907 0.908 0.908 0.906 0.907 0.910 0.910 0.910 0.909 0.913 0.912 
  910   920   930   940   950   960   970   980   990  1000  1010  1020  1030 
0.908 0.909 0.909 0.907 0.910 0.909 0.908 0.907 0.911 0.908 0.913 0.910 0.910 
 1040  1050  1060  1070  1080  1090 
0.912 0.906 0.910 0.910 0.908 0.907 

> 
> ## close modern analogues --- no analogues are "close"
> (ik.cma <- cma(ik.ana, cutoff = 0.91))

	Close modern analogues of fossil samples

Call: cma(object = ik.ana, cutoff = 0.91) 

Dissimilarity: chord 

     k: Not supplied

Cutoff: 0.91 

	Number of analogues per fossil sample:

   0   10   20   30   40   50   60   70   80   90  100  110  120  130  140  150 
  13   12   14   16   14    6    4    4    6    2    1    1    0    3    0    5 
 160  170  180  190  200  210  220  230  240  250  260  270  280  290  300  310 
   3   11    3    2   10    8    9    8    1    4    8    1    1    7    9    0 
 320  330  340  350  360  370  380  390  400  410  420  430  440  450  460  470 
   1    0    5    5    8    1    4    1    3    0   11    1    4   13    3   16 
 480  490  500  510  520  530  540  550  560  570  580  590  600  610  620  630 
   4   14    8    0    2    0    0    0    4    7    7   15    5    0    0    1 
 640  650  660  670  680  690  700  710  720  730  740  750  760  770  780  790 
   8    4    1    0    0    5    2    1    0    0    3    4    2    0    0    3 
 800  810  820  830  840  850  860  870  880  890  900  910  920  930  940  950 
   4    9    3    1    2    1    0    2    1    0    0    1    1    2    6    0 
 960  970  980  990 1000 1010 1020 1030 1040 1050 1060 1070 1080 1090 
   3   10    3    0    6    0    0    0    0    4    0    0    5    5 

> summary(ik.cma)

	Close modern analogues of fossil samples

Call: cma(object = ik.ana, cutoff = 0.91) 

Dissimilarity: chord 

     k: Not supplied

Cutoff: 0.91 

	Number of analogues per fossil sample:

   0   10   20   30   40   50   60   70   80   90  100  110  120  130  140  150 
  13   12   14   16   14    6    4    4    6    2    1    1    0    3    0    5 
 160  170  180  190  200  210  220  230  240  250  260  270  280  290  300  310 
   3   11    3    2   10    8    9    8    1    4    8    1    1    7    9    0 
 320  330  340  350  360  370  380  390  400  410  420  430  440  450  460  470 
   1    0    5    5    8    1    4    1    3    0   11    1    4   13    3   16 
 480  490  500  510  520  530  540  550  560  570  580  590  600  610  620  630 
   4   14    8    0    2    0    0    0    4    7    7   15    5    0    0    1 
 640  650  660  670  680  690  700  710  720  730  740  750  760  770  780  790 
   8    4    1    0    0    5    2    1    0    0    3    4    2    0    0    3 
 800  810  820  830  840  850  860  870  880  890  900  910  920  930  940  950 
   4    9    3    1    2    1    0    2    1    0    0    1    1    2    6    0 
 960  970  980  990 1000 1010 1020 1030 1040 1050 1060 1070 1080 1090 
   3   10    3    0    6    0    0    0    0    4    0    0    5    5 


Distances:

       0    10    20    30    40    50    60    70    80    90  100   110 120
1  0.900 0.902 0.903 0.904 0.904 0.907 0.907 0.908 0.908 0.908 0.91 0.908    
2  0.903 0.904 0.904 0.904 0.905 0.908 0.908 0.909 0.908 0.910               
3  0.903 0.904 0.906 0.904 0.906 0.908 0.909 0.910 0.909                     
4  0.903 0.906 0.906 0.905 0.906 0.909 0.910 0.910 0.909                     
5  0.905 0.906 0.906 0.905 0.908 0.909             0.909                     
6  0.905 0.907 0.906 0.905 0.908 0.909             0.910                     
7  0.907 0.907 0.907 0.906 0.908                                             
8  0.907 0.908 0.907 0.906 0.908                                             
9  0.907 0.909 0.907 0.906 0.908                                             
10 0.908 0.910 0.907 0.906 0.908                                             
11 0.908 0.910 0.907 0.907 0.908                                             
12 0.909 0.910 0.908 0.908 0.909                                             
13 0.910       0.909 0.908 0.909                                             
14             0.909 0.909 0.909                                             
15                   0.909                                                   
16                   0.909                                                   
     130 140   150   160   170   180   190   200   210   220   230   240   250
1  0.909     0.908 0.908 0.906 0.908 0.909 0.906 0.907 0.906 0.906 0.906 0.906
2  0.909     0.909 0.910 0.907 0.910 0.910 0.908 0.908 0.909 0.908       0.908
3  0.910     0.909 0.910 0.907 0.910       0.908 0.908 0.909 0.908       0.909
4            0.910       0.907             0.908 0.908 0.909 0.908       0.910
5            0.910       0.907             0.908 0.909 0.909 0.909            
6                        0.908             0.909 0.910 0.909 0.909            
7                        0.908             0.909 0.910 0.909 0.910            
8                        0.908             0.910 0.910 0.910 0.910            
9                        0.909             0.910       0.910                  
10                       0.910             0.910                              
11                       0.910                                                
12                                                                            
13                                                                            
14                                                                            
15                                                                            
16                                                                            
     260   270  280   290   300 310  320 330   340   350   360  370   380  390
1  0.906 0.909 0.91 0.907 0.907     0.91     0.907 0.908 0.908 0.91 0.908 0.91
2  0.908            0.908 0.908              0.908 0.909 0.909      0.909     
3  0.908            0.909 0.908              0.908 0.909 0.909      0.909     
4  0.908            0.909 0.909              0.909 0.910 0.909      0.909     
5  0.908            0.910 0.909              0.909 0.910 0.909                
6  0.909            0.910 0.909                          0.909                
7  0.909            0.910 0.909                          0.909                
8  0.910                  0.910                          0.909                
9                         0.910                                               
10                                                                            
11                                                                            
12                                                                            
13                                                                            
14                                                                            
15                                                                            
16                                                                            
     400 410   420   430   440   450   460   470   480   490   500 510   520
1  0.907     0.906 0.909 0.905 0.906 0.907 0.906 0.909 0.907 0.906     0.907
2  0.907     0.907       0.908 0.907 0.907 0.906 0.909 0.907 0.907     0.910
3  0.909     0.907       0.909 0.907 0.909 0.907 0.909 0.908 0.908          
4            0.907       0.909 0.908       0.907 0.910 0.908 0.908          
5            0.908             0.908       0.907       0.908 0.908          
6            0.908             0.908       0.907       0.908 0.909          
7            0.909             0.908       0.907       0.908 0.909          
8            0.909             0.909       0.907       0.909 0.910          
9            0.909             0.909       0.908       0.909                
10           0.909             0.909       0.908       0.909                
11           0.910             0.909       0.908       0.910                
12                             0.910       0.908       0.910                
13                             0.910       0.909       0.910                
14                                         0.909       0.910                
15                                         0.909                            
16                                         0.909                            
   530 540 550   560   570   580   590   600 610 620   630   640   650  660 670
1              0.907 0.907 0.906 0.904 0.906         0.906 0.907 0.906 0.91    
2              0.908 0.907 0.907 0.907 0.908               0.908 0.907         
3              0.910 0.909 0.907 0.907 0.908               0.909 0.909         
4              0.910 0.909 0.907 0.907 0.909               0.909 0.909         
5                    0.909 0.908 0.907 0.910               0.909               
6                    0.909 0.908 0.907                     0.909               
7                    0.910 0.910 0.907                     0.910               
8                                0.908                     0.910               
9                                0.908                                         
10                               0.908                                         
11                               0.909                                         
12                               0.909                                         
13                               0.909                                         
14                               0.909                                         
15                               0.910                                         
16                                                                             
   680   690   700   710 720 730   740   750   760 770 780   790   800   810
1      0.907 0.909 0.909         0.908 0.907 0.909         0.907 0.907 0.908
2      0.909 0.909               0.909 0.909 0.910         0.908 0.908 0.908
3      0.909                     0.910 0.909               0.910 0.909 0.909
4      0.909                           0.910                     0.910 0.909
5      0.910                                                           0.909
6                                                                      0.909
7                                                                      0.909
8                                                                      0.910
9                                                                      0.910
10                                                                          
11                                                                          
12                                                                          
13                                                                          
14                                                                          
15                                                                          
16                                                                          
     820   830   840  850 860  870   880 890 900   910   920   930   940 950
1  0.908 0.906 0.907 0.91     0.91 0.909         0.908 0.909 0.909 0.907    
2  0.910       0.909          0.91                           0.910 0.908    
3  0.910                                                           0.909    
4                                                                  0.909    
5                                                                  0.909    
6                                                                  0.910    
7                                                                           
8                                                                           
9                                                                           
10                                                                          
11                                                                          
12                                                                          
13                                                                          
14                                                                          
15                                                                          
16                                                                          
     960   970   980 990  1000 1010 1020 1030 1040  1050 1060 1070  1080  1090
1  0.909 0.908 0.907     0.908                     0.906           0.908 0.907
2  0.910 0.908 0.909     0.908                     0.909           0.908 0.908
3  0.910 0.909 0.909     0.909                     0.909           0.909 0.908
4        0.909           0.909                     0.909           0.909 0.908
5        0.909           0.909                                     0.910 0.910
6        0.909           0.910                                                
7        0.909                                                                
8        0.910                                                                
9        0.910                                                                
10       0.910                                                                
11                                                                            
12                                                                            
13                                                                            
14                                                                            
15                                                                            
16                                                                            

Samples:

         0      10      20      30      40      50       60      70      80
1  V12.122 V12.122 V12.122 V20.230 V22.172 V22.172  V22.172  V10.89 V22.172
2    V14.5 V20.234 V20.234  V14.90 V20.167 V20.167 A153.154 V22.172 V19.216
3  V20.234   V14.5  V16.21 V22.172 V19.216 V19.216   V10.89  V16.21 V20.167
4   V18.21  V18.21 A180.76   V9.31  V10.89  V10.89  A179.13  V14.90  V16.21
5  A180.76 A180.76   V14.5  V12.79 V22.204  V16.21                   V10.89
6  A180.72 A180.72 V15.164 V19.216  V16.21 V15.164                  V15.164
7  V15.164 V20.230 V20.230 A180.72 V20.234                                 
8   V16.21 V20.167  V14.90 V22.204 V20.230                                 
9  V20.167  V16.21 A180.72 A180.76  V14.90                                 
10 V20.230   V20.7 V20.167 V20.167 V15.164                                 
11  V12.79  V12.79   V9.31 V20.234 A180.72                                 
12 V22.172  V14.90  V18.21  V16.21  V12.79                                 
13  V14.90          V12.79 V15.164 V12.122                                 
14                 V22.172 V12.122 A180.76                                 
15                          V10.89                                         
16                          V3.128                                         
        90     100   110  120     130  140     150     160      170     180
1  V19.216 V19.216 V9.31 None   V9.31 None  V10.89 V20.167  V20.167 A179.13
2  V22.172                     V14.90      V22.172 V20.230   V10.89 V20.167
3                             V19.216      V20.167  V10.89  V20.230  V14.90
4                                          V19.216           V16.21        
5                                           V16.21          V22.172        
6                                                          A153.154        
7                                                            V14.90        
8                                                           A179.13        
9                                                             V9.31        
10                                                          V22.219        
11                                                          V19.216        
12                                                                         
13                                                                         
14                                                                         
15                                                                         
16                                                                         
       190     200     210     220     230    240     250     260    270
1  V19.216 V20.230  V14.90 V12.122 V12.122 V3.128  V14.90  V14.90 V14.90
2  V20.230  V14.90 V22.172  V14.90  V18.21        V22.204 V20.167       
3          V22.172 V20.167 V20.230  V14.90        V22.172 V22.172       
4            V9.31  V3.128  V18.21   V14.5        A180.72  V3.128       
5          V20.167 V12.122 V20.167 A180.76                V12.122       
6          V20.234 V20.230 V20.234 V20.234                A180.72       
7          V12.122 V20.234   V14.5  V3.128                V22.204       
8           V12.79 A180.72 V22.172 A180.72                 V12.79       
9           V16.21         A180.72                                      
10         A180.72                                                      
11                                                                      
12                                                                      
13                                                                      
14                                                                      
15                                                                      
16                                                                      
       280     290     300  310     320  330      340     350     360     370
1  V22.172 V12.122 V22.172 None V19.216 None  V19.216 V20.230 V20.167 V19.216
2           V14.90 V20.167                     V10.89 V20.167 V22.172        
3          A180.72 V19.216                    V22.172   V9.31  V16.21        
4            V14.5 V15.164                   A153.154 V19.216  V10.89        
5          V20.167  V16.21                    V20.167  V14.90  V14.90        
6           V18.21  V10.89                                    V20.234        
7          A180.76  V14.90                                    V15.164        
8                  V20.234                                    V12.122        
9                  V20.230                                                   
10                                                                           
11                                                                           
12                                                                           
13                                                                           
14                                                                           
15                                                                           
16                                                                           
       380     390     400  410     420     430     440     450     460     470
1    V9.31 V19.216   V9.31 None   V9.31 V12.122   V9.31 A180.76 V20.167 V20.167
2  V12.122          V14.90      V20.234          V14.90  V18.21  V3.128 V22.172
3  V20.234         V22.204       V14.90         V20.234 V20.234   V14.5 V20.234
4   V14.90                      V20.230         V20.230 A180.72          V3.128
5                               V22.172                 V12.122          V14.90
6                               V12.122                   V14.5         V20.230
7                               V20.167                 V20.230         A180.76
8                               V15.164                 V15.164         A180.72
9                                V3.128                  V3.128         V22.204
10                              A180.76                  V14.90         V19.216
11                              A180.72                 V20.167          V10.89
12                                                      V22.204          V12.79
13                                                      V22.172         V15.164
14                                                                        V9.31
15                                                                        V14.5
16                                                                       V16.21
       480     490     500  510     520  530  540  550     560     570     580
1   V14.90 V20.234 V12.122 None  V14.90 None None None  V14.90 V20.230 V22.204
2  A180.76  V3.128 V20.234      V22.204                V20.230   V9.31  V12.79
3  V22.204 A180.76 A180.76                             A180.76 A180.78  V14.90
4  V22.172 A180.72 V20.230                               V9.31  V14.90 A180.72
5          V12.122  V18.21                                     A180.72 V22.172
6          V22.204 A180.72                                     V22.204 V20.230
7           V18.21  V3.128                                     A180.76 A180.76
8           V14.90   V14.5                                                    
9            V14.5                                                            
10         V20.230                                                            
11          V12.79                                                            
12         A180.78                                                            
13         V22.172                                                            
14         V20.167                                                            
15                                                                            
16                                                                            
       590     600  610  620    630     640     650    660  670  680     690
1  V20.167  V14.90 None None V14.90 V12.122 V22.204 V14.90 None None A179.13
2  V22.172 A180.72                   V14.90 V12.122                   V16.21
3  V15.164 A180.76                  V20.234 V20.234                   V10.89
4   V16.21 V22.204                  V20.167  V14.90                  V15.164
5   V10.89 V12.122                    V14.5                          V20.167
6  V19.216                          V22.204                                 
7  V20.230                          A180.72                                 
8  V20.234                           V3.128                                 
9   V3.128                                                                  
10  V14.90                                                                  
11 A180.76                                                                  
12 V12.122                                                                  
13   V9.31                                                                  
14 V22.204                                                                  
15 A179.13                                                                  
16                                                                          
       700     710  720  730     740     750     760  770  780     790     800
1  V12.122 V20.167 None None  V14.90 V22.204 V20.234 None None  V18.21 V12.122
2  V22.204                   V22.204 V20.234 V22.204           V12.122  V18.21
3                            A180.72  V14.90                     V14.5   V14.5
4                                    A180.72                           V20.234
5                                                                             
6                                                                             
7                                                                             
8                                                                             
9                                                                             
10                                                                            
11                                                                            
12                                                                            
13                                                                            
14                                                                            
15                                                                            
16                                                                            
       810     820     830     840     850  860     870     880  890  900
1  V12.122  V14.90 V19.216 V19.216 V22.204 None V19.216 V19.216 None None
2   V14.90 V22.204          V16.33              V22.172                  
3  V22.172 V19.216                                                       
4  V22.204                                                               
5  V15.164                                                               
6  V20.234                                                               
7   V12.79                                                               
8    V14.5                                                               
9   V18.21                                                               
10                                                                       
11                                                                       
12                                                                       
13                                                                       
14                                                                       
15                                                                       
16                                                                       
       910     920     930     940  950     960     970     980  990    1000
1  V19.216 V19.216   V9.31 V19.216 None V20.230   V9.31   V9.31 None V19.216
2                  V20.230 V20.230      V12.122 V20.234 V20.230       V14.90
3                            V9.31      V20.234 V20.230  V14.90      V22.172
4                          V20.167              V22.172                V9.31
5                           V14.90              A180.76              V20.230
6                          V22.172              V19.216               V12.79
7                                                V16.21                     
8                                               V20.167                     
9                                               A180.72                     
10                                               V14.90                     
11                                                                          
12                                                                          
13                                                                          
14                                                                          
15                                                                          
16                                                                          
   1010 1020 1030 1040    1050 1060 1070    1080    1090
1  None None None None V19.216 None None V19.216 V22.172
2                      V22.204           V12.122 V22.204
3                       V14.90           V22.172  V14.90
4                      V22.172            V14.90 V19.216
5                                        V22.204  V10.89
6                                                       
7                                                       
8                                                       
9                                                       
10                                                      
11                                                      
12                                                      
13                                                      
14                                                      
15                                                      
16                                                      
> 
> ## plot the results
> plot(ik.cma)
> 
> 
> 
> 
> cleanEx()
> nameEx("crossval")
> ### * crossval
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: crossval
> ### Title: Cross-validation of palaeoecological transfer function models
> ### Aliases: crossval crossval.wa print.crossval predWA predWAT
> ### Keywords: methods
> 
> ### ** Examples
> 
> ## Load the Imbrie & Kipp data and
> ## summer sea-surface temperatures
> data(ImbrieKipp)
> data(SumSST)
>      
> ## fit the WA model
> mod <- wa(SumSST ~., data = ImbrieKipp)
> mod

	Weighted Averaging Transfer Function

Call:
wa(formula = SumSST ~ ., data = ImbrieKipp) 

Deshrinking  : Inverse 
Tolerance DW : No 
No. samples  : 61 
No. species  : 27 

Performance:
     RMSE  R-squared  Avg. Bias  Max. Bias  
   2.0188     0.9173     0.0000    -3.8155  

> 
> ## Leave one out CV
> cv.loo <- crossval(mod)
> cv.loo
	Model Cross-validation:

crossval(obj = mod)

Method: LOO

       R2   avgBias maxBias  RMSEP RMSEP2 s1 s2
1 0.90028 -0.013652 -4.5985 2.2179     NA NA NA
> 
> ## k-fold CV (k == 10)
> cv.kfold <- crossval(mod, kfold = 10, folds = 1, method = "kfold")
> cv.kfold
	Model Cross-validation:

crossval(obj = mod, method = "kfold", folds = 1, kfold = 10)

Method: kfold
k: 10
No. of folds: 1

       R2   avgBias maxBias RMSEP RMSEP2 s1 s2
1 0.90065 -0.029184 -4.6765 2.214     NA NA NA
> 
> ## n k-fold CV (k == 10, n = 10)
> cv.nkfold <- crossval(mod, kfold = 10, folds = 10, method = "kfold")
> cv.nkfold
	Model Cross-validation:

crossval(obj = mod, method = "kfold", folds = 10, kfold = 10)

Method: kfold
k: 10
No. of folds: 10

       R2   avgBias maxBias  RMSEP RMSEP2      s1     s2
1 0.90095 -0.018397 -4.4867 2.2103  2.219 0.19676 2.2103
> 
> ## bootstrap with 250 bootstrap samples
> cv.boot <- crossval(mod, method = "bootstrap", nboot = 250)
> cv.boot
	Model Cross-validation:

crossval(obj = mod, method = "bootstrap", nboot = 250)

Method: bootstrap
No. Bootstraps: 250

       R2   avgBias maxBias  RMSEP RMSEP2      s1     s2
1 0.90058 -0.024041 -4.6388 2.2154  2.268 0.48544 2.2154
> 
> ## extract fitted values and residuals
> fitted(cv.boot)
 [1]  4.059474  3.512224  4.043551  3.941855  8.396231  9.231595  2.978492
 [8] 14.638811 14.592184 17.022299 16.086831 19.009756 18.618335 18.704197
[15] 17.529793 20.658284 19.957867 19.897079 18.675342 22.961249 22.410862
[22] 20.754714 22.445923 22.070197 21.436109 23.397509 23.355480 22.821434
[29] 24.245662 25.693952 25.521378 23.244859 23.639174 22.991198 24.522527
[36] 25.382445 25.780077 26.326678 24.034737 25.479643 26.315235 25.836728
[43] 26.758383 26.435854 26.134603 25.703454 25.866838 26.344534 26.814951
[50] 26.766758 26.789727 26.010655 26.919888 26.799625 26.435941 26.024368
[57] 26.619740 27.197733 26.772632 26.929916 26.818910
> resid(cv.boot)
 [1] -2.05947366  1.48777625  1.45644862  3.05814525 -1.39623149  1.26840545
 [7]  8.02150788 -4.63881094 -1.59218406 -5.02229850 -2.08683146 -4.50975596
[13] -3.61833535 -4.20419667 -1.52979314 -2.65828422  0.04213292 -1.89707920
[19]  0.32465829 -4.46124928 -0.91086197  0.24528647 -1.44592277  1.92980296
[25]  2.56389076 -0.39750884  0.64452012  0.17856633 -1.24566234 -1.69395229
[31] -0.52137763  2.75514138  2.36082622  3.00880154  0.47747342  0.61755476
[37]  0.21992320 -1.82667759  2.96526290  0.72035748 -1.31523506  0.66327194
[43] -0.55838265 -0.43585425 -0.13460251  1.29654604  1.13316236  1.15546621
[49]  0.18504888  0.23324186  0.21027334  0.98934542  0.08011151  2.20037549
[55]  2.06405926  1.47563233  0.88025973  0.30226739  0.22736763  0.07008432
[61]  1.18109032
> 
> 
> 
> 
> cleanEx()
> nameEx("densityplot.residLen")
> ### * densityplot.residLen
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: densityplot.residLen
> ### Title: Lattice density plot for residual lengths
> ### Aliases: densityplot.residLen
> ### Keywords: hplot methods
> 
> ### ** Examples
> 
> ## load the Imbrie and Kipp example data
> data(ImbrieKipp, SumSST, V12.122)
> 
> ## squared residual lengths for Core V12.122
> rlens <- residLen(ImbrieKipp, SumSST, V12.122)
> rlens

	Squared residual lengths

Call: residLen(X = ImbrieKipp, env = SumSST, passive = V12.122)

Ordination Method: cca

Quantiles of residual lengths:

                50%  75%  90%  95%  99%
Training Set: 0.854 1.56 2.45 2.61 3.72
Passive:      1.004 1.50 1.87 2.17 2.55
> 
> ## plot the density functions of the residual distances
> densityplot(rlens)
> 
> 
> 
> 
> cleanEx()
> nameEx("dissimilarities")
> ### * dissimilarities
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: dissimilarities
> ### Title: Extract dissimilarity coefficients from models
> ### Aliases: dissimilarities dissimilarities.analog dissimilarities.mat
> ###   dissim
> ### Keywords: methods multivariate
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## analog matching between SWAPImbrie & Kipp and V12.122 core
> ik.analog <- analog(ImbrieKipp, V12.122, method = "chord")
> ik.analog

	Analogue matching for fossil samples

Call: analog(x = ImbrieKipp, y = V12.122, method = "chord") 
Dissimilarity: chord 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

	Minimum dissimilarity per sample

Dissimilarity: chord 

    0    10    20    30    40    50    60    70    80    90   100   110   120 
0.900 0.902 0.903 0.904 0.904 0.907 0.907 0.908 0.908 0.908 0.910 0.908 0.910 
  130   140   150   160   170   180   190   200   210   220   230   240   250 
0.909 0.911 0.908 0.908 0.906 0.908 0.909 0.906 0.907 0.906 0.906 0.906 0.906 
  260   270   280   290   300   310   320   330   340   350   360   370   380 
0.906 0.909 0.910 0.907 0.907 0.912 0.910 0.911 0.907 0.908 0.908 0.910 0.908 
  390   400   410   420   430   440   450   460   470   480   490   500   510 
0.910 0.907 0.911 0.906 0.909 0.905 0.906 0.907 0.906 0.909 0.907 0.906 0.911 
  520   530   540   550   560   570   580   590   600   610   620   630   640 
0.907 0.910 0.910 0.910 0.907 0.907 0.906 0.904 0.906 0.910 0.913 0.906 0.907 
  650   660   670   680   690   700   710   720   730   740   750   760   770 
0.906 0.910 0.911 0.913 0.907 0.909 0.909 0.912 0.914 0.908 0.907 0.909 0.911 
  780   790   800   810   820   830   840   850   860   870   880   890   900 
0.914 0.907 0.907 0.908 0.908 0.906 0.907 0.910 0.910 0.910 0.909 0.913 0.912 
  910   920   930   940   950   960   970   980   990  1000  1010  1020  1030 
0.908 0.909 0.909 0.907 0.910 0.909 0.908 0.907 0.911 0.908 0.913 0.910 0.910 
 1040  1050  1060  1070  1080  1090 
0.912 0.906 0.910 0.910 0.908 0.907 

> summary(ik.analog)

	Analogue matching for fossil samples

Call: analog(x = ImbrieKipp, y = V12.122, method = "chord") 
Dissimilarity: chord 
k-closest: 10 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

k-closest analogues

   k         0        10        20        30        40        50        60
   1  V12.122   V12.122   V12.122   V20.230   V22.172   V22.172   V22.172 
   2  V14.5     V20.234   V20.234   V14.90    V20.167   V20.167   A153.154
   3  V20.234   V14.5     V16.21    V22.172   V19.216   V19.216   V10.89  
   4  V18.21    V18.21    A180.76   V9.31     V10.89    V10.89    A179.13 
   5  A180.76   A180.76   V14.5     V12.79    V22.204   V16.21    V16.21  
   6  A180.72   A180.72   V15.164   V19.216   V16.21    V15.164   V20.167 
   7  V15.164   V20.230   V20.230   A180.72   V20.234   V20.234   V22.219 
   8  V16.21    V20.167   V14.90    V22.204   V20.230   A153.154  V19.308 
   9  V20.167   V16.21    A180.72   A180.76   V14.90    V20.230   V12.18  
  10  V20.230   V20.7     V20.167   V20.167   V15.164   A179.13   V19.216 
        70        80        90       100       110       120       130
  V10.89    V22.172   V19.216   V19.216   V9.31     V9.31     V9.31   
  V22.172   V19.216   V22.172   V22.204   V14.90    V19.216   V14.90  
  V16.21    V20.167   V22.204   V9.31     V20.230   V22.172   V19.216 
  V14.90    V16.21    V16.190   V22.172   V19.216   V14.90    V22.172 
  V19.216   V10.89    A153.154  V20.234   V22.204   V20.230   V20.230 
  A153.154  V15.164   V14.90    V14.90    V12.79    V20.167   V12.79  
  V20.167   A179.13   V9.31     V16.21    V22.172   A153.154  V22.204 
  V20.234   V20.230   V20.167   V10.89    A180.72   V22.204   A153.154
  V22.204   V20.234   V12.18    A153.154  A180.76   V12.79    V16.190 
  V9.31     V14.90    V10.89    V15.164   V20.234   V3.128    A180.72 
       140       150       160       170       180       190       200
  V9.31     V10.89    V20.167   V20.167   A179.13   V19.216   V20.230 
  V22.172   V22.172   V20.230   V10.89    V20.167   V20.230   V14.90  
  V20.230   V20.167   V10.89    V20.230   V14.90    V14.90    V22.172 
  V20.234   V19.216   V19.216   V16.21    V20.230   V9.31     V9.31   
  V14.90    V16.21    V9.31     V22.172   V10.89    V22.172   V20.167 
  V20.167   A153.154  V14.90    A153.154  V16.21    V20.167   V20.234 
  V12.122   V14.90    A153.154  V14.90    V22.172   V12.79    V12.122 
  V19.216   V20.234   V16.190   A179.13   V9.31     V12.122   V12.79  
  A180.72   V15.164   V16.33    V9.31     V15.164   V20.234   V16.21  
  V16.21    V20.230   V22.172   V22.219   V19.216   V3.128    A180.72 
       210       220       230       240       250       260       270
  V14.90    V12.122   V12.122   V3.128    V14.90    V14.90    V14.90  
  V22.172   V14.90    V18.21    V20.167   V22.204   V20.167   V22.172 
  V20.167   V20.230   V14.90    V12.122   V22.172   V22.172   A180.72 
  V3.128    V18.21    V14.5     V14.90    A180.72   V3.128    V12.122 
  V12.122   V20.167   A180.76   V18.21    V12.79    V12.122   V12.79  
  V20.230   V20.234   V20.234   V22.172   V12.122   A180.72   V22.204 
  V20.234   V14.5     V3.128    A180.76   A180.76   V22.204   V3.128  
  A180.72   V22.172   A180.72   V15.164   V20.167   V12.79    A180.78 
  V15.164   A180.72   V20.167   A180.72   V10.89    A180.76   V18.21  
  A180.76   A180.76   V15.164   V14.5     V15.164   V20.230   V20.167 
       280       290       300       310       320       330       340
  V22.172   V12.122   V22.172   V19.216   V19.216   V22.172   V19.216 
  V14.90    V14.90    V20.167   V16.33    V9.31     V19.216   V10.89  
  V12.122   A180.72   V19.216   V14.90    V22.172   V14.90    V22.172 
  V22.204   V14.5     V15.164   V22.172   V20.230   V10.89    A153.154
  V19.216   V20.167   V16.21    V9.31     V20.234   A153.154  V20.167 
  V15.164   V18.21    V10.89    V10.89    V20.167   V22.204   A179.13 
  V18.21    A180.76   V14.90    V20.167   V22.204   V9.31     V22.204 
  V12.79    V20.234   V20.234   V20.230   V14.90    A180.39   V19.308 
  V14.5     V3.128    V20.230   V16.190   V16.21    V16.190   V16.21  
  V20.234   V22.172   A179.13   V16.21    V10.89    V22.219   V22.219 
       350       360       370       380       390       400       410
  V20.230   V20.167   V19.216   V9.31     V19.216   V9.31     V3.128  
  V20.167   V22.172   V22.172   V12.122   V22.172   V14.90    V12.122 
  V9.31     V16.21    V20.167   V20.234   V3.128    V22.204   V20.167 
  V19.216   V10.89    V3.128    V14.90    V12.122   A180.76   V20.230 
  V14.90    V14.90    V22.204   V20.230   V14.90    V20.230   V14.90  
  V16.21    V20.234   V12.122   A180.76   V9.31     A180.72   V9.31   
  V22.172   V15.164   V20.234   V3.128    V20.234   V22.172   V22.172 
  V16.33    V12.122   V20.230   A180.72   V16.33    V12.79    V20.7   
  V10.89    A179.13   V15.164   V22.204   V20.167   V19.216   V20.234 
  V15.164   V20.230   V16.33    V20.167   V22.204   V20.234   V19.216 
       420       430       440       450       460       470       480
  V9.31     V12.122   V9.31     A180.76   V20.167   V20.167   V14.90  
  V20.234   V9.31     V14.90    V18.21    V3.128    V22.172   A180.76 
  V14.90    V14.90    V20.234   V20.234   V14.5     V20.234   V22.204 
  V20.230   V20.234   V20.230   A180.72   V18.21    V3.128    V22.172 
  V22.172   A180.76   V12.122   V12.122   A180.76   V14.90    A180.72 
  V12.122   V20.230   A180.72   V14.5     V20.234   V20.230   V12.79  
  V20.167   V3.128    V22.204   V20.230   V12.122   A180.76   V20.230 
  V15.164   A180.72   A180.76   V15.164   V20.230   A180.72   V20.234 
  V3.128    V20.167   V12.79    V3.128    A180.72   V22.204   V3.128  
  A180.76   V22.172   V19.216   V14.90    V15.164   V19.216   A180.78 
       490       500       510       520       530       540       550
  V20.234   V12.122   V9.31     V14.90    V20.167   V10.89    V22.204 
  V3.128    V20.234   V22.204   V22.204   V19.216   A153.154  V16.190 
  A180.76   A180.76   V14.90    V9.31     V22.172   V22.219   V19.216 
  A180.72   V20.230   V20.234   V3.128    V10.89    V19.216   V22.172 
  V12.122   V18.21    V20.230   V19.216   V16.21    V12.18    V14.90  
  V22.204   A180.72   V12.122   A180.76   V22.204   V16.190   V20.230 
  V18.21    V3.128    A180.72   A180.72   V12.122   V22.172   V12.79  
  V14.90    V14.5     V19.216   A180.78   V15.164   V16.21    V9.31   
  V14.5     V20.7     A180.76   V12.79    V20.234   V20.167   A180.72 
  V20.230   V20.167   V22.172   V22.172   V20.230   V22.204   V10.89  
       560       570       580       590       600       610       620
  V14.90    V20.230   V22.204   V20.167   V14.90    V20.167   V22.204 
  V20.230   V9.31     V12.79    V22.172   A180.72   V14.90    V20.167 
  A180.76   A180.78   V14.90    V15.164   A180.76   V22.204   V19.216 
  V9.31     V14.90    A180.72   V16.21    V22.204   V12.122   V12.122 
  A180.72   A180.72   V22.172   V10.89    V12.122   V22.172   V22.172 
  A180.78   V22.204   V20.230   V19.216   V9.31     V20.230   V3.128  
  V3.128    A180.76   A180.76   V20.230   V20.234   V19.216   V20.234 
  V12.79    V3.128    V9.31     V20.234   V22.172   V3.128    V14.90  
  V22.172   V12.79    V19.216   V3.128    V12.79    V12.79    V20.230 
  V22.204   V20.234   V20.234   V14.90    V20.230   A180.72   V16.33  
       630       640       650       660       670       680       690
  V14.90    V12.122   V22.204   V14.90    V9.31     V3.128    A179.13 
  V9.31     V14.90    V12.122   V19.216   V20.234   V14.90    V16.21  
  A180.76   V20.234   V20.234   V22.204   V22.204   V22.172   V10.89  
  A180.72   V20.167   V14.90    V20.167   V14.90    V20.167   V15.164 
  V12.122   V14.5     V22.172   V22.172   A180.72   V19.216   V20.167 
  V22.204   V22.204   A180.72   V9.31     V22.172   V9.31     V22.172 
  V20.230   A180.72   V20.167   V3.128    V20.230   V22.204   V22.204 
  V20.234   V3.128    V14.5     V16.33    V12.122   V16.190   V22.219 
  V22.172   V18.21    A180.76   A180.72   V20.167   V20.230   V12.18  
  V20.167   V20.230   V15.164   V10.89    V15.164   A180.72   V19.308 
       700       710       720       730       740       750       760
  V12.122   V20.167   V22.204   V14.90    V14.90    V22.204   V20.234 
  V22.204   V3.128    V22.172   V3.128    V22.204   V20.234   V22.204 
  V20.167   V16.21    V9.31     V9.31     A180.72   V14.90    V14.90  
  V20.234   V15.164   V20.230   V22.172   V12.122   A180.72   A180.76 
  V22.172   V10.89    V14.90    V22.204   V22.172   V12.79    A180.72 
  V19.216   V20.234   V3.128    V20.230   V20.234   V22.172   V3.128  
  V16.21    V12.122   V10.89    V20.167   V20.230   V20.230   V20.167 
  V10.89    V20.230   V19.216   V12.122   V12.79    V12.122   V12.122 
  V15.164   V22.172   V20.167   V19.216   V20.167   V9.31     V20.230 
  A180.72   V22.204   A180.72   V20.234   V3.128    A180.76   V9.31   
       770       780       790       800       810       820       830
  V3.128    V3.128    V18.21    V12.122   V12.122   V14.90    V19.216 
  V20.167   V18.21    V12.122   V18.21    V14.90    V22.204   V22.172 
  V15.164   A180.78   V14.5     V14.5     V22.172   V19.216   V20.167 
  V20.230   V14.90    V20.167   V20.234   V22.204   V12.79    V16.33  
  V14.90    V12.122   V14.90    V20.167   V15.164   V22.172   V22.204 
  V16.21    V22.172   A180.72   V15.164   V20.234   V20.230   V14.90  
  V22.204   V20.167   V3.128    A180.72   V12.79    A180.72   V12.122 
  A180.76   A180.72   A180.76   V14.90    V14.5     V20.167   V16.190 
  V9.31     V20.230   V20.234   V12.79    V18.21    V10.89    V12.79  
  V12.122   V14.5     V15.164   V16.21    A180.72   A180.76   V10.89  
       840       850       860       870       880       890       900
  V19.216   V22.204   V22.204   V19.216   V19.216   V19.216   V19.216 
  V16.33    V20.234   V14.90    V22.172   V9.31     V19.222   V9.31   
  V22.204   V19.216   V22.172   V20.167   V22.172   V16.190   V12.79  
  V20.167   V9.31     V20.167   V22.204   V20.230   V10.98    V22.204 
  V20.234   V14.90    V19.216   V15.164   V12.122   V22.204   V14.90  
  V10.89    V12.122   V10.89    V14.90    V14.90    A180.39   V22.172 
  V22.172   V20.167   A179.13   V3.128    V20.234   V14.90    V20.230 
  A180.72   V20.230   V15.164   V10.89    V12.79    V22.172   V16.190 
  V9.31     A180.76   V12.18    V20.230   V20.167   V12.79    A180.39 
  V14.90    A180.72   V9.31     V16.21    A180.72   V9.31     V19.222 
       910       920       930       940       950       960       970
  V19.216   V19.216   V9.31     V19.216   V20.167   V20.230   V9.31   
  V22.204   V9.31     V20.230   V20.230   V14.90    V12.122   V20.234 
  V16.190   V16.190   V19.216   V9.31     V16.21    V20.234   V20.230 
  V22.172   V14.90    V22.204   V20.167   V20.230   V12.79    V22.172 
  V19.222   V22.204   V22.172   V14.90    V12.122   V22.172   A180.76 
  V12.79    V22.172   V14.90    V22.172   V9.31     V16.21    V19.216 
  A180.39   V20.230   V20.234   V12.79    V20.234   V19.216   V16.21  
  V14.90    A180.39   V20.167   V16.21    V15.164   V9.31     V20.167 
  A153.154  V10.98    V12.79    A180.72   V22.172   V14.90    A180.72 
  V9.31     V12.79    A180.72   V20.234   A179.13   A180.72   V14.90  
       980       990      1000      1010      1020      1030      1040
  V9.31     V9.31     V19.216   V14.90    V19.216   V14.90    V9.31   
  V20.230   V20.234   V14.90    V9.31     V16.190   V19.216   V14.90  
  V14.90    V20.230   V22.172   V20.230   V22.204   V22.172   V22.204 
  V20.234   V14.90    V9.31     V22.172   V22.172   V22.204   V19.216 
  A180.76   V22.172   V20.230   V12.79    V19.222   V9.31     V20.234 
  V22.172   V22.204   V12.79    A180.72   V14.90    V12.79    V12.79  
  A180.72   V12.79    V20.167   V19.216   A180.39   V16.190   V22.172 
  V12.79    V12.122   A180.72   V22.204   V12.66    A180.72   A180.72 
  V19.216   V19.216   V22.204   A180.39   V10.98    V20.234   A180.78 
  V12.122   A180.72   V16.21    V12.122   V12.79    V20.230   A180.76 
      1050      1060      1070      1080      1090
  V19.216   V22.204   V16.190   V19.216   V22.172 
  V22.204   V19.216   V19.216   V12.122   V22.204 
  V14.90    V14.90    V22.172   V22.172   V14.90  
  V22.172   V12.122   V22.204   V14.90    V19.216 
  V12.79    V22.172   V14.90    V22.204   V10.89  
  V9.31     V12.79    V12.18    V20.167   V20.167 
  V12.122   A180.72   V10.89    V12.79    V12.79  
  A180.72   V9.31     V20.167   A180.72   V20.234 
  V16.33    V20.234   V22.219   V20.230   V9.31   
  V16.190   A180.78   V9.31     V20.234   A180.72 

Dissimilarities for k-closest analogues

   k      0     10     20     30     40     50     60     70     80     90
   1  0.900  0.902  0.903  0.904  0.904  0.907  0.907  0.908  0.908  0.908
   2  0.903  0.904  0.904  0.904  0.905  0.908  0.908  0.909  0.908  0.910
   3  0.903  0.904  0.906  0.904  0.906  0.908  0.909  0.910  0.909  0.913
   4  0.903  0.906  0.906  0.905  0.906  0.909  0.910  0.910  0.909  0.913
   5  0.905  0.906  0.906  0.905  0.908  0.909  0.910  0.910  0.909  0.914
   6  0.905  0.907  0.906  0.905  0.908  0.909  0.910  0.911  0.910  0.914
   7  0.907  0.907  0.907  0.906  0.908  0.911  0.910  0.911  0.910  0.914
   8  0.907  0.908  0.907  0.906  0.908  0.911  0.911  0.911  0.910  0.914
   9  0.907  0.909  0.907  0.906  0.908  0.911  0.911  0.911  0.911  0.915
  10  0.908  0.910  0.907  0.906  0.908  0.912  0.911  0.911  0.911  0.915
    100    110    120    130    140    150    160    170    180    190    200
  0.910  0.908  0.910  0.909  0.911  0.908  0.908  0.906  0.908  0.909  0.906
  0.911  0.910  0.910  0.909  0.911  0.909  0.910  0.907  0.910  0.910  0.908
  0.911  0.912  0.911  0.910  0.912  0.909  0.910  0.907  0.910  0.910  0.908
  0.912  0.913  0.911  0.911  0.912  0.910  0.910  0.907  0.911  0.910  0.908
  0.913  0.914  0.912  0.911  0.914  0.910  0.910  0.907  0.911  0.912  0.908
  0.913  0.914  0.914  0.913  0.914  0.910  0.910  0.908  0.911  0.912  0.909
  0.913  0.914  0.914  0.913  0.915  0.911  0.910  0.908  0.911  0.912  0.909
  0.913  0.915  0.914  0.914  0.915  0.911  0.910  0.908  0.912  0.913  0.910
  0.914  0.915  0.915  0.914  0.915  0.911  0.911  0.909  0.913  0.914  0.910
  0.914  0.915  0.915  0.914  0.915  0.912  0.911  0.910  0.914  0.914  0.910
    210    220    230    240    250    260    270    280    290    300    310
  0.907  0.906  0.906  0.906  0.906  0.906  0.909  0.910  0.907  0.907  0.912
  0.908  0.909  0.908  0.910  0.908  0.908  0.910  0.911  0.908  0.908  0.913
  0.908  0.909  0.908  0.911  0.909  0.908  0.911  0.911  0.909  0.908  0.913
  0.908  0.909  0.908  0.911  0.910  0.908  0.912  0.911  0.909  0.909  0.914
  0.909  0.909  0.909  0.911  0.910  0.908  0.912  0.912  0.910  0.909  0.915
  0.910  0.909  0.909  0.912  0.911  0.909  0.912  0.912  0.910  0.909  0.916
  0.910  0.909  0.910  0.912  0.911  0.909  0.913  0.912  0.910  0.909  0.916
  0.910  0.910  0.910  0.913  0.911  0.910  0.913  0.912  0.911  0.910  0.916
  0.910  0.910  0.910  0.913  0.911  0.910  0.913  0.913  0.912  0.910  0.916
  0.910  0.910  0.911  0.913  0.911  0.910  0.914  0.914  0.912  0.910  0.917
    320    330    340    350    360    370    380    390    400    410    420
  0.910  0.911  0.907  0.908  0.908  0.910  0.908  0.910  0.907  0.911  0.906
  0.911  0.911  0.908  0.909  0.909  0.910  0.909  0.910  0.907  0.911  0.907
  0.911  0.911  0.908  0.909  0.909  0.911  0.909  0.912  0.909  0.912  0.907
  0.912  0.911  0.909  0.910  0.909  0.912  0.909  0.912  0.910  0.912  0.907
  0.912  0.912  0.909  0.910  0.909  0.912  0.910  0.912  0.910  0.912  0.908
  0.912  0.912  0.910  0.910  0.909  0.912  0.911  0.912  0.910  0.912  0.908
  0.913  0.913  0.911  0.911  0.909  0.913  0.911  0.913  0.910  0.913  0.909
  0.913  0.913  0.911  0.911  0.909  0.913  0.911  0.913  0.911  0.913  0.909
  0.913  0.913  0.911  0.912  0.910  0.914  0.911  0.913  0.911  0.913  0.909
  0.913  0.913  0.911  0.912  0.910  0.914  0.911  0.913  0.911  0.914  0.909
    430    440    450    460    470    480    490    500    510    520    530
  0.909  0.905  0.906  0.907  0.906  0.909  0.907  0.906  0.911  0.907  0.910
  0.911  0.908  0.907  0.907  0.906  0.909  0.907  0.907  0.912  0.910  0.911
  0.911  0.909  0.907  0.909  0.907  0.909  0.908  0.908  0.912  0.910  0.911
  0.911  0.909  0.908  0.910  0.907  0.910  0.908  0.908  0.913  0.911  0.911
  0.911  0.910  0.908  0.911  0.907  0.910  0.908  0.908  0.914  0.911  0.911
  0.912  0.911  0.908  0.912  0.907  0.911  0.908  0.909  0.914  0.912  0.911
  0.913  0.911  0.908  0.912  0.907  0.911  0.908  0.909  0.914  0.912  0.912
  0.913  0.911  0.909  0.912  0.907  0.911  0.909  0.910  0.915  0.912  0.912
  0.913  0.911  0.909  0.912  0.908  0.912  0.909  0.911  0.915  0.913  0.913
  0.914  0.911  0.909  0.912  0.908  0.912  0.909  0.911  0.915  0.913  0.913
    540    550    560    570    580    590    600    610    620    630    640
  0.910  0.910  0.907  0.907  0.906  0.904  0.906  0.910  0.913  0.906  0.907
  0.911  0.910  0.908  0.907  0.907  0.907  0.908  0.911  0.913  0.910  0.908
  0.911  0.911  0.910  0.909  0.907  0.907  0.908  0.911  0.914  0.910  0.909
  0.911  0.911  0.910  0.909  0.907  0.907  0.909  0.911  0.914  0.910  0.909
  0.912  0.911  0.910  0.909  0.908  0.907  0.910  0.911  0.915  0.910  0.909
  0.912  0.912  0.911  0.909  0.908  0.907  0.910  0.912  0.915  0.910  0.909
  0.913  0.913  0.911  0.910  0.910  0.907  0.910  0.913  0.915  0.911  0.910
  0.913  0.914  0.912  0.910  0.910  0.908  0.911  0.913  0.916  0.911  0.910
  0.913  0.914  0.912  0.910  0.911  0.908  0.911  0.913  0.916  0.912  0.910
  0.914  0.914  0.913  0.911  0.911  0.908  0.911  0.914  0.916  0.912  0.910
    650    660    670    680    690    700    710    720    730    740    750
  0.906  0.910  0.911  0.913  0.907  0.909  0.909  0.912  0.914  0.908  0.907
  0.907  0.910  0.911  0.913  0.909  0.909  0.911  0.913  0.914  0.909  0.909
  0.909  0.910  0.912  0.914  0.909  0.910  0.911  0.914  0.915  0.910  0.909
  0.909  0.910  0.912  0.916  0.909  0.911  0.912  0.914  0.915  0.910  0.910
  0.910  0.911  0.913  0.916  0.910  0.912  0.912  0.914  0.915  0.910  0.910
  0.910  0.911  0.913  0.916  0.914  0.913  0.913  0.915  0.915  0.910  0.910
  0.910  0.911  0.913  0.917  0.914  0.913  0.913  0.915  0.916  0.911  0.910
  0.911  0.912  0.913  0.918  0.914  0.913  0.913  0.916  0.916  0.911  0.911
  0.911  0.912  0.914  0.918  0.914  0.913  0.913  0.916  0.917  0.911  0.911
  0.911  0.913  0.914  0.919  0.915  0.913  0.914  0.916  0.917  0.911  0.911
    760    770    780    790    800    810    820    830    840    850    860
  0.909  0.911  0.914  0.907  0.907  0.908  0.908  0.906  0.907  0.910  0.910
  0.910  0.911  0.914  0.908  0.908  0.908  0.910  0.910  0.909  0.911  0.911
  0.910  0.913  0.917  0.910  0.909  0.909  0.910  0.910  0.911  0.911  0.912
  0.910  0.913  0.917  0.910  0.910  0.909  0.911  0.910  0.911  0.911  0.912
  0.910  0.913  0.917  0.911  0.910  0.909  0.912  0.911  0.912  0.912  0.912
  0.910  0.913  0.918  0.911  0.911  0.909  0.912  0.912  0.912  0.912  0.912
  0.911  0.914  0.918  0.911  0.911  0.909  0.913  0.912  0.913  0.913  0.913
  0.911  0.914  0.919  0.911  0.911  0.910  0.913  0.913  0.913  0.913  0.914
  0.912  0.914  0.919  0.911  0.912  0.910  0.914  0.913  0.914  0.913  0.914
  0.912  0.914  0.919  0.912  0.912  0.910  0.914  0.913  0.914  0.913  0.915
    870    880    890    900    910    920    930    940    950    960    970
  0.910  0.909  0.913  0.912  0.908  0.909  0.909  0.907  0.910  0.909  0.908
  0.910  0.912  0.914  0.915  0.912  0.913  0.910  0.908  0.910  0.910  0.908
  0.910  0.912  0.914  0.916  0.912  0.915  0.912  0.909  0.911  0.910  0.909
  0.911  0.913  0.915  0.916  0.913  0.916  0.913  0.909  0.911  0.911  0.909
  0.912  0.913  0.915  0.917  0.913  0.917  0.914  0.909  0.911  0.911  0.909
  0.913  0.913  0.915  0.918  0.913  0.917  0.915  0.910  0.911  0.911  0.909
  0.913  0.914  0.917  0.918  0.914  0.917  0.915  0.911  0.911  0.911  0.909
  0.913  0.914  0.918  0.918  0.914  0.917  0.915  0.911  0.912  0.911  0.910
  0.915  0.914  0.918  0.919  0.915  0.918  0.915  0.912  0.912  0.912  0.910
  0.915  0.915  0.918  0.920  0.915  0.918  0.916  0.912  0.913  0.912  0.910
    980    990   1000   1010   1020   1030   1040   1050   1060   1070   1080
  0.907  0.911  0.908  0.913  0.910  0.910  0.912  0.906  0.910  0.910  0.908
  0.909  0.912  0.908  0.913  0.914  0.911  0.914  0.909  0.911  0.910  0.908
  0.909  0.912  0.909  0.914  0.914  0.911  0.916  0.909  0.914  0.911  0.909
  0.911  0.912  0.909  0.915  0.915  0.912  0.917  0.909  0.915  0.911  0.909
  0.911  0.913  0.909  0.915  0.915  0.912  0.917  0.911  0.915  0.912  0.910
  0.912  0.914  0.910  0.916  0.916  0.914  0.917  0.912  0.915  0.913  0.911
  0.912  0.914  0.912  0.916  0.916  0.915  0.917  0.912  0.916  0.913  0.911
  0.912  0.915  0.912  0.917  0.917  0.916  0.918  0.912  0.916  0.914  0.911
  0.912  0.915  0.912  0.918  0.918  0.916  0.918  0.913  0.917  0.914  0.911
  0.913  0.915  0.913  0.918  0.918  0.916  0.918  0.913  0.917  0.915  0.911
   1090
  0.907
  0.908
  0.908
  0.908
  0.910
  0.910
  0.911
  0.911
  0.911
  0.911

> 
> ## compare training set dissimilarities with normals
> ## and derive cut-offs
> ik.dij <- dissim(ik.analog)
> plot(ik.dij)
> 
> 
> 
> 
> cleanEx()
> nameEx("distance")
> ### * distance
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: distance
> ### Title: Flexibly calculate dissimilarity or distance measures
> ### Aliases: distance distance.default distance.join
> ### Keywords: multivariate methods
> 
> ### ** Examples
> 
> ## simple example using dummy data
> train <- data.frame(matrix(abs(runif(200)), ncol = 10))
> rownames(train) <- LETTERS[1:20]
> colnames(train) <- as.character(1:10)
> fossil <- data.frame(matrix(abs(runif(100)), ncol = 10))
> colnames(fossil) <- as.character(1:10)
> rownames(fossil) <- letters[1:10]
> 
> ## calculate distances/dissimilarities between train and fossil
> ## samples
> test <- distance(train, fossil)
> 
> ## using a different coefficient, chi-square distance
> test <- distance(train, fossil, method = "chi.distance")
> 
> ## calculate pairwise distances/dissimilarities for training
> ## set samples
> test2 <- distance(train)
> 
> ## Using distance on an object of class join
> dists <- distance(join(train, fossil))
> str(dists)
 distance [1:20, 1:10] 1.16 1.45 1.17 1.43 1.59 ...
 - attr(*, "dimnames")=List of 2
  ..$ : chr [1:20] "A" "B" "C" "D" ...
  ..$ : chr [1:10] "a" "b" "c" "d" ...
 - attr(*, "method")= chr "euclidean"
 - attr(*, "class")= chr [1:2] "distance" "matrix"
> 
> ## calculate Gower's general coefficient for mixed data
> ## first, make a couple of variables factors
> fossil[,4] <- factor(sample(rep(1:4, length = 10), 10))
> train[,4] <- factor(sample(rep(1:4, length = 20), 20))
> ## now fit the mixed coefficient
> test3 <- distance(train, fossil, "mixed")
> 
> ## Example from page 260 of Legendre & Legendre (1998)
> x1 <- t(c(2,2,NA,2,2,4,2,6))
> x2 <- t(c(1,3,3,1,2,2,2,5))
> Rj <- c(1,4,2,4,1,3,2,5) # supplied ranges
> 
> distance(x1, x2, method = "mixed", R = Rj)
[1] 0.3380952
attr(,"method")
[1] "mixed"
attr(,"class")
[1] "distance" "matrix"  
> 
> ## note this gives 1 - 0.66 (not 0.66 as the answer in
> ## Legendre & Legendre) as this is expressed as a
> ## distance whereas Legendre & Legendre describe the
> ## coefficient as similarity coefficient
> 
> 
> 
> cleanEx()
> nameEx("fuse")
> ### * fuse
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: fuse
> ### Title: Fused dissimilarities
> ### Aliases: fuse fuse.matrix fuse.dist
> ### Keywords: methods multivariate
> 
> ### ** Examples
> 
> train1 <- data.frame(matrix(abs(runif(100)), ncol = 10))
> train2 <- data.frame(matrix(sample(c(0,1), 100, replace = TRUE),
+                      ncol = 10))
> rownames(train1) <- rownames(train2) <- LETTERS[1:10]
> colnames(train1) <- colnames(train2) <- as.character(1:10)
> 
> d1 <- vegdist(train1, method = "bray")
> d2 <- vegdist(train2, method = "jaccard")
> 
> dd <- fuse(d1, d2, weights = c(0.6, 0.4))
> dd
          A         B         C         D         E         F         G
B 0.6574699                                                            
C 0.7678571 0.8463106                                                  
D 0.8335390 0.9301081 0.7700357                                        
E 0.6349894 0.7438099 0.7062610 0.6380231                              
F 0.7778098 0.8058696 0.6951139 0.6341402 0.7489699                    
G 0.7000000 0.7026529 0.6907921 0.7786377 0.5990220 0.7094210          
H 0.6632811 0.8960981 0.5972781 0.6418683 0.7107027 0.6199487 0.7337576
I 0.7185972 0.7498738 0.5217183 0.5311071 0.6236645 0.5930525 0.7349763
J 0.4682803 0.7718535 0.7022256 0.7009347 0.5463553 0.6132729 0.5951744
          H         I
B                    
C                    
D                    
E                    
F                    
G                    
H                    
I 0.7077601          
J 0.4566551 0.6414854
> str(dd)
Class 'dist'  atomic [1:45] 0.657 0.768 0.834 0.635 0.778 ...
  ..- attr(*, "Labels")= chr [1:10] "A" "B" "C" "D" ...
  ..- attr(*, "Size")= int 10
  ..- attr(*, "Diag")= logi FALSE
  ..- attr(*, "Upper")= logi FALSE
  ..- attr(*, "method")= chr "fuse"
  ..- attr(*, "weights")= num [1:2] 0.6 0.4
  ..- attr(*, "call")= language fuse.dist(d1, d2, weights = c(0.6, 0.4))
> 
> 
> 
> cleanEx()
> nameEx("getK")
> ### * getK
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: getK
> ### Title: Extract and set the number of analogues
> ### Aliases: getK getK.default getK.mat getK.bootstrap.mat getK.predict.mat
> ###   setK<- setK<-.default setK<-.mat
> ### Keywords: utilities manip
> 
> ### ** Examples
> 
> ## Imbrie and Kipp Sea Surface Temperature
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training set and core samples
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> ImbrieKippCore <- dat[[2]] / 100
> 
> ## fit a MAT model
> ik.mat <- mat(ImbrieKipp, SumSST, method = "chord")
> 
> ## How many analogues gives lowest RMSE?
> getK(ik.mat)
[1] 3
attr(,"auto")
[1] TRUE
attr(,"weighted")
[1] FALSE
> ## note that this value was chosen automatically
> 
> ## Now set k to be 10
> setK(ik.mat) <- 10
> 
> ## check
> getK(ik.mat)
[1] 10
attr(,"auto")
[1] FALSE
attr(,"weighted")
[1] FALSE
> 
> 
> 
> 
> cleanEx()
> nameEx("gradientDist")
> ### * gradientDist
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gradientDist
> ### Title: Positions of samples along a unit-length ordination gradient.
> ### Aliases: gradientDist gradientDist.default gradientDist.cca
> ###   gradientDist.prcurve
> ### Keywords: multivariate utility
> 
> ### ** Examples
> 
> 
> data(abernethy)
> 
> ## Remove the Depth and Age variables
> abernethy2 <- abernethy[, -(37:38)]
> 
> ## Fit PCA
> aber.pca <- rda(abernethy2)
> 
> ## Distance along the first PCA axis
> gradientDist(aber.pca)
 [1] 0.34172583 0.30240442 0.11451277 0.16889765 0.00000000 0.07556094
 [7] 0.15850388 0.15179676 0.34544036 0.33863684 0.37796456 0.35447305
[13] 0.37725714 0.43590145 0.52614525 0.83212029 0.91442163 0.94000421
[19] 0.94470578 0.95980762 0.96907601 0.96296241 0.99047280 0.98153216
[25] 0.96405261 1.00000000 0.97592084 0.95435245 0.97401520 0.91746396
[31] 0.94109965 0.88969437 0.80369973 0.75290552 0.71033293 0.72969928
[37] 0.71642084 0.75419351 0.74347844 0.77265593 0.75973303 0.81801884
[43] 0.86196277 0.82424335 0.81704433 0.74625922 0.73571176 0.69173333
[49] 0.71982710
attr(,"class")
[1] "gradientDist"
> 
> 
> 
> cleanEx()
> nameEx("hist.residLen")
> ### * hist.residLen
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: hist.residLen
> ### Title: Histogram plot for residual lengths
> ### Aliases: hist.residLen
> ### Keywords: hplot methods
> 
> ### ** Examples
> 
> ## load the Imbrie and Kipp example data
> data(ImbrieKipp, SumSST, V12.122)
> 
> ## squared residual lengths for Core V12.122
> rlens <- residLen(ImbrieKipp, SumSST, V12.122)
> rlens

	Squared residual lengths

Call: residLen(X = ImbrieKipp, env = SumSST, passive = V12.122)

Ordination Method: cca

Quantiles of residual lengths:

                50%  75%  90%  95%  99%
Training Set: 0.854 1.56 2.45 2.61 3.72
Passive:      1.004 1.50 1.87 2.17 2.55
> 
> ## plot a histogram of the residual distances
> hist(rlens)
> 
> 
> 
> 
> cleanEx()
> nameEx("histogram.residLen")
> ### * histogram.residLen
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: histogram.residLen
> ### Title: Lattice histogram plot for residual lengths
> ### Aliases: histogram.residLen
> ### Keywords: hplot methods
> 
> ### ** Examples
> 
> ## load the Imbrie and Kipp example data
> data(ImbrieKipp, SumSST, V12.122)
> 
> ## squared residual lengths for Core V12.122
> rlens <- residLen(ImbrieKipp, SumSST, V12.122)
> rlens

	Squared residual lengths

Call: residLen(X = ImbrieKipp, env = SumSST, passive = V12.122)

Ordination Method: cca

Quantiles of residual lengths:

                50%  75%  90%  95%  99%
Training Set: 0.854 1.56 2.45 2.61 3.72
Passive:      1.004 1.50 1.87 2.17 2.55
> 
> ## plot a histogram of the residual distances
> histogram(rlens)
> 
> 
> 
> 
> cleanEx()
> nameEx("join")
> ### * join
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: join
> ### Title: Merge species data sets on common columns (species)
> ### Aliases: join head.join tail.join
> ### Keywords: multivariate manip
> 
> ### ** Examples
> 
> ## load the example data
> data(swapdiat, swappH, rlgh)
> 
> ## merge training and test set on columns
> dat <- join(swapdiat, rlgh, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:  167  277
Data set 2:  101  139
Merged:      268  277

> 
> ## extract the merged data sets and convert to proportions
> swapdiat <- dat[[1]] / 100
> rlgh <- dat[[2]] / 100
> 
> ## merge training and test set using left join
> head(join(swapdiat, rlgh, verbose = TRUE, type = "left"))

Summary:

            Rows Cols
Data set 1:  167  277
Data set 2:  101  277
Merged:      268  277

$swapdiat
       AC001A AC002A AC004A AC013A AC014A AC014B AC014C AC017A AC018A AC019A
1.21        0      0      0 0.0019      0      0 0.0057 0.0096      0 0.0000
10.21       0      0      0 0.0406      0      0 0.0101 0.0000      0 0.0118
11          0      0      0 0.0000      0      0 0.0000 0.0000      0 0.0000
113.21      0      0      0 0.0000      0      0 0.0000 0.0000      0 0.0000
115.11      0      0      0 0.0000      0      0 0.0000 0.0000      0 0.0031
12.11       0      0      0 0.0000      0      0 0.0403 0.0000      0 0.0000
       AC022A AC025A AC028A AC029A AC030A AC034A AC035A AC039A AC042A AC044A
1.21   0.0631 0.0000      0 0.0000      0      0      0      0      0 0.0076
10.21  0.0000 0.0000      0 0.0017      0      0      0      0      0 0.0000
11     0.0000 0.0000      0 0.0000      0      0      0      0      0 0.0000
113.21 0.0000 0.0000      0 0.0000      0      0      0      0      0 0.0000
115.11 0.0000 0.0016      0 0.0000      0      0      0      0      0 0.0000
12.11  0.1194 0.0000      0 0.0000      0      0      0      0      0 0.0045
       AC046A AC048A AC9964 AC9965 AC9968 AC9969 AC9975 AC9996 AM001A AM001B
1.21        0      0      0      0      0      0      0      0 0.0000      0
10.21       0      0      0      0      0      0      0      0 0.0000      0
11          0      0      0      0      0      0      0      0 0.0000      0
113.21      0      0      0      0      0      0      0      0 0.0142      0
115.11      0      0      0      0      0      0      0      0 0.0000      0
12.11       0      0      0      0      0      0      0      0 0.0000      0
       AM001D AS001A AS003A AT001A AU001C AU002A AU003B AU003D AU004A AU004B
1.21        0      0 0.0019 0.0000      0      0      0      0 0.0000      0
10.21       0      0 0.0000 0.0000      0      0      0      0 0.0000      0
11          0      0 0.0000 0.0040      0      0      0      0 0.0000      0
113.21      0      0 0.0000 0.0000      0      0      0      0 0.0000      0
115.11      0      0 0.0000 0.0016      0      0      0      0 0.0313      0
12.11       0      0 0.0000 0.0000      0      0      0      0 0.0000      0
       AU004C AU004D AU005A AU005B AU005D AU005E AU005J AU005L AU009A AU009B
1.21        0      0 0.0000      0      0 0.0000      0      0      0      0
10.21       0      0 0.0000      0      0 0.0000      0      0      0      0
11          0      0 0.0000      0      0 0.0000      0      0      0      0
113.21      0      0 0.0000      0      0 0.0000      0      0      0      0
115.11      0      0 0.0016      0      0 0.0110      0      0      0      0
12.11       0      0 0.0298      0      0 0.0776      0      0      0      0
       AU010A AU010B AU014A AU022A AU023A AU9983 AU9984 AU9987 AU9988 BR001A
1.21        0      0      0      0      0      0      0      0      0 0.0115
10.21       0      0      0      0      0      0      0      0      0 0.2149
11          0      0      0      0      0      0      0      0      0 0.0020
113.21      0      0      0      0      0      0      0      0      0 0.2131
115.11      0      0      0      0      0      0      0      0      0 0.0579
12.11       0      0      0      0      0      0      0      0      0 0.0060
       BR003A BR004A BR005A BR006A BR9997 CA018A CC001A CM004A CM010A CM013A
1.21   0.0000 0.0019      0 0.0287  0.000      0      0 0.0000 0.0096      0
10.21  0.0000 0.0034      0 0.0846  0.000      0      0 0.0000 0.0085      0
11     0.0299 0.0140      0 0.0798  0.022      0      0 0.0000 0.0140      0
113.21 0.0000 0.0057      0 0.0000  0.000      0      0 0.0000 0.0426      0
115.11 0.0141 0.0078      0 0.0438  0.000      0      0 0.0047 0.0078      0
12.11  0.0015 0.0000      0 0.0254  0.000      0      0 0.0060 0.0000      0
       CM014A CM015A CM015B CM017A CM020A CM031A CM031C CM038A CM048A CM050A
1.21        0 0.0000      0 0.0019      0 0.0000 0.0000 0.0000 0.0000      0
10.21       0 0.0051      0 0.0051      0 0.0000 0.0101 0.0000 0.0000      0
11          0 0.0000      0 0.0120      0 0.0000 0.0000 0.0000 0.0000      0
113.21      0 0.0455      0 0.0028      0 0.0142 0.0000 0.0057 0.0057      0
115.11      0 0.0000      0 0.0016      0 0.0000 0.0000 0.0000 0.0329      0
12.11       0 0.0000      0 0.0119      0 0.0000 0.0239 0.0000 0.0060      0
       CM051A CM052A CM101B CM9989 CM9995 CO001A CO001B CY001A CY002A CY003A
1.21        0      0      0      0      0      0      0      0      0      0
10.21       0      0      0      0      0      0      0      0      0      0
11          0      0      0      0      0      0      0      0      0      0
113.21      0      0      0      0      0      0      0      0      0      0
115.11      0      0      0      0      0      0      0      0      0      0
12.11       0      0      0      0      0      0      0      0      0      0
       CY004A CY007A CY010A CY013A CY9991 DE001A DT002A DT003A DT004B EU002A
1.21        0      0      0      0 0.0000      0      0      0      0 0.0000
10.21       0      0      0      0 0.0778      0      0      0      0 0.0051
11          0      0      0      0 0.0000      0      0      0      0 0.0000
113.21      0      0      0      0 0.0000      0      0      0      0 0.0000
115.11      0      0      0      0 0.0391      0      0      0      0 0.0000
12.11       0      0      0      0 0.0493      0      0      0      0 0.0000
       EU002B EU002D EU002E EU002K EU003A EU004A EU009A EU009C EU011A EU013A
1.21   0.0153      0      0 0.0076 0.0019 0.0229 0.0325      0  0.000  0.000
10.21  0.0051      0      0 0.0000 0.0017 0.0220 0.0169      0  0.000  0.000
11     0.0000      0      0 0.0000 0.0000 0.0000 0.0080      0  0.018  0.000
113.21 0.0085      0      0 0.0000 0.0000 0.0142 0.0142      0  0.000  0.000
115.11 0.0047      0      0 0.0000 0.0000 0.0282 0.0078      0  0.000  0.000
12.11  0.0000      0      0 0.0000 0.0000 0.0000 0.0463      0  0.000  0.003
       EU014A EU015A EU016A EU017A EU019A EU020A EU021A EU022A EU025A EU027A
1.21    0.000 0.0019      0 0.0019  0.000 0.0057      0      0      0 0.0019
10.21   0.000 0.0000      0 0.0000  0.000 0.0085      0      0      0 0.0000
11      0.002 0.0000      0 0.0000  0.004 0.0020      0      0      0 0.0000
113.21  0.000 0.0000      0 0.0085  0.000 0.0142      0      0      0 0.0000
115.11  0.000 0.0047      0 0.0000  0.000 0.0219      0      0      0 0.0000
12.11   0.000 0.0000      0 0.0000  0.000 0.0104      0      0      0 0.0000
       EU028A EU028B EU031A EU034A EU039A EU040A EU046C EU047A EU048A EU049A
1.21   0.0306      0  0.000      0 0.0019      0      0 0.0880 0.0401 0.0000
10.21  0.0000      0  0.000      0 0.0000      0      0 0.0288 0.0068 0.0000
11     0.0000      0  0.002      0 0.0000      0      0 0.0120 0.0140 0.0000
113.21 0.0000      0  0.000      0 0.0000      0      0 0.0085 0.0000 0.0057
115.11 0.0000      0  0.000      0 0.0047      0      0 0.0250 0.0125 0.0000
12.11  0.0000      0  0.000      0 0.0179      0      0 0.0284 0.0627 0.0000
       EU049B EU051A EU051B EU056A EU057A EU058A EU9961 EU9962 EU9965 EU9969
1.21        0 0.0019      0      0  0.000      0      0      0      0      0
10.21       0 0.0017      0      0  0.000      0      0      0      0      0
11          0 0.0020      0      0  0.002      0      0      0      0      0
113.21      0 0.0085      0      0  0.000      0      0      0      0      0
115.11      0 0.0000      0      0  0.000      0      0      0      0      0
12.11       0 0.0000      0      0  0.000      0      0      0      0      0
       FR001A FR001B FR002A FR002C FR005A FR005D FR006A FR007A FR008A FR009F
1.21        0      0      0      0      0 0.0057      0      0      0      0
10.21       0      0      0      0      0 0.0457      0      0      0      0
11          0      0      0      0      0 0.0000      0      0      0      0
113.21      0      0      0      0      0 0.0114      0      0      0      0
115.11      0      0      0      0      0 0.0031      0      0      0      0
12.11       0      0      0      0      0 0.0000      0      0      0      0
       FR010A FR011A FR015A FR018A FR9991 FU002A FU002B FU002F GO003A GO004A
1.21        0      0 0.0076      0 0.0038 0.0076 0.0535      0 0.0000 0.0000
10.21       0      0 0.0000      0 0.0000 0.0271 0.1049      0 0.0000 0.0051
11          0      0 0.0000      0 0.0000 0.0938 0.3253      0 0.0000 0.0000
113.21      0      0 0.0000      0 0.0000 0.0085 0.0625      0 0.0057 0.0000
115.11      0      0 0.0000      0 0.0000 0.0689 0.1878      0 0.0000 0.0000
12.11       0      0 0.0000      0 0.0000 0.0060 0.0597      0 0.0000 0.0000
       GO006C GO013A GO023A GO025B GO025F GY005A HN001A ME019A NA002A NA003A
1.21        0 0.0019      0      0      0      0      0      0      0  0.000
10.21       0 0.0000      0      0      0      0      0      0      0  0.044
11          0 0.0000      0      0      0      0      0      0      0  0.000
113.21      0 0.0000      0      0      0      0      0      0      0  0.000
115.11      0 0.0000      0      0      0      0      0      0      0  0.000
12.11       0 0.0000      0      0      0      0      0      0      0  0.000
       NA003B NA005A NA005B NA006A NA006B NA007A NA008A NA013A NA014A NA015A
1.21        0      0      0 0.0096      0      0      0      0 0.0000      0
10.21       0      0      0 0.0000      0      0      0      0 0.0000      0
11          0      0      0 0.0160      0      0      0      0 0.0000      0
113.21      0      0      0 0.0085      0      0      0      0 0.0000      0
115.11      0      0      0 0.0031      0      0      0      0 0.0016      0
12.11       0      0      0 0.0060      0      0      0      0 0.0000      0
       NA016A NA032A NA033A NA037A NA038A NA042A NA043A NA044A NA045A NA046A
1.21        0 0.0000 0.0019      0 0.0076 0.0000      0 0.0000      0      0
10.21       0 0.0000 0.0000      0 0.0000 0.0000      0 0.0034      0      0
11          0 0.0000 0.0220      0 0.0000 0.0000      0 0.0000      0      0
113.21      0 0.0171 0.0000      0 0.0000 0.0341      0 0.0000      0      0
115.11      0 0.0063 0.0000      0 0.0000 0.0000      0 0.0016      0      0
12.11       0 0.0000 0.0000      0 0.0000 0.0000      0 0.0701      0      0
       NA048A NA063A NA068A NA084A NA086A NA099A NA101A NA102A NA112D NA113A
1.21   0.0019      0      0      0      0  0.000      0      0      0      0
10.21  0.0000      0      0      0      0  0.000      0      0      0      0
11     0.0000      0      0      0      0  0.004      0      0      0      0
113.21 0.0000      0      0      0      0  0.000      0      0      0      0
115.11 0.0000      0      0      0      0  0.000      0      0      0      0
12.11  0.0000      0      0      0      0  0.000      0      0      0      0
       NA114A NA115A NA129A NA133A NA135A NA140A NA149A NA151A NA156A NA158A
1.21        0      0      0      0 0.0000 0.0153      0      0 0.0994      0
10.21       0      0      0      0 0.0051 0.0000      0      0 0.0000      0
11          0      0      0      0 0.0000 0.0120      0      0 0.0439      0
113.21      0      0      0      0 0.0000 0.0000      0      0 0.0142      0
115.11      0      0      0      0 0.0000 0.0000      0      0 0.0203      0
12.11       0      0      0      0 0.0000 0.0000      0      0 0.0015      0
       NA160A NA167A NA170A NA9904 NA9919 NA9955 NA9963 NA9964 NE003A NE003B
1.21   0.0000 0.0153      0      0      0      0      0      0 0.0000 0.0038
10.21  0.0017 0.0338      0      0      0      0      0      0 0.0051 0.0000
11     0.0000 0.0479      0      0      0      0      0      0 0.0080 0.0000
113.21 0.0000 0.0341      0      0      0      0      0      0 0.0028 0.0000
115.11 0.0000 0.0297      0      0      0      0      0      0 0.0016 0.0000
12.11  0.0000 0.0000      0      0      0      0      0      0 0.0000 0.0000
       NE003C NE004A NE012A NE020A NE023A NI002A NI005A NI008A NI009A NI009B
1.21        0 0.0000      0 0.0000      0 0.0000      0 0.0000 0.0000 0.0000
10.21       0 0.0000      0 0.0000      0 0.0000      0 0.0000 0.0068 0.0000
11          0 0.0000      0 0.0000      0 0.0000      0 0.0000 0.0000 0.0000
113.21      0 0.0028      0 0.0028      0 0.0114      0 0.0028 0.0227 0.0171
115.11      0 0.0000      0 0.0000      0 0.0000      0 0.0031 0.0000 0.0125
12.11       0 0.0000      0 0.0090      0 0.0000      0 0.0000 0.0030 0.0000
       NI017A NI021A NI026A NI027A NI152A NI9984 OP001A PE002A PI005A PI007A
1.21   0.0000 0.0000      0 0.0000 0.0000      0      0 0.0038 0.0000      0
10.21  0.0017 0.0000      0 0.0000 0.0101      0      0 0.0152 0.0000      0
11     0.0000 0.0000      0 0.0000 0.0000      0      0 0.0040 0.0000      0
113.21 0.0000 0.0171      0 0.0114 0.0000      0      0 0.0000 0.0000      0
115.11 0.0000 0.0047      0 0.0000 0.0000      0      0 0.0000 0.0047      0
12.11  0.0000 0.0000      0 0.0000 0.0000      0      0 0.0119 0.0000      0
       PI011A PI014A PI015A PI016A PI018A PI018B PI022B PI023A PI055A PI056A
1.21   0.0000 0.0000 0.0000      0 0.0019      0 0.0057      0      0  0.000
10.21  0.0000 0.0000 0.0000      0 0.0118      0 0.0000      0      0  0.000
11     0.0020 0.0000 0.0020      0 0.0080      0 0.0000      0      0  0.006
113.21 0.0000 0.0284 0.0000      0 0.0000      0 0.0000      0      0  0.000
115.11 0.0078 0.0000 0.0078      0 0.0000      0 0.0000      0      0  0.000
12.11  0.0000 0.0000 0.0045      0 0.0119      0 0.0239      0      0  0.000
       PI139A PI164A RH006B SA001A SA001B SA006A SA042A SE001A SP002A ST004A
1.21        0 0.0115      0 0.0000      0      0 0.0000 0.0344 0.0000      0
10.21       0 0.0000      0 0.0000      0      0 0.0000 0.0000 0.0000      0
11          0 0.0000      0 0.0000      0      0 0.0000 0.0299 0.0040      0
113.21      0 0.0114      0 0.0028      0      0 0.0000 0.0000 0.0000      0
115.11      0 0.0000      0 0.0016      0      0 0.0047 0.0094 0.0016      0
12.11       0 0.0000      0 0.0000      0      0 0.0015 0.0015 0.0000      0
       ST010A SU002A SU004A SU005A SU006A SY002A SY003A SY004A SY009A SY010A
1.21        0      0      0 0.0019 0.0038      0      0      0 0.0000 0.0000
10.21       0      0      0 0.0068 0.0051      0      0      0 0.0017 0.0000
11          0      0      0 0.0000 0.0040      0      0      0 0.0000 0.0000
113.21      0      0      0 0.0000 0.0000      0      0      0 0.0000 0.0028
115.11      0      0      0 0.0016 0.0047      0      0      0 0.0000 0.0000
12.11       0      0      0 0.0030 0.0075      0      0      0 0.0000 0.0000
       SY013A SY043A TA001A TA002A TA003A TA004A TA9996
1.21        0 0.0000 0.0096      0 0.1128 0.0249      0
10.21       0 0.0068 0.0372      0 0.0000 0.0034      0
11          0 0.0000 0.0140      0 0.0080 0.0419      0
113.21      0 0.0000 0.0739      0 0.0000 0.0000      0
115.11      0 0.0000 0.0266      0 0.0000 0.0000      0
12.11       0 0.0000 0.0239      0 0.0015 0.0000      0

$rlgh
      AC001A AC002A AC004A AC013A AC014A AC014B AC014C AC017A AC018A AC019A
000.3      0      0 0.0000 0.0086 0.0017      0      0      0      0      0
000.8      0      0 0.0038 0.0038 0.0000      0      0      0      0      0
001.3      0      0 0.0000 0.0055 0.0055      0      0      0      0      0
001.8      0      0 0.0000 0.0018 0.0036      0      0      0      0      0
002.3      0      0 0.0037 0.0000 0.0019      0      0      0      0      0
002.8      0      0 0.0000 0.0091 0.0000      0      0      0      0      0
      AC022A AC025A AC028A AC029A AC030A AC034A AC035A AC039A AC042A AC044A
000.3 0.0189 0.0000      0      0      0      0      0      0      0      0
000.8 0.0250 0.0000      0      0      0      0      0      0      0      0
001.3 0.0148 0.0018      0      0      0      0      0      0      0      0
001.8 0.0089 0.0000      0      0      0      0      0      0      0      0
002.3 0.0318 0.0000      0      0      0      0      0      0      0      0
002.8 0.0145 0.0018      0      0      0      0      0      0      0      0
      AC046A AC048A AC9964 AC9965 AC9968 AC9969 AC9975 AC9996 AM001A AM001B
000.3      0      0      0      0      0      0      0      0      0      0
000.8      0      0      0      0      0      0      0      0      0      0
001.3      0      0      0      0      0      0      0      0      0      0
001.8      0      0      0      0      0      0      0      0      0      0
002.3      0      0      0      0      0      0      0      0      0      0
002.8      0      0      0      0      0      0      0      0      0      0
      AM001D AS001A AS003A AT001A AU001C AU002A AU003B AU003D AU004A AU004B
000.3      0      0      0      0      0      0      0      0 0.0000      0
000.8      0      0      0      0      0      0      0      0 0.0000      0
001.3      0      0      0      0      0      0      0      0 0.0000      0
001.8      0      0      0      0      0      0      0      0 0.0053      0
002.3      0      0      0      0      0      0      0      0 0.0019      0
002.8      0      0      0      0      0      0      0      0 0.0018      0
      AU004C AU004D AU005A AU005B AU005D AU005E AU005J AU005L AU009A AU009B
000.3      0      0      0      0      0      0      0      0      0      0
000.8      0      0      0      0      0      0      0      0      0      0
001.3      0      0      0      0      0      0      0      0      0      0
001.8      0      0      0      0      0      0      0      0      0      0
002.3      0      0      0      0      0      0      0      0      0      0
002.8      0      0      0      0      0      0      0      0      0      0
      AU010A AU010B AU014A AU022A AU023A AU9983 AU9984 AU9987 AU9988 BR001A
000.3 0.0154      0      0      0      0      0      0      0 0.0069 0.0274
000.8 0.0134      0      0      0      0      0      0      0 0.0000 0.0307
001.3 0.0074      0      0      0      0      0      0      0 0.0037 0.0203
001.8 0.0160      0      0      0      0      0      0      0 0.0018 0.0391
002.3 0.0037      0      0      0      0      0      0      0 0.0169 0.0262
002.8 0.0109      0      0      0      0      0      0      0 0.0000 0.0181
      BR003A BR004A BR005A BR006A BR9997 CA018A CC001A CM004A CM010A CM013A
000.3 0.0000      0      0 0.0515 0.0069      0      0 0.0034 0.0086      0
000.8 0.0038      0      0 0.0768 0.0019      0      0 0.0000 0.0096      0
001.3 0.0037      0      0 0.0425 0.0037      0      0 0.0000 0.0018      0
001.8 0.0018      0      0 0.0196 0.0000      0      0 0.0000 0.0018      0
002.3 0.0037      0      0 0.0356 0.0000      0      0 0.0000 0.0056      0
002.8 0.0036      0      0 0.0381 0.0000      0      0 0.0000 0.0054      0
      CM014A CM015A CM015B CM017A CM020A CM031A CM031C CM038A CM048A CM050A
000.3 0.0034      0      0 0.0034 0.0120      0      0      0 0.0000      0
000.8 0.0038      0      0 0.0058 0.0000      0      0      0 0.0038      0
001.3 0.0074      0      0 0.0185 0.0000      0      0      0 0.0037      0
001.8 0.0089      0      0 0.0036 0.0000      0      0      0 0.0107      0
002.3 0.0112      0      0 0.0000 0.0112      0      0      0 0.0094      0
002.8 0.0073      0      0 0.0000 0.0000      0      0      0 0.0036      0
      CM051A CM052A CM101B CM9989 CM9995 CO001A CO001B CY001A CY002A CY003A
000.3      0      0      0      0      0      0      0      0      0      0
000.8      0      0      0      0      0      0      0      0      0      0
001.3      0      0      0      0      0      0      0      0      0      0
001.8      0      0      0      0      0      0      0      0      0      0
002.3      0      0      0      0      0      0      0      0      0      0
002.8      0      0      0      0      0      0      0      0      0      0
      CY004A CY007A CY010A CY013A CY9991 DE001A DT002A DT003A DT004B EU002A
000.3      0      0      0      0 0.0069      0      0      0      0 0.0017
000.8      0      0      0      0 0.0000      0      0      0      0 0.0038
001.3      0      0      0      0 0.0000      0      0      0      0 0.0018
001.8      0      0      0      0 0.0018      0      0      0      0 0.0018
002.3      0      0      0      0 0.0000      0      0      0      0 0.0019
002.8      0      0      0      0 0.0018      0      0      0      0 0.0036
      EU002B EU002D EU002E EU002K EU003A EU004A EU009A EU009C EU011A EU013A
000.3 0.0429      0 0.0051 0.0000 0.0000 0.0154 0.0172      0 0.0000      0
000.8 0.0384      0 0.0019 0.0019 0.0019 0.0038 0.0134      0 0.0000      0
001.3 0.0444      0 0.0000 0.0037 0.0000 0.0111 0.0203      0 0.0018      0
001.8 0.0302      0 0.0053 0.0000 0.0018 0.0089 0.0125      0 0.0036      0
002.3 0.0243      0 0.0037 0.0019 0.0000 0.0094 0.0131      0 0.0037      0
002.8 0.0254      0 0.0018 0.0018 0.0000 0.0200 0.0109      0 0.0000      0
      EU014A EU015A EU016A EU017A EU019A EU020A EU021A EU022A EU025A EU027A
000.3 0.0034 0.0000 0.0017 0.0000 0.0000 0.0051 0.0000      0      0      0
000.8 0.0077 0.0096 0.0038 0.0000 0.0000 0.0000 0.0000      0      0      0
001.3 0.0055 0.0055 0.0000 0.0000 0.0000 0.0018 0.0000      0      0      0
001.8 0.0071 0.0018 0.0036 0.0000 0.0018 0.0000 0.0000      0      0      0
002.3 0.0019 0.0037 0.0019 0.0000 0.0000 0.0037 0.0000      0      0      0
002.8 0.0000 0.0127 0.0000 0.0018 0.0000 0.0000 0.0036      0      0      0
      EU028A EU028B EU031A EU034A EU039A EU040A EU046C EU047A EU048A EU049A
000.3      0      0      0      0      0      0      0 0.1235 0.0309 0.0051
000.8      0      0      0      0      0      0      0 0.1228 0.0307 0.0019
001.3      0      0      0      0      0      0      0 0.1128 0.0203 0.0018
001.8      0      0      0      0      0      0      0 0.1281 0.0374 0.0018
002.3      0      0      0      0      0      0      0 0.1236 0.0318 0.0000
002.8      0      0      0      0      0      0      0 0.1180 0.0635 0.0000
      EU049B EU051A EU051B EU056A EU057A EU058A EU9961 EU9962 EU9965 EU9969
000.3 0.0000 0.0000      0      0      0      0      0      0      0      0
000.8 0.0000 0.0000      0      0      0      0      0      0      0      0
001.3 0.0000 0.0018      0      0      0      0      0      0      0      0
001.8 0.0000 0.0018      0      0      0      0      0      0      0      0
002.3 0.0000 0.0019      0      0      0      0      0      0      0      0
002.8 0.0018 0.0073      0      0      0      0      0      0      0      0
      FR001A FR001B FR002A FR002C FR005A FR005D FR006A FR007A FR008A FR009F
000.3      0      0      0      0      0 0.0292      0      0      0      0
000.8      0      0      0      0      0 0.0211      0      0      0      0
001.3      0      0      0      0      0 0.0203      0      0      0      0
001.8      0      0      0      0      0 0.0178      0      0      0      0
002.3      0      0      0      0      0 0.0187      0      0      0      0
002.8      0      0      0      0      0 0.0127      0      0      0      0
      FR010A FR011A FR015A FR018A FR9991 FU002A FU002B FU002F GO003A GO004A
000.3      0      0      0      0      0 0.0172 0.0738      0      0 0.0017
000.8      0      0      0      0      0 0.0326 0.0480      0      0 0.0000
001.3      0      0      0      0      0 0.0370 0.0702      0      0 0.0000
001.8      0      0      0      0      0 0.0445 0.0801      0      0 0.0000
002.3      0      0      0      0      0 0.0300 0.0674      0      0 0.0000
002.8      0      0      0      0      0 0.0363 0.0744      0      0 0.0000
      GO006C GO013A GO023A GO025B GO025F GY005A HN001A ME019A NA002A NA003A
000.3      0 0.0017      0      0      0      0      0      0      0      0
000.8      0 0.0000      0      0      0      0      0      0      0      0
001.3      0 0.0000      0      0      0      0      0      0      0      0
001.8      0 0.0000      0      0      0      0      0      0      0      0
002.3      0 0.0000      0      0      0      0      0      0      0      0
002.8      0 0.0000      0      0      0      0      0      0      0      0
      NA003B NA005A NA005B NA006A NA006B NA007A NA008A NA013A NA014A NA015A
000.3 0.0034 0.0017      0 0.0000      0      0      0      0      0 0.0017
000.8 0.0000 0.0000      0 0.0000      0      0      0      0      0 0.0000
001.3 0.0000 0.0000      0 0.0055      0      0      0      0      0 0.0000
001.8 0.0000 0.0018      0 0.0107      0      0      0      0      0 0.0000
002.3 0.0037 0.0019      0 0.0112      0      0      0      0      0 0.0000
002.8 0.0000 0.0000      0 0.0018      0      0      0      0      0 0.0000
      NA016A NA032A NA033A NA037A NA038A NA042A NA043A NA044A NA045A NA046A
000.3      0 0.0034      0 0.0240      0      0      0      0 0.0051      0
000.8      0 0.0058      0 0.0000      0      0      0      0 0.0000      0
001.3      0 0.0037      0 0.0037      0      0      0      0 0.0000      0
001.8      0 0.0018      0 0.0071      0      0      0      0 0.0000      0
002.3      0 0.0019      0 0.0000      0      0      0      0 0.0000      0
002.8      0 0.0018      0 0.0109      0      0      0      0 0.0000      0
      NA048A NA063A NA068A NA084A NA086A NA099A NA101A NA102A NA112D NA113A
000.3      0      0 0.0034      0      0 0.0000      0      0 0.0000      0
000.8      0      0 0.0000      0      0 0.0000      0      0 0.0000      0
001.3      0      0 0.0000      0      0 0.0000      0      0 0.0000      0
001.8      0      0 0.0000      0      0 0.0000      0      0 0.0000      0
002.3      0      0 0.0000      0      0 0.0000      0      0 0.0019      0
002.8      0      0 0.0036      0      0 0.0036      0      0 0.0000      0
      NA114A NA115A NA129A NA133A NA135A NA140A NA149A NA151A NA156A NA158A
000.3      0      0      0      0      0 0.0309      0      0 0.0635 0.0069
000.8      0      0      0      0      0 0.0403      0      0 0.0653 0.0115
001.3      0      0      0      0      0 0.0351      0      0 0.0869 0.0185
001.8      0      0      0      0      0 0.0409      0      0 0.0765 0.0142
002.3      0      0      0      0      0 0.0393      0      0 0.0674 0.0169
002.8      0      0      0      0      0 0.0218      0      0 0.0581 0.0163
      NA160A NA167A NA170A NA9904 NA9919 NA9955 NA9963 NA9964 NE003A NE003B
000.3      0 0.0326      0      0      0      0      0      0      0      0
000.8      0 0.0365      0      0      0      0      0      0      0      0
001.3      0 0.0555      0      0      0      0      0      0      0      0
001.8      0 0.0427      0      0      0      0      0      0      0      0
002.3      0 0.0300      0      0      0      0      0      0      0      0
002.8      0 0.0399      0      0      0      0      0      0      0      0
      NE003C NE004A NE012A NE020A NE023A NI002A NI005A NI008A NI009A NI009B
000.3      0 0.0000      0      0      0 0.0000 0.0051      0      0      0
000.8      0 0.0019      0      0      0 0.0000 0.0000      0      0      0
001.3      0 0.0000      0      0      0 0.0000 0.0018      0      0      0
001.8      0 0.0000      0      0      0 0.0036 0.0000      0      0      0
002.3      0 0.0019      0      0      0 0.0000 0.0000      0      0      0
002.8      0 0.0073      0      0      0 0.0000 0.0000      0      0      0
      NI017A NI021A NI026A NI027A NI152A NI9984 OP001A PE002A PI005A PI007A
000.3      0      0      0      0      0      0      0 0.0069 0.0017 0.0000
000.8      0      0      0      0      0      0      0 0.0288 0.0000 0.0000
001.3      0      0      0      0      0      0      0 0.0259 0.0000 0.0018
001.8      0      0      0      0      0      0      0 0.0409 0.0000 0.0000
002.3      0      0      0      0      0      0      0 0.0318 0.0000 0.0000
002.8      0      0      0      0      0      0      0 0.0436 0.0000 0.0018
      PI011A PI014A PI015A PI016A PI018A PI018B PI022B PI023A PI055A PI056A
000.3 0.0000 0.0000      0 0.0017 0.0017      0 0.0000      0      0      0
000.8 0.0019 0.0000      0 0.0000 0.0019      0 0.0019      0      0      0
001.3 0.0000 0.0000      0 0.0000 0.0000      0 0.0000      0      0      0
001.8 0.0053 0.0018      0 0.0018 0.0089      0 0.0000      0      0      0
002.3 0.0019 0.0000      0 0.0019 0.0037      0 0.0000      0      0      0
002.8 0.0036 0.0000      0 0.0018 0.0018      0 0.0000      0      0      0
      PI139A PI164A RH006B SA001A SA001B SA006A SA042A SE001A SP002A ST004A
000.3      0      0      0 0.0017 0.0017      0      0      0 0.0000      0
000.8      0      0      0 0.0000 0.0000      0      0      0 0.0000      0
001.3      0      0      0 0.0000 0.0037      0      0      0 0.0018      0
001.8      0      0      0 0.0000 0.0036      0      0      0 0.0000      0
002.3      0      0      0 0.0000 0.0000      0      0      0 0.0000      0
002.8      0      0      0 0.0000 0.0036      0      0      0 0.0000      0
      ST010A SU002A SU004A SU005A SU006A SY002A SY003A SY004A SY009A SY010A
000.3      0      0      0 0.0000 0.0137      0      0      0      0      0
000.8      0      0      0 0.0000 0.0134      0      0      0      0      0
001.3      0      0      0 0.0000 0.0055      0      0      0      0      0
001.8      0      0      0 0.0036 0.0053      0      0      0      0      0
002.3      0      0      0 0.0019 0.0075      0      0      0      0      0
002.8      0      0      0 0.0000 0.0091      0      0      0      0      0
      SY013A SY043A TA001A TA002A TA003A TA004A TA9996
000.3      0      0 0.0103      0 0.0172 0.0806      0
000.8      0      0 0.0115      0 0.0154 0.1440      0
001.3      0      0 0.0055      0 0.0203 0.1165      0
001.8      0      0 0.0053      0 0.0178 0.1352      0
002.3      0      0 0.0075      0 0.0112 0.1517      0
002.8      0      0 0.0181      0 0.0091 0.1234      0

> 
> ## load the example data
> data(ImbrieKipp, SumSST, V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## show just the first few lines of each data set
> head(dat, n = 4)
$ImbrieKipp
        O.univ G.cglob G.ruber G.tenel G.saccu G.rubes G.pacL G.pacR G.bullo
V14.61       0       0       0       0       0       0  98.97   0.90    0.00
V17.196      0       0       0       0       0       0  98.13   0.94    0.47
V18.110      0       0       0       0       0       0  96.29   1.71    1.00
V16.227      0       0       0       0       0       0  94.33   4.82    0.85
        G.falco G.calid G.aequi G.gluti G.duter G.infla G.trnL G.trnR G.crasf
V14.61        0       0       0    0.00       0    0.00      0      0       0
V17.196       0       0       0    0.47       0    0.00      0      0       0
V18.110       0       0       0    0.00       0    0.57      0      0       0
V16.227       0       0       0    0.00       0    0.00      0      0       0
        G.scitu G.mentu P.obliq C.nitid S.dehis G.digit Other G.quin G.hirsu
V14.61        0       0       0       0       0       0  0.13      0       0
V17.196       0       0       0       0       0       0  0.00      0       0
V18.110       0       0       0       0       0       0  0.43      0       0
V16.227       0       0       0       0       0       0  0.00      0       0
        G.hexag G.cglom cfH.pel
V14.61        0       0       0
V17.196       0       0       0
V18.110       0       0       0
V16.227       0       0       0

$V12.122
    O.univ G.cglob G.ruber G.tenel G.saccu G.rubes G.pacL  G.pacR G.bullo
0  0.01792 0.00489 0.43485 0.00814 0.25570 0.00651      0 0.00163 0.00000
10 0.03203 0.00712 0.37722 0.00356 0.30961 0.00712      0 0.00356 0.00000
20 0.02564 0.01709 0.47009 0.00855 0.20513 0.01709      0 0.01282 0.00427
30 0.01124 0.00562 0.47190 0.01124 0.12360 0.02247      0 0.03933 0.00562
   G.falco G.calid G.aequi G.gluti G.duter G.infla  G.trnL  G.trnR G.crasf
0  0.00163 0.00326 0.03257 0.08958 0.04560 0.00163 0.00163 0.00000 0.00000
10 0.00000 0.00000 0.02491 0.08185 0.05694 0.00000 0.00712 0.00356 0.00000
20 0.00000 0.00855 0.00855 0.09402 0.05556 0.00000 0.00427 0.00855 0.00000
30 0.00562 0.02247 0.05056 0.07865 0.06742 0.01124 0.00000 0.01685 0.00562
   G.scitu G.mentu P.obliq C.nitid S.dehis G.digit   Other G.quin G.hirsu
0  0.00163 0.07492 0.00977 0.00651 0.00163       0 0.00000      0       0
10 0.00000 0.05694 0.01423 0.00000 0.00356       0 0.01068      0       0
20 0.00855 0.02991 0.00855 0.00855 0.00000       0 0.00427      0       0
30 0.00562 0.01124 0.02247 0.00000 0.00000       0 0.01124      0       0
   G.hexag G.cglom cfH.pel
0        0       0       0
10       0       0       0
20       0       0       0
30       0       0       0

> 
> ## show just the last few lines of each data set
> tail(dat, n = 4)
$ImbrieKipp
        O.univ G.cglob G.ruber G.tenel G.saccu G.rubes G.pacL G.pacR G.bullo
V20.7     3.08    0.00   60.50    0.00   21.03    0.00      0   0.00    0.00
V20.234   1.09    0.00   46.28    1.09   29.04    0.54      0   0.36    0.18
V18.21    0.21    0.42   47.47    0.21   18.99    0.00      0   0.00    0.00
V12.122   1.79    0.49   43.49    0.81   25.57    0.65      0   0.16    0.00
        G.falco G.calid G.aequi G.gluti G.duter G.infla G.trnL G.trnR G.crasf
V20.7      0.00    0.00    3.08    0.00    7.70    0.00   0.00   0.00       0
V20.234    0.00    1.09    3.27    7.99    2.00    0.00   0.00   0.54       0
V18.21     0.00    1.05    4.43    6.54    2.53    0.00   0.00   0.00       0
V12.122    0.16    0.33    3.26    8.96    4.56    0.16   0.16   0.00       0
        G.scitu G.mentu P.obliq C.nitid S.dehis G.digit Other G.quin G.hirsu
V20.7      0.00    3.08    0.00    0.00    0.00       0  1.54      0       0
V20.234    1.27    3.63    0.91    0.00    0.18       0  0.54      0       0
V18.21     0.63   12.45    3.38    0.21    0.42       0  1.05      0       0
V12.122    0.16    7.49    0.98    0.65    0.16       0  0.00      0       0
        G.hexag G.cglom cfH.pel
V20.7         0       0       0
V20.234       0       0       0
V18.21        0       0       0
V12.122       0       0       0

$V12.122
      O.univ G.cglob G.ruber G.tenel G.saccu G.rubes G.pacL  G.pacR G.bullo
1060 0.01878 0.00469 0.24883 0.01878 0.14085 0.01408      0 0.09390 0.00939
1070 0.02286 0.02286 0.37143 0.01714 0.08000 0.01714      0 0.08000 0.04571
1080 0.03911 0.02793 0.32961 0.01117 0.14525 0.01117      0 0.02793 0.00559
1090 0.00658 0.00658 0.34869 0.04605 0.15789 0.01316      0 0.03947 0.01974
     G.falco G.calid G.aequi G.gluti G.duter G.infla  G.trnL  G.trnR G.crasf
1060       0 0.01878 0.02347 0.06103 0.15493 0.07512 0.00000 0.01408 0.00000
1070       0 0.02857 0.03429 0.08000 0.05714 0.05143 0.00571 0.05714 0.00571
1080       0 0.01676 0.05028 0.10056 0.11732 0.03911 0.00000 0.01117 0.01117
1090       0 0.03289 0.02632 0.09210 0.05921 0.03289 0.00658 0.03289 0.01974
     G.scitu G.mentu P.obliq C.nitid S.dehis G.digit   Other G.quin G.hirsu
1060 0.00469 0.09390 0.00000       0       0       0 0.00469      0       0
1070 0.00000 0.02286 0.00000       0       0       0 0.00000      0       0
1080 0.00000 0.04469 0.00559       0       0       0 0.00000      0       0
1090 0.00000 0.03289 0.00000       0       0       0 0.02632      0       0
     G.hexag G.cglom cfH.pel
1060 0.00000       0       0
1070 0.00000       0       0
1080 0.00559       0       0
1090 0.00000       0       0

> 
> ## merge training and test set using inner join
> head(join(ImbrieKipp, V12.122, verbose = TRUE, type = "inner"))

Summary:

            Rows Cols
Data set 1:   61   30
Data set 2:  110   30
Merged:      171   30

$ImbrieKipp
        O.univ G.cglob G.ruber G.tenel G.saccu G.rubes G.pacL G.pacR G.bullo
V14.61       0       0  0.0000       0  0.0000  0.0000 0.9897 0.0090  0.0000
V17.196      0       0  0.0000       0  0.0000  0.0000 0.9813 0.0094  0.0047
V18.110      0       0  0.0000       0  0.0000  0.0000 0.9629 0.0171  0.0100
V16.227      0       0  0.0000       0  0.0000  0.0000 0.9433 0.0482  0.0085
V14.47       0       0  0.0011       0  0.0011  0.0011 0.6850 0.0271  0.1095
V23.22       0       0  0.0000       0  0.0000  0.0000 0.5569 0.1662  0.1990
        G.falco G.calid G.aequi G.gluti G.duter G.infla G.trnL G.trnR G.crasf
V14.61        0       0       0  0.0000       0  0.0000 0.0000      0  0.0000
V17.196       0       0       0  0.0047       0  0.0000 0.0000      0  0.0000
V18.110       0       0       0  0.0000       0  0.0057 0.0000      0  0.0000
V16.227       0       0       0  0.0000       0  0.0000 0.0000      0  0.0000
V14.47        0       0       0  0.0195       0  0.1420 0.0011      0  0.0043
V23.22        0       0       0  0.0229       0  0.0157 0.0000      0  0.0000
        G.scitu G.mentu P.obliq C.nitid S.dehis G.digit  Other G.quin G.hirsu
V14.61   0.0000  0.0000  0.0000       0       0       0 0.0013 0.0000  0.0000
V17.196  0.0000  0.0000  0.0000       0       0       0 0.0000 0.0000  0.0000
V18.110  0.0000  0.0000  0.0000       0       0       0 0.0043 0.0000  0.0000
V16.227  0.0000  0.0000  0.0000       0       0       0 0.0000 0.0000  0.0000
V14.47   0.0011  0.0011  0.0011       0       0       0 0.0018 0.0032  0.0000
V23.22   0.0000  0.0000  0.0000       0       0       0 0.0065 0.0314  0.0013
        G.hexag G.cglom cfH.pel
V14.61        0       0       0
V17.196       0       0       0
V18.110       0       0       0
V16.227       0       0       0
V14.47        0       0       0
V23.22        0       0       0

$V12.122
      O.univ   G.cglob   G.ruber   G.tenel   G.saccu   G.rubes G.pacL    G.pacR
0  0.0001792 0.0000489 0.0043485 0.0000814 0.0025570 0.0000651      0 0.0000163
10 0.0003203 0.0000712 0.0037722 0.0000356 0.0030961 0.0000712      0 0.0000356
20 0.0002564 0.0001709 0.0047009 0.0000855 0.0020513 0.0001709      0 0.0001282
30 0.0001124 0.0000562 0.0047190 0.0001124 0.0012360 0.0002247      0 0.0003933
40 0.0000671 0.0001007 0.0043623 0.0003020 0.0015436 0.0001007      0 0.0000336
50 0.0001149 0.0000766 0.0052873 0.0000766 0.0012261 0.0000000      0 0.0000383
     G.bullo  G.falco   G.calid   G.aequi   G.gluti   G.duter   G.infla
0  0.0000000 1.63e-05 0.0000326 0.0003257 0.0008958 0.0004560 0.0000163
10 0.0000000 0.00e+00 0.0000000 0.0002491 0.0008185 0.0005694 0.0000000
20 0.0000427 0.00e+00 0.0000855 0.0000855 0.0009402 0.0005556 0.0000000
30 0.0000562 5.62e-05 0.0002247 0.0005056 0.0007865 0.0006742 0.0001124
40 0.0000671 3.36e-05 0.0001678 0.0008054 0.0009396 0.0003691 0.0004698
50 0.0002299 0.00e+00 0.0001916 0.0006897 0.0007663 0.0004981 0.0004215
     G.trnL    G.trnR   G.crasf  G.scitu   G.mentu   P.obliq  C.nitid  S.dehis
0  1.63e-05 0.0000000 0.0000000 1.63e-05 0.0007492 0.0000977 6.51e-05 1.63e-05
10 7.12e-05 0.0000356 0.0000000 0.00e+00 0.0005694 0.0001423 0.00e+00 3.56e-05
20 4.27e-05 0.0000855 0.0000000 8.55e-05 0.0002991 0.0000855 8.55e-05 0.00e+00
30 0.00e+00 0.0001685 0.0000562 5.62e-05 0.0001124 0.0002247 0.00e+00 0.00e+00
40 3.36e-05 0.0002349 0.0001342 3.36e-05 0.0001007 0.0000671 0.00e+00 0.00e+00
50 0.00e+00 0.0002682 0.0000766 0.00e+00 0.0000000 0.0000000 0.00e+00 0.00e+00
   G.digit     Other G.quin G.hirsu G.hexag G.cglom cfH.pel
0        0 0.0000000      0       0       0       0       0
10       0 0.0001068      0       0       0       0       0
20       0 0.0000427      0       0       0       0       0
30       0 0.0001124      0       0       0       0       0
40       0 0.0000336      0       0       0       0       0
50       0 0.0000383      0       0       0       0       0

> 
> ## merge training and test set using outer join and replace
> ## NA with -99.9
> head(join(ImbrieKipp, V12.122, verbose = TRUE, value = -99.9))

Summary:

            Rows Cols
Data set 1:   61   30
Data set 2:  110   30
Merged:      171   30

$ImbrieKipp
        O.univ G.cglob G.ruber G.tenel G.saccu G.rubes G.pacL G.pacR G.bullo
V14.61       0       0  0.0000       0  0.0000  0.0000 0.9897 0.0090  0.0000
V17.196      0       0  0.0000       0  0.0000  0.0000 0.9813 0.0094  0.0047
V18.110      0       0  0.0000       0  0.0000  0.0000 0.9629 0.0171  0.0100
V16.227      0       0  0.0000       0  0.0000  0.0000 0.9433 0.0482  0.0085
V14.47       0       0  0.0011       0  0.0011  0.0011 0.6850 0.0271  0.1095
V23.22       0       0  0.0000       0  0.0000  0.0000 0.5569 0.1662  0.1990
        G.falco G.calid G.aequi G.gluti G.duter G.infla G.trnL G.trnR G.crasf
V14.61        0       0       0  0.0000       0  0.0000 0.0000      0  0.0000
V17.196       0       0       0  0.0047       0  0.0000 0.0000      0  0.0000
V18.110       0       0       0  0.0000       0  0.0057 0.0000      0  0.0000
V16.227       0       0       0  0.0000       0  0.0000 0.0000      0  0.0000
V14.47        0       0       0  0.0195       0  0.1420 0.0011      0  0.0043
V23.22        0       0       0  0.0229       0  0.0157 0.0000      0  0.0000
        G.scitu G.mentu P.obliq C.nitid S.dehis G.digit  Other G.quin G.hirsu
V14.61   0.0000  0.0000  0.0000       0       0       0 0.0013 0.0000  0.0000
V17.196  0.0000  0.0000  0.0000       0       0       0 0.0000 0.0000  0.0000
V18.110  0.0000  0.0000  0.0000       0       0       0 0.0043 0.0000  0.0000
V16.227  0.0000  0.0000  0.0000       0       0       0 0.0000 0.0000  0.0000
V14.47   0.0011  0.0011  0.0011       0       0       0 0.0018 0.0032  0.0000
V23.22   0.0000  0.0000  0.0000       0       0       0 0.0065 0.0314  0.0013
        G.hexag G.cglom cfH.pel
V14.61        0       0       0
V17.196       0       0       0
V18.110       0       0       0
V16.227       0       0       0
V14.47        0       0       0
V23.22        0       0       0

$V12.122
      O.univ   G.cglob   G.ruber   G.tenel   G.saccu   G.rubes G.pacL    G.pacR
0  0.0001792 0.0000489 0.0043485 0.0000814 0.0025570 0.0000651      0 0.0000163
10 0.0003203 0.0000712 0.0037722 0.0000356 0.0030961 0.0000712      0 0.0000356
20 0.0002564 0.0001709 0.0047009 0.0000855 0.0020513 0.0001709      0 0.0001282
30 0.0001124 0.0000562 0.0047190 0.0001124 0.0012360 0.0002247      0 0.0003933
40 0.0000671 0.0001007 0.0043623 0.0003020 0.0015436 0.0001007      0 0.0000336
50 0.0001149 0.0000766 0.0052873 0.0000766 0.0012261 0.0000000      0 0.0000383
     G.bullo  G.falco   G.calid   G.aequi   G.gluti   G.duter   G.infla
0  0.0000000 1.63e-05 0.0000326 0.0003257 0.0008958 0.0004560 0.0000163
10 0.0000000 0.00e+00 0.0000000 0.0002491 0.0008185 0.0005694 0.0000000
20 0.0000427 0.00e+00 0.0000855 0.0000855 0.0009402 0.0005556 0.0000000
30 0.0000562 5.62e-05 0.0002247 0.0005056 0.0007865 0.0006742 0.0001124
40 0.0000671 3.36e-05 0.0001678 0.0008054 0.0009396 0.0003691 0.0004698
50 0.0002299 0.00e+00 0.0001916 0.0006897 0.0007663 0.0004981 0.0004215
     G.trnL    G.trnR   G.crasf  G.scitu   G.mentu   P.obliq  C.nitid  S.dehis
0  1.63e-05 0.0000000 0.0000000 1.63e-05 0.0007492 0.0000977 6.51e-05 1.63e-05
10 7.12e-05 0.0000356 0.0000000 0.00e+00 0.0005694 0.0001423 0.00e+00 3.56e-05
20 4.27e-05 0.0000855 0.0000000 8.55e-05 0.0002991 0.0000855 8.55e-05 0.00e+00
30 0.00e+00 0.0001685 0.0000562 5.62e-05 0.0001124 0.0002247 0.00e+00 0.00e+00
40 3.36e-05 0.0002349 0.0001342 3.36e-05 0.0001007 0.0000671 0.00e+00 0.00e+00
50 0.00e+00 0.0002682 0.0000766 0.00e+00 0.0000000 0.0000000 0.00e+00 0.00e+00
   G.digit     Other G.quin G.hirsu G.hexag G.cglom cfH.pel
0        0 0.0000000      0       0       0       0       0
10       0 0.0001068      0       0       0       0       0
20       0 0.0000427      0       0       0       0       0
30       0 0.0001124      0       0       0       0       0
40       0 0.0000336      0       0       0       0       0
50       0 0.0000383      0       0       0       0       0

> 
> 
> 
> cleanEx()
> nameEx("logitreg")
> ### * logitreg
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: logitreg
> ### Title: Logistic regression models for assessing analogues/non-analogues
> ### Aliases: logitreg logitreg.default logitreg.analog print.logitreg
> ###   summary.logitreg print.summary.logitreg
> ### Keywords: methods
> 
> ### ** Examples
> 
> ## load the example data
> data(swapdiat, swappH, rlgh)
> 
> ## merge training and test set on columns
> dat <- join(swapdiat, rlgh, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:  167  277
Data set 2:  101  139
Merged:      268  277

> 
> ## extract the merged data sets and convert to proportions
> swapdiat <- dat[[1]] / 100
> rlgh <- dat[[2]] / 100
> 
> ## fit an analogue matching (AM) model using the squared chord distance
> ## measure - need to keep the training set dissimilarities
> swap.ana <- analog(swapdiat, rlgh, method = "SQchord",
+                    keep.train = TRUE)
> 
> ## fit the ROC curve to the SWAP diatom data using the AM results
> ## Generate a grouping for the SWAP lakes
> clust <- hclust(as.dist(swap.ana$train), method = "ward")
> grps <- cutree(clust, 12)
> 
> ## fit the logit models to the analog object
> swap.lrm <- logitreg(swap.ana, grps)
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: algorithm did not converge
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
> swap.lrm

Object of class: "logitreg"
Number of models: 13

For groups:
 [1] "1"        "2"        "3"        "4"        "5"        "6"       
 [7] "7"        "8"        "9"        "10"       "11"       "12"      
[13] "Combined"

> 
> ## summary statistics
> summary(swap.lrm)

Logit regression models

          In  Out Est.(Dij)  Std.Err  Z-value    p-value Dij(p=0.9)
1         13  154     -18.8 4.80e+00  -3.9047 9.4353e-05      0.304
2         15  152     -36.2 1.02e+01  -3.5454 0.00039206      0.429
3         22  145     -34.1 1.02e+01  -3.3479 0.00081417      0.366
4         15  152     -24.1 7.15e+00  -3.3699 0.00075189      0.473
5         13  154     -21.0 7.97e+00  -2.6325 0.00847487      0.395
6         17  150     -21.5 4.77e+00  -4.4932 7.0156e-06      0.335
7         15  152     -11.0 2.71e+00  -4.0649 4.8045e-05      0.283
8          6  161     -40.1 2.59e+01  -1.5477 0.12170414      0.440
9         16  151     -10.8 2.49e+00  -4.3522 1.3475e-05      0.200
10        20  147     -47.0 1.60e+01  -2.9408 0.00327391      0.422
11         9  158   -1280.9 1.26e+05  -0.0102 0.99189657      0.601
12         6  161     -21.4 8.79e+00  -2.4401 0.01468365      0.599
Combined 167 1837     -16.6 1.25e+00 -13.2395 < 2.22e-16      0.335
         Std.Err(Dij)
1              0.0494
2              0.0300
3              0.0264
4              0.0400
5              0.0613
6              0.0371
7              0.0794
8              0.0431
9              0.0795
10             0.0203
11             1.3037
12             0.0702
Combined       0.0157

> 
> ## plot the fitted logit curves
> plot(swap.lrm, conf.type = "polygon")
> 
> 
> 
> cleanEx()
> nameEx("mat")
> ### * mat
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: mat
> ### Title: Modern Analogue Technique transfer function models
> ### Aliases: mat mat.default mat.formula fitted.mat residuals.mat resid.mat
> ###   print.residuals.mat print.mat print.fitted.mat
> ### Keywords: models multivariate methods
> 
> ### ** Examples
> 
> ## Imbrie and Kipp Sea Surface Temperature
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training set and core samples
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> ImbrieKippCore <- dat[[2]] / 100
> 
> ## fit the MAT model using the squared chord distance measure
> ik.mat <- mat(ImbrieKipp, SumSST, method = "chord")
> ik.mat

	Modern Analogue Technique

Call:
mat(x = ImbrieKipp, y = SumSST, method = "chord") 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

Inferences based on the mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.875 0.931    0.284    6.000
  3 1.713 0.941    0.133    5.167
  4 1.796 0.935    0.177    5.125
  5 1.748 0.939    0.209    5.100
  6 1.716 0.943    0.284    5.667
  7 1.763 0.943    0.381    6.429
  8 1.831 0.941    0.390    6.625
  9 1.913 0.940    0.449    7.222
 10 2.040 0.935    0.577    7.500

Inferences based on the weighted mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.894 0.929    0.263    6.183
  3 1.733 0.940    0.138    5.470
  4 1.773 0.937    0.173    5.384
  5 1.750 0.939    0.187    5.366
  6 1.709 0.942    0.218    5.493
  7 1.712 0.942    0.254    5.635
  8 1.758 0.940    0.253    5.693
  9 1.777 0.939    0.274    5.838
 10 1.857 0.935    0.362    5.927

> 
> ## model summary
> summary(ik.mat)

	Modern Analogue Technique

Call:
mat(x = ImbrieKipp, y = SumSST, method = "chord") 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

Inferences based on the mean of k-closest analogues:

  k RMSEP   R2 Avg Bias Max Bias
  1  2.50 0.88     0.32     9.00
  2  1.87 0.93     0.28     6.00
  3  1.71 0.94     0.13     5.17
  4  1.80 0.94     0.18     5.12
  5  1.75 0.94     0.21     5.10
  6  1.72 0.94     0.28     5.67
  7  1.76 0.94     0.38     6.43
  8  1.83 0.94     0.39     6.62
  9  1.91 0.94     0.45     7.22
 10  2.04 0.93     0.58     7.50

Inferences based on the weighted mean of k-closest analogues:

  k RMSEP   R2 Avg Bias Max Bias
  1  2.50 0.88     0.32     9.00
  2  1.89 0.93     0.26     6.18
  3  1.73 0.94     0.14     5.47
  4  1.77 0.94     0.17     5.38
  5  1.75 0.94     0.19     5.37
  6  1.71 0.94     0.22     5.49
  7  1.71 0.94     0.25     5.63
  8  1.76 0.94     0.25     5.69
  9  1.78 0.94     0.27     5.84
 10  1.86 0.94     0.36     5.93

Results for training set

  * (W.)Est and (W.)Resi are based on k=10-closest analogues
  * minDC is the minimum distance to another sample in the training set
  * min(W.)Resi is the minimum residual for a k-closest model,
    where k = 1,...,10. Column k(.W) displays which k has minResi

           Obs    Est   Resi  W.Est   W.Resi  minDC  minResi   k  minW.Resi
V14.61     2.0   9.50   7.50   7.93   5.9273  0.104   5.1000   5   5.37e+00
V17.196    5.0   9.20   4.20   6.86   1.8572  0.130   0.1667   3   4.61e-01
V18.110    5.5   9.15   3.65   7.13   1.6290  0.134   0.5000   1   4.84e-01
V16.227    7.0   9.00   2.00   7.16   0.1554  0.134   0.1667   3   2.62e-02
V14.47     7.0   9.00   2.00   8.66   1.6594  0.452   0.0000   4   3.63e-02
V23.22    10.5   8.65  -1.85   8.68  -1.8229  0.467   0.5000   3   7.43e-01
V2.12     11.0   8.60  -2.40   5.70  -5.2971  0.119   2.4000  10   5.30e+00
V23.29    10.0  13.65   3.65  13.33   3.3347  0.467   1.2500   2   1.41e+00
V12.43    13.0  13.25   0.25  13.31   0.3135  0.490   0.0000   5   1.71e-01
R9.7      12.0  14.85   2.85  14.29   2.2876  0.432   1.0000   2   4.65e-01
A157.3    14.0  16.30   2.30  16.04   2.0418  0.407   0.5000   2   3.14e-01
V23.81    14.5  15.45   0.95  15.40   0.8996  0.299   0.1667   3   8.08e-02
V23.82    15.0  16.20   1.20  15.84   0.8369  0.299   0.1429   7   1.40e-01
V12.53    14.5  17.80   3.30  17.76   3.2607  0.442   2.3571   7   2.55e+00
V23.83    16.0  15.30  -0.70  15.02  -0.9814  0.295   0.7000  10   9.81e-01
V12.56    18.0  20.90   2.90  20.78   2.7832  0.380   1.0000   2   1.03e+00
A152.84   20.0  21.60   1.60  21.64   1.6374  0.361   0.1429   7   5.77e-01
V16.50    18.0  20.50   2.50  20.28   2.2759  0.429   0.0000   1   0.00e+00
V22.122   19.0  17.95  -1.05  17.58  -1.4223  0.429   1.0500  10   1.42e+00
V16.41    18.5  23.90   5.40  23.64   5.1402  0.380   2.5000   1   2.50e+00
V4.32     21.5  23.60   2.10  23.62   2.1185  0.333   1.6250   8   1.73e+00
V12.66    21.0  21.10   0.10  21.12   0.1228  0.421   0.0000   1   0.00e+00
V19.245   21.0  23.20   2.20  22.72   1.7177  0.331   0.1667   3   4.41e-01
V4.8      24.0  23.35  -0.65  23.38  -0.6203  0.280   0.0000   1   0.00e+00
A180.15   24.0  22.95  -1.05  22.99  -1.0083  0.292   0.0000   1   0.00e+00
V18.34    23.0  24.35   1.35  24.49   1.4904  0.411   1.3500  10   1.49e+00
V20.213   24.0  24.57   0.57  24.56   0.5565  0.326   0.0833   6   1.38e-01
V19.222   23.0  23.00   0.00  23.06   0.0580  0.384   0.0000  10   3.83e-02
A180.39   23.0  24.25   1.25  24.24   1.2366  0.347   0.4167   6   5.12e-01
V16.189   24.0  25.89   1.89  25.85   1.8495  0.399   1.0000   1   1.00e+00
V12.18    25.0  25.39   0.39  25.48   0.4751  0.289   0.3000   9   4.19e-01
V7.67     26.0  23.45  -2.55  23.76  -2.2436  0.308   0.0000   1   0.00e+00
V17.165   26.0  24.77  -1.23  24.80  -1.2021  0.308   0.0000   1   0.00e+00
V19.310   26.0  23.75  -2.25  23.97  -2.0257  0.296   0.0000   1   0.00e+00
V16.190   25.0  25.32   0.32  25.34   0.3424  0.324   0.0000   2   3.98e-02
A153.154  26.0  25.67  -0.33  25.73  -0.2694  0.222   0.1000   2   1.11e-01
V19.308   26.0  25.99  -0.01  25.98  -0.0223  0.222   0.0100  10   2.23e-02
V22.172   24.5  26.72   2.22  26.71   2.2110  0.307   1.5000   1   1.50e+00
V10.98    27.0  24.82  -2.18  24.77  -2.2349  0.330   2.0000   1   2.00e+00
V22.219   26.2  25.65  -0.55  25.63  -0.5709  0.189   0.2000   1   2.00e-01
V16.33    25.0  26.37   1.37  26.37   1.3703  0.493   0.7333   3   7.48e-01
V22.204   26.5  26.80   0.30  26.74   0.2362  0.325   0.0000   6   3.12e-02
V20.167   26.2  26.90   0.70  26.87   0.6732  0.257   0.0333   3   1.17e-02
V10.89    26.0  26.04   0.04  26.12   0.1184  0.308   0.0400  10   1.18e-01
V12.79    26.0  26.90   0.90  26.88   0.8813  0.249   0.3750   4   5.16e-01
V19.216   27.0  25.27  -1.73  25.32  -1.6776  0.363   0.9000   7   9.65e-01
V14.90    27.0  26.95  -0.05  26.89  -0.1113  0.249   0.0000   4   2.56e-02
A180.72   27.5  26.75  -0.75  26.74  -0.7623  0.185   0.4286   7   5.18e-01
V16.21    27.0  26.87  -0.13  26.85  -0.1453  0.247   0.0000   1   0.00e+00
A180.76   27.0  27.15   0.15  27.16   0.1582  0.233   0.0000   6   3.86e-02
V15.164   27.0  26.82  -0.18  26.79  -0.2081  0.257   0.0000   1   0.00e+00
A180.78   27.0  27.20   0.20  27.19   0.1940  0.405   0.0000   5   1.03e-04
V14.5     27.0  27.02   0.02  27.07   0.0730  0.219   0.0000   1   3.55e-15
V3.128    29.0  26.72  -2.28  26.69  -2.3050  0.366   2.1500   2   2.17e+00
A179.13   28.5  26.09  -2.41  26.13  -2.3699  0.327   1.8333   3   1.85e+00
V9.31     27.5  26.87  -0.63  26.92  -0.5805  0.309   0.0000   1   0.00e+00
V20.230   27.5  26.87  -0.63  26.90  -0.6015  0.291   0.1667   3   1.77e-01
V20.7     27.5  27.27  -0.23  27.25  -0.2452  0.431   0.0000   2   1.06e-03
V20.234   27.0  27.02   0.02  27.08   0.0788  0.228   0.0000   1   0.00e+00
V18.21    27.0  26.77  -0.23  26.87  -0.1318  0.252   0.0000   1   3.55e-15
V12.122   28.0  26.92  -1.08  26.94  -1.0561  0.228   0.9000   5   9.17e-01
          k.W
V14.61      5
V17.196     3
V18.110     2
V16.227     9
V14.47      6
V23.22      3
V2.12      10
V23.29      2
V12.43      5
R9.7        2
A157.3      2
V23.81      4
V23.82      7
V12.53      7
V23.83     10
V12.56      2
A152.84     7
V16.50      1
V22.122    10
V16.41      1
V4.32       8
V12.66      1
V19.245     4
V4.8        1
A180.15     1
V18.34     10
V20.213     6
V19.222     9
A180.39     6
V16.189     1
V12.18      9
V7.67       1
V17.165     1
V19.310     1
V16.190     3
A153.154    2
V19.308    10
V22.172     1
V10.98      1
V22.219     2
V16.33      3
V22.204     7
V20.167     4
V10.89     10
V12.79      4
V19.216     7
V14.90      4
A180.72     7
V16.21      1
A180.76     7
V15.164     1
A180.78     5
V14.5       1
V3.128      2
A179.13     3
V9.31       1
V20.230     3
V20.7       2
V20.234     1
V18.21      1
V12.122     5

> 
> ## fitted values
> fitted(ik.mat)

	Modern Analogue Technique: Fitted values

No. of analogues (k) : 3 
User supplied k?     : FALSE 
Weighted analysis?   : FALSE 

  V14.61  V17.196  V18.110  V16.227   V14.47   V23.22    V2.12   V23.29 
   7.167    4.833    4.667    7.167    7.667   10.000    4.833   11.833 
  V12.43     R9.7   A157.3   V23.81   V23.82   V12.53   V23.83   V12.56 
  13.500   13.667   14.500   14.333   14.167   17.000   14.500   20.667 
 A152.84   V16.50  V22.122   V16.41    V4.32   V12.66  V19.245     V4.8 
  22.000   17.167   15.500   23.333   24.000   21.833   20.833   23.833 
 A180.15   V18.34  V20.213  V19.222  A180.39  V16.189   V12.18    V7.67 
  23.333   25.333   24.500   23.833   24.000   25.733   26.067   25.333 
 V17.165  V19.310  V16.190 A153.154  V19.308  V22.172   V10.98  V22.219 
  25.333   25.333   25.000   25.733   25.733   26.400   24.667   25.667 
  V16.33  V22.204  V20.167   V10.89   V12.79  V19.216   V14.90  A180.72 
  25.733   26.000   26.167   27.233   27.000   25.667   26.833   26.667 
  V16.21  A180.76  V15.164  A180.78    V14.5   V3.128  A179.13    V9.31 
  26.400   27.167   26.733   26.833   27.333   26.067   26.667   27.167 
 V20.230    V20.7  V20.234   V18.21  V12.122 
  27.333   27.333   27.333   27.333   27.000 
> 
> ## model residuals
> resid(ik.mat)

	Modern Analogue Technique Residuals

No. of analogues (k) : 3 
User supplied k?     : FALSE 
Weighted analysis?   : FALSE 

  V14.61  V17.196  V18.110  V16.227   V14.47   V23.22    V2.12   V23.29 
  5.1667  -0.1667  -0.8333   0.1667   0.6667  -0.5000  -6.1667   1.8333 
  V12.43     R9.7   A157.3   V23.81   V23.82   V12.53   V23.83   V12.56 
  0.5000   1.6667   0.5000  -0.1667  -0.8333   2.5000  -1.5000   2.6667 
 A152.84   V16.50  V22.122   V16.41    V4.32   V12.66  V19.245     V4.8 
  2.0000  -0.8333  -3.5000   4.8333   2.5000   0.8333  -0.1667  -0.1667 
 A180.15   V18.34  V20.213  V19.222  A180.39  V16.189   V12.18    V7.67 
 -0.6667   2.3333   0.5000   0.8333   1.0000   1.7333   1.0667  -0.6667 
 V17.165  V19.310  V16.190 A153.154  V19.308  V22.172   V10.98  V22.219 
 -0.6667  -0.6667   0.0000  -0.2667  -0.2667   1.9000  -2.3333  -0.5333 
  V16.33  V22.204  V20.167   V10.89   V12.79  V19.216   V14.90  A180.72 
  0.7333  -0.5000  -0.0333   1.2333   1.0000  -1.3333  -0.1667  -0.8333 
  V16.21  A180.76  V15.164  A180.78    V14.5   V3.128  A179.13    V9.31 
 -0.6000   0.1667  -0.2667  -0.1667   0.3333  -2.9333  -1.8333  -0.3333 
 V20.230    V20.7  V20.234   V18.21  V12.122 
 -0.1667  -0.1667   0.3333   0.3333  -1.0000 
> 
> ## draw summary plots of the model
> par(mfrow = c(2,2))
> plot(ik.mat)
> par(mfrow = c(1,1))
> 
> ## reconstruct for the RLGH core data
> coreV12.mat <- predict(ik.mat, V12.122, k = 3)
> coreV12.mat

	Modern Analogue Technique predictions

Dissimilarity: chord 
k-closest analogues: 3,	Chosen automatically? FALSE
Weighted mean: FALSE 
Bootstrap estimates: FALSE 

Model error estimates:
    RMSEP r.squared  avg.bias  max.bias 
   1.7130    0.9409    0.1328    5.1667 

Predicted values:
    0    10    20    30    40    50    60    70    80    90   100   110   120 
27.33 27.33 27.33 26.33 25.90 25.90 25.50 25.83 26.17 26.00 27.00 27.33 26.33 
  130   140   150   160   170   180   190   200   210   220   230   240   250 
27.17 26.50 25.57 26.57 26.57 27.23 27.33 26.50 26.83 27.50 27.33 27.73 26.00 
  260   270   280   290   300   310   320   330   340   350   360   370   380 
25.90 26.33 26.50 27.33 25.90 26.33 26.33 26.17 25.83 27.07 25.90 25.90 27.50 
  390   400   410   420   430   440   450   460   470   480   490   500   510 
26.83 27.00 27.73 27.17 27.50 27.17 27.00 27.40 25.90 26.83 27.67 27.33 27.00 
  520   530   540   550   560   570   580   590   600   610   620   630   640 
27.00 25.90 26.07 26.17 27.33 27.33 26.50 25.90 27.17 27.07 26.57 27.17 27.33 
  650   660   670   680   690   700   710   720   730   740   750   760   770 
27.17 26.83 27.00 26.83 27.17 26.90 27.40 26.17 27.83 27.00 26.83 26.83 27.40 
  780   790   800   810   820   830   840   850   860   870   880   890   900 
27.67 27.33 27.33 26.50 26.83 25.50 26.17 27.00 26.00 25.90 26.33 25.00 26.83 
  910   920   930   940   950   960   970   980   990  1000  1010  1020  1030 
26.17 26.50 27.33 27.33 26.73 27.50 27.33 27.33 27.33 26.17 27.33 26.17 26.17 
 1040  1050  1060  1070  1080  1090 
27.00 26.00 26.83 25.50 26.50 26.00 
> summary(coreV12.mat)

	Modern Analogue Technique predictions

Dissimilarity: chord 
k-closest analogues: 3,	Chosen automatically? FALSE
Weighted mean: FALSE 
Bootstrap estimates: FALSE 

Model error estimates:
    RMSEP r.squared  avg.bias  max.bias 
   1.7130    0.9409    0.1328    5.1667 

Predicted values:
    0    10    20    30    40    50    60    70    80    90   100   110   120 
27.33 27.33 27.33 26.33 25.90 25.90 25.50 25.83 26.17 26.00 27.00 27.33 26.33 
  130   140   150   160   170   180   190   200   210   220   230   240   250 
27.17 26.50 25.57 26.57 26.57 27.23 27.33 26.50 26.83 27.50 27.33 27.73 26.00 
  260   270   280   290   300   310   320   330   340   350   360   370   380 
25.90 26.33 26.50 27.33 25.90 26.33 26.33 26.17 25.83 27.07 25.90 25.90 27.50 
  390   400   410   420   430   440   450   460   470   480   490   500   510 
26.83 27.00 27.73 27.17 27.50 27.17 27.00 27.40 25.90 26.83 27.67 27.33 27.00 
  520   530   540   550   560   570   580   590   600   610   620   630   640 
27.00 25.90 26.07 26.17 27.33 27.33 26.50 25.90 27.17 27.07 26.57 27.17 27.33 
  650   660   670   680   690   700   710   720   730   740   750   760   770 
27.17 26.83 27.00 26.83 27.17 26.90 27.40 26.17 27.83 27.00 26.83 26.83 27.40 
  780   790   800   810   820   830   840   850   860   870   880   890   900 
27.67 27.33 27.33 26.50 26.83 25.50 26.17 27.00 26.00 25.90 26.33 25.00 26.83 
  910   920   930   940   950   960   970   980   990  1000  1010  1020  1030 
26.17 26.50 27.33 27.33 26.73 27.50 27.33 27.33 27.33 26.17 27.33 26.17 26.17 
 1040  1050  1060  1070  1080  1090 
27.00 26.00 26.83 25.50 26.50 26.00 

Training set assessment:

          Obs    Est    Resid
V14.61    2.0  7.167  5.16667
V17.196   5.0  4.833 -0.16667
V18.110   5.5  4.667 -0.83333
V16.227   7.0  7.167  0.16667
V14.47    7.0  7.667  0.66667
V23.22   10.5 10.000 -0.50000
V2.12    11.0  4.833 -6.16667
V23.29   10.0 11.833  1.83333
V12.43   13.0 13.500  0.50000
R9.7     12.0 13.667  1.66667
A157.3   14.0 14.500  0.50000
V23.81   14.5 14.333 -0.16667
V23.82   15.0 14.167 -0.83333
V12.53   14.5 17.000  2.50000
V23.83   16.0 14.500 -1.50000
V12.56   18.0 20.667  2.66667
A152.84  20.0 22.000  2.00000
V16.50   18.0 17.167 -0.83333
V22.122  19.0 15.500 -3.50000
V16.41   18.5 23.333  4.83333
V4.32    21.5 24.000  2.50000
V12.66   21.0 21.833  0.83333
V19.245  21.0 20.833 -0.16667
V4.8     24.0 23.833 -0.16667
A180.15  24.0 23.333 -0.66667
V18.34   23.0 25.333  2.33333
V20.213  24.0 24.500  0.50000
V19.222  23.0 23.833  0.83333
A180.39  23.0 24.000  1.00000
V16.189  24.0 25.733  1.73333
V12.18   25.0 26.067  1.06667
V7.67    26.0 25.333 -0.66667
V17.165  26.0 25.333 -0.66667
V19.310  26.0 25.333 -0.66667
V16.190  25.0 25.000  0.00000
A153.154 26.0 25.733 -0.26667
V19.308  26.0 25.733 -0.26667
V22.172  24.5 26.400  1.90000
V10.98   27.0 24.667 -2.33333
V22.219  26.2 25.667 -0.53333
V16.33   25.0 25.733  0.73333
V22.204  26.5 26.000 -0.50000
V20.167  26.2 26.167 -0.03333
V10.89   26.0 27.233  1.23333
V12.79   26.0 27.000  1.00000
V19.216  27.0 25.667 -1.33333
V14.90   27.0 26.833 -0.16667
A180.72  27.5 26.667 -0.83333
V16.21   27.0 26.400 -0.60000
A180.76  27.0 27.167  0.16667
V15.164  27.0 26.733 -0.26667
A180.78  27.0 26.833 -0.16667
V14.5    27.0 27.333  0.33333
V3.128   29.0 26.067 -2.93333
A179.13  28.5 26.667 -1.83333
V9.31    27.5 27.167 -0.33333
V20.230  27.5 27.333 -0.16667
V20.7    27.5 27.333 -0.16667
V20.234  27.0 27.333  0.33333
V18.21   27.0 27.333  0.33333
V12.122  28.0 27.000 -1.00000
> 
> ## draw the reconstruction
> reconPlot(coreV12.mat, use.labels = TRUE, display.error = "bars",
+           xlab = "Depth", ylab = "SumSST")
> 
> ## fit the MAT model using the squared chord distance measure
> ## and restrict the number of analogues we fit models for to 1:20
> ik.mat2 <- mat(ImbrieKipp, SumSST, method = "chord", kmax = 20)
> ik.mat2

	Modern Analogue Technique

Call:
mat(x = ImbrieKipp, y = SumSST, method = "chord", kmax = 20) 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

Inferences based on the mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.875 0.931    0.284    6.000
  3 1.713 0.941    0.133    5.167
  4 1.796 0.935    0.177    5.125
  5 1.748 0.939    0.209    5.100
  6 1.716 0.943    0.284    5.667
  7 1.763 0.943    0.381    6.429
  8 1.831 0.941    0.390    6.625
  9 1.913 0.940    0.449    7.222
 10 2.040 0.935    0.577    7.500

Inferences based on the weighted mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.894 0.929    0.263    6.183
  3 1.733 0.940    0.138    5.470
  4 1.773 0.937    0.173    5.384
  5 1.750 0.939    0.187    5.366
  6 1.709 0.942    0.218    5.493
  7 1.712 0.942    0.254    5.635
  8 1.758 0.940    0.253    5.693
  9 1.777 0.939    0.274    5.838
 10 1.857 0.935    0.362    5.927

> 
> ## model summary
> summary(ik.mat2)

	Modern Analogue Technique

Call:
mat(x = ImbrieKipp, y = SumSST, method = "chord", kmax = 20) 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

Inferences based on the mean of k-closest analogues:

  k RMSEP   R2 Avg Bias Max Bias
  1  2.50 0.88     0.32     9.00
  2  1.87 0.93     0.28     6.00
  3  1.71 0.94     0.13     5.17
  4  1.80 0.94     0.18     5.12
  5  1.75 0.94     0.21     5.10
  6  1.72 0.94     0.28     5.67
  7  1.76 0.94     0.38     6.43
  8  1.83 0.94     0.39     6.62
  9  1.91 0.94     0.45     7.22
 10  2.04 0.93     0.58     7.50

Inferences based on the weighted mean of k-closest analogues:

  k RMSEP   R2 Avg Bias Max Bias
  1  2.50 0.88     0.32     9.00
  2  1.89 0.93     0.26     6.18
  3  1.73 0.94     0.14     5.47
  4  1.77 0.94     0.17     5.38
  5  1.75 0.94     0.19     5.37
  6  1.71 0.94     0.22     5.49
  7  1.71 0.94     0.25     5.63
  8  1.76 0.94     0.25     5.69
  9  1.78 0.94     0.27     5.84
 10  1.86 0.94     0.36     5.93

Results for training set

  * (W.)Est and (W.)Resi are based on k=10-closest analogues
  * minDC is the minimum distance to another sample in the training set
  * min(W.)Resi is the minimum residual for a k-closest model,
    where k = 1,...,10. Column k(.W) displays which k has minResi

           Obs    Est   Resi  W.Est   W.Resi  minDC  minResi   k  minW.Resi
V14.61     2.0   9.50   7.50   7.93   5.9273  0.104   5.1000   5   5.37e+00
V17.196    5.0   9.20   4.20   6.86   1.8572  0.130   0.1667   3   4.61e-01
V18.110    5.5   9.15   3.65   7.13   1.6290  0.134   0.5000   1   4.84e-01
V16.227    7.0   9.00   2.00   7.16   0.1554  0.134   0.1667   3   2.62e-02
V14.47     7.0   9.00   2.00   8.66   1.6594  0.452   0.0000   4   3.63e-02
V23.22    10.5   8.65  -1.85   8.68  -1.8229  0.467   0.5000   3   7.43e-01
V2.12     11.0   8.60  -2.40   5.70  -5.2971  0.119   2.4000  10   5.30e+00
V23.29    10.0  13.65   3.65  13.33   3.3347  0.467   1.2500   2   1.41e+00
V12.43    13.0  13.25   0.25  13.31   0.3135  0.490   0.0000   5   1.71e-01
R9.7      12.0  14.85   2.85  14.29   2.2876  0.432   1.0000   2   4.65e-01
A157.3    14.0  16.30   2.30  16.04   2.0418  0.407   0.5000   2   3.14e-01
V23.81    14.5  15.45   0.95  15.40   0.8996  0.299   0.1667   3   8.08e-02
V23.82    15.0  16.20   1.20  15.84   0.8369  0.299   0.1429   7   1.40e-01
V12.53    14.5  17.80   3.30  17.76   3.2607  0.442   2.3571   7   2.55e+00
V23.83    16.0  15.30  -0.70  15.02  -0.9814  0.295   0.7000  10   9.81e-01
V12.56    18.0  20.90   2.90  20.78   2.7832  0.380   1.0000   2   1.03e+00
A152.84   20.0  21.60   1.60  21.64   1.6374  0.361   0.1429   7   5.77e-01
V16.50    18.0  20.50   2.50  20.28   2.2759  0.429   0.0000   1   0.00e+00
V22.122   19.0  17.95  -1.05  17.58  -1.4223  0.429   1.0500  10   1.42e+00
V16.41    18.5  23.90   5.40  23.64   5.1402  0.380   2.5000   1   2.50e+00
V4.32     21.5  23.60   2.10  23.62   2.1185  0.333   1.6250   8   1.73e+00
V12.66    21.0  21.10   0.10  21.12   0.1228  0.421   0.0000   1   0.00e+00
V19.245   21.0  23.20   2.20  22.72   1.7177  0.331   0.1667   3   4.41e-01
V4.8      24.0  23.35  -0.65  23.38  -0.6203  0.280   0.0000   1   0.00e+00
A180.15   24.0  22.95  -1.05  22.99  -1.0083  0.292   0.0000   1   0.00e+00
V18.34    23.0  24.35   1.35  24.49   1.4904  0.411   1.3500  10   1.49e+00
V20.213   24.0  24.57   0.57  24.56   0.5565  0.326   0.0833   6   1.38e-01
V19.222   23.0  23.00   0.00  23.06   0.0580  0.384   0.0000  10   3.83e-02
A180.39   23.0  24.25   1.25  24.24   1.2366  0.347   0.4167   6   5.12e-01
V16.189   24.0  25.89   1.89  25.85   1.8495  0.399   1.0000   1   1.00e+00
V12.18    25.0  25.39   0.39  25.48   0.4751  0.289   0.3000   9   4.19e-01
V7.67     26.0  23.45  -2.55  23.76  -2.2436  0.308   0.0000   1   0.00e+00
V17.165   26.0  24.77  -1.23  24.80  -1.2021  0.308   0.0000   1   0.00e+00
V19.310   26.0  23.75  -2.25  23.97  -2.0257  0.296   0.0000   1   0.00e+00
V16.190   25.0  25.32   0.32  25.34   0.3424  0.324   0.0000   2   3.98e-02
A153.154  26.0  25.67  -0.33  25.73  -0.2694  0.222   0.1000   2   1.11e-01
V19.308   26.0  25.99  -0.01  25.98  -0.0223  0.222   0.0100  10   2.23e-02
V22.172   24.5  26.72   2.22  26.71   2.2110  0.307   1.5000   1   1.50e+00
V10.98    27.0  24.82  -2.18  24.77  -2.2349  0.330   2.0000   1   2.00e+00
V22.219   26.2  25.65  -0.55  25.63  -0.5709  0.189   0.2000   1   2.00e-01
V16.33    25.0  26.37   1.37  26.37   1.3703  0.493   0.7333   3   7.48e-01
V22.204   26.5  26.80   0.30  26.74   0.2362  0.325   0.0000   6   3.12e-02
V20.167   26.2  26.90   0.70  26.87   0.6732  0.257   0.0333   3   1.17e-02
V10.89    26.0  26.04   0.04  26.12   0.1184  0.308   0.0400  10   1.18e-01
V12.79    26.0  26.90   0.90  26.88   0.8813  0.249   0.3750   4   5.16e-01
V19.216   27.0  25.27  -1.73  25.32  -1.6776  0.363   0.9000   7   9.65e-01
V14.90    27.0  26.95  -0.05  26.89  -0.1113  0.249   0.0000   4   2.56e-02
A180.72   27.5  26.75  -0.75  26.74  -0.7623  0.185   0.4286   7   5.18e-01
V16.21    27.0  26.87  -0.13  26.85  -0.1453  0.247   0.0000   1   0.00e+00
A180.76   27.0  27.15   0.15  27.16   0.1582  0.233   0.0000   6   3.86e-02
V15.164   27.0  26.82  -0.18  26.79  -0.2081  0.257   0.0000   1   0.00e+00
A180.78   27.0  27.20   0.20  27.19   0.1940  0.405   0.0000   5   1.03e-04
V14.5     27.0  27.02   0.02  27.07   0.0730  0.219   0.0000   1   3.55e-15
V3.128    29.0  26.72  -2.28  26.69  -2.3050  0.366   2.1500   2   2.17e+00
A179.13   28.5  26.09  -2.41  26.13  -2.3699  0.327   1.8333   3   1.85e+00
V9.31     27.5  26.87  -0.63  26.92  -0.5805  0.309   0.0000   1   0.00e+00
V20.230   27.5  26.87  -0.63  26.90  -0.6015  0.291   0.1667   3   1.77e-01
V20.7     27.5  27.27  -0.23  27.25  -0.2452  0.431   0.0000   2   1.06e-03
V20.234   27.0  27.02   0.02  27.08   0.0788  0.228   0.0000   1   0.00e+00
V18.21    27.0  26.77  -0.23  26.87  -0.1318  0.252   0.0000   1   3.55e-15
V12.122   28.0  26.92  -1.08  26.94  -1.0561  0.228   0.9000   5   9.17e-01
          k.W
V14.61      5
V17.196     3
V18.110     2
V16.227     9
V14.47      6
V23.22      3
V2.12      10
V23.29      2
V12.43      5
R9.7        2
A157.3      2
V23.81      4
V23.82      7
V12.53      7
V23.83     10
V12.56      2
A152.84     7
V16.50      1
V22.122    10
V16.41      1
V4.32       8
V12.66      1
V19.245     4
V4.8        1
A180.15     1
V18.34     10
V20.213     6
V19.222     9
A180.39     6
V16.189     1
V12.18      9
V7.67       1
V17.165     1
V19.310     1
V16.190     3
A153.154    2
V19.308    10
V22.172     1
V10.98      1
V22.219     2
V16.33      3
V22.204     7
V20.167     4
V10.89     10
V12.79      4
V19.216     7
V14.90      4
A180.72     7
V16.21      1
A180.76     7
V15.164     1
A180.78     5
V14.5       1
V3.128      2
A179.13     3
V9.31       1
V20.230     3
V20.7       2
V20.234     1
V18.21      1
V12.122     5

> 
> ## fitted values
> fitted(ik.mat2)

	Modern Analogue Technique: Fitted values

No. of analogues (k) : 3 
User supplied k?     : FALSE 
Weighted analysis?   : FALSE 

  V14.61  V17.196  V18.110  V16.227   V14.47   V23.22    V2.12   V23.29 
   7.167    4.833    4.667    7.167    7.667   10.000    4.833   11.833 
  V12.43     R9.7   A157.3   V23.81   V23.82   V12.53   V23.83   V12.56 
  13.500   13.667   14.500   14.333   14.167   17.000   14.500   20.667 
 A152.84   V16.50  V22.122   V16.41    V4.32   V12.66  V19.245     V4.8 
  22.000   17.167   15.500   23.333   24.000   21.833   20.833   23.833 
 A180.15   V18.34  V20.213  V19.222  A180.39  V16.189   V12.18    V7.67 
  23.333   25.333   24.500   23.833   24.000   25.733   26.067   25.333 
 V17.165  V19.310  V16.190 A153.154  V19.308  V22.172   V10.98  V22.219 
  25.333   25.333   25.000   25.733   25.733   26.400   24.667   25.667 
  V16.33  V22.204  V20.167   V10.89   V12.79  V19.216   V14.90  A180.72 
  25.733   26.000   26.167   27.233   27.000   25.667   26.833   26.667 
  V16.21  A180.76  V15.164  A180.78    V14.5   V3.128  A179.13    V9.31 
  26.400   27.167   26.733   26.833   27.333   26.067   26.667   27.167 
 V20.230    V20.7  V20.234   V18.21  V12.122 
  27.333   27.333   27.333   27.333   27.000 
> 
> ## model residuals
> resid(ik.mat2)

	Modern Analogue Technique Residuals

No. of analogues (k) : 3 
User supplied k?     : FALSE 
Weighted analysis?   : FALSE 

  V14.61  V17.196  V18.110  V16.227   V14.47   V23.22    V2.12   V23.29 
  5.1667  -0.1667  -0.8333   0.1667   0.6667  -0.5000  -6.1667   1.8333 
  V12.43     R9.7   A157.3   V23.81   V23.82   V12.53   V23.83   V12.56 
  0.5000   1.6667   0.5000  -0.1667  -0.8333   2.5000  -1.5000   2.6667 
 A152.84   V16.50  V22.122   V16.41    V4.32   V12.66  V19.245     V4.8 
  2.0000  -0.8333  -3.5000   4.8333   2.5000   0.8333  -0.1667  -0.1667 
 A180.15   V18.34  V20.213  V19.222  A180.39  V16.189   V12.18    V7.67 
 -0.6667   2.3333   0.5000   0.8333   1.0000   1.7333   1.0667  -0.6667 
 V17.165  V19.310  V16.190 A153.154  V19.308  V22.172   V10.98  V22.219 
 -0.6667  -0.6667   0.0000  -0.2667  -0.2667   1.9000  -2.3333  -0.5333 
  V16.33  V22.204  V20.167   V10.89   V12.79  V19.216   V14.90  A180.72 
  0.7333  -0.5000  -0.0333   1.2333   1.0000  -1.3333  -0.1667  -0.8333 
  V16.21  A180.76  V15.164  A180.78    V14.5   V3.128  A179.13    V9.31 
 -0.6000   0.1667  -0.2667  -0.1667   0.3333  -2.9333  -1.8333  -0.3333 
 V20.230    V20.7  V20.234   V18.21  V12.122 
 -0.1667  -0.1667   0.3333   0.3333  -1.0000 
> 
> ## draw summary plots of the model
> par(mfrow = c(2,2))
> plot(ik.mat2)
> par(mfrow = c(1,1))
> 
> ## reconstruct for the RLGH core data
> coreV12.mat2 <- predict(ik.mat, V12.122, k = 3)
> coreV12.mat2

	Modern Analogue Technique predictions

Dissimilarity: chord 
k-closest analogues: 3,	Chosen automatically? FALSE
Weighted mean: FALSE 
Bootstrap estimates: FALSE 

Model error estimates:
    RMSEP r.squared  avg.bias  max.bias 
   1.7130    0.9409    0.1328    5.1667 

Predicted values:
    0    10    20    30    40    50    60    70    80    90   100   110   120 
27.33 27.33 27.33 26.33 25.90 25.90 25.50 25.83 26.17 26.00 27.00 27.33 26.33 
  130   140   150   160   170   180   190   200   210   220   230   240   250 
27.17 26.50 25.57 26.57 26.57 27.23 27.33 26.50 26.83 27.50 27.33 27.73 26.00 
  260   270   280   290   300   310   320   330   340   350   360   370   380 
25.90 26.33 26.50 27.33 25.90 26.33 26.33 26.17 25.83 27.07 25.90 25.90 27.50 
  390   400   410   420   430   440   450   460   470   480   490   500   510 
26.83 27.00 27.73 27.17 27.50 27.17 27.00 27.40 25.90 26.83 27.67 27.33 27.00 
  520   530   540   550   560   570   580   590   600   610   620   630   640 
27.00 25.90 26.07 26.17 27.33 27.33 26.50 25.90 27.17 27.07 26.57 27.17 27.33 
  650   660   670   680   690   700   710   720   730   740   750   760   770 
27.17 26.83 27.00 26.83 27.17 26.90 27.40 26.17 27.83 27.00 26.83 26.83 27.40 
  780   790   800   810   820   830   840   850   860   870   880   890   900 
27.67 27.33 27.33 26.50 26.83 25.50 26.17 27.00 26.00 25.90 26.33 25.00 26.83 
  910   920   930   940   950   960   970   980   990  1000  1010  1020  1030 
26.17 26.50 27.33 27.33 26.73 27.50 27.33 27.33 27.33 26.17 27.33 26.17 26.17 
 1040  1050  1060  1070  1080  1090 
27.00 26.00 26.83 25.50 26.50 26.00 
> summary(coreV12.mat2)

	Modern Analogue Technique predictions

Dissimilarity: chord 
k-closest analogues: 3,	Chosen automatically? FALSE
Weighted mean: FALSE 
Bootstrap estimates: FALSE 

Model error estimates:
    RMSEP r.squared  avg.bias  max.bias 
   1.7130    0.9409    0.1328    5.1667 

Predicted values:
    0    10    20    30    40    50    60    70    80    90   100   110   120 
27.33 27.33 27.33 26.33 25.90 25.90 25.50 25.83 26.17 26.00 27.00 27.33 26.33 
  130   140   150   160   170   180   190   200   210   220   230   240   250 
27.17 26.50 25.57 26.57 26.57 27.23 27.33 26.50 26.83 27.50 27.33 27.73 26.00 
  260   270   280   290   300   310   320   330   340   350   360   370   380 
25.90 26.33 26.50 27.33 25.90 26.33 26.33 26.17 25.83 27.07 25.90 25.90 27.50 
  390   400   410   420   430   440   450   460   470   480   490   500   510 
26.83 27.00 27.73 27.17 27.50 27.17 27.00 27.40 25.90 26.83 27.67 27.33 27.00 
  520   530   540   550   560   570   580   590   600   610   620   630   640 
27.00 25.90 26.07 26.17 27.33 27.33 26.50 25.90 27.17 27.07 26.57 27.17 27.33 
  650   660   670   680   690   700   710   720   730   740   750   760   770 
27.17 26.83 27.00 26.83 27.17 26.90 27.40 26.17 27.83 27.00 26.83 26.83 27.40 
  780   790   800   810   820   830   840   850   860   870   880   890   900 
27.67 27.33 27.33 26.50 26.83 25.50 26.17 27.00 26.00 25.90 26.33 25.00 26.83 
  910   920   930   940   950   960   970   980   990  1000  1010  1020  1030 
26.17 26.50 27.33 27.33 26.73 27.50 27.33 27.33 27.33 26.17 27.33 26.17 26.17 
 1040  1050  1060  1070  1080  1090 
27.00 26.00 26.83 25.50 26.50 26.00 

Training set assessment:

          Obs    Est    Resid
V14.61    2.0  7.167  5.16667
V17.196   5.0  4.833 -0.16667
V18.110   5.5  4.667 -0.83333
V16.227   7.0  7.167  0.16667
V14.47    7.0  7.667  0.66667
V23.22   10.5 10.000 -0.50000
V2.12    11.0  4.833 -6.16667
V23.29   10.0 11.833  1.83333
V12.43   13.0 13.500  0.50000
R9.7     12.0 13.667  1.66667
A157.3   14.0 14.500  0.50000
V23.81   14.5 14.333 -0.16667
V23.82   15.0 14.167 -0.83333
V12.53   14.5 17.000  2.50000
V23.83   16.0 14.500 -1.50000
V12.56   18.0 20.667  2.66667
A152.84  20.0 22.000  2.00000
V16.50   18.0 17.167 -0.83333
V22.122  19.0 15.500 -3.50000
V16.41   18.5 23.333  4.83333
V4.32    21.5 24.000  2.50000
V12.66   21.0 21.833  0.83333
V19.245  21.0 20.833 -0.16667
V4.8     24.0 23.833 -0.16667
A180.15  24.0 23.333 -0.66667
V18.34   23.0 25.333  2.33333
V20.213  24.0 24.500  0.50000
V19.222  23.0 23.833  0.83333
A180.39  23.0 24.000  1.00000
V16.189  24.0 25.733  1.73333
V12.18   25.0 26.067  1.06667
V7.67    26.0 25.333 -0.66667
V17.165  26.0 25.333 -0.66667
V19.310  26.0 25.333 -0.66667
V16.190  25.0 25.000  0.00000
A153.154 26.0 25.733 -0.26667
V19.308  26.0 25.733 -0.26667
V22.172  24.5 26.400  1.90000
V10.98   27.0 24.667 -2.33333
V22.219  26.2 25.667 -0.53333
V16.33   25.0 25.733  0.73333
V22.204  26.5 26.000 -0.50000
V20.167  26.2 26.167 -0.03333
V10.89   26.0 27.233  1.23333
V12.79   26.0 27.000  1.00000
V19.216  27.0 25.667 -1.33333
V14.90   27.0 26.833 -0.16667
A180.72  27.5 26.667 -0.83333
V16.21   27.0 26.400 -0.60000
A180.76  27.0 27.167  0.16667
V15.164  27.0 26.733 -0.26667
A180.78  27.0 26.833 -0.16667
V14.5    27.0 27.333  0.33333
V3.128   29.0 26.067 -2.93333
A179.13  28.5 26.667 -1.83333
V9.31    27.5 27.167 -0.33333
V20.230  27.5 27.333 -0.16667
V20.7    27.5 27.333 -0.16667
V20.234  27.0 27.333  0.33333
V18.21   27.0 27.333  0.33333
V12.122  28.0 27.000 -1.00000
> 
> ## draw the reconstruction
> reconPlot(coreV12.mat2, use.labels = TRUE, display.error = "bars",
+           xlab = "Depth", ylab = "SumSST")
> 
> 
> 
> 
> graphics::par(get("par.postscript", pos = 'CheckExEnv'))
> cleanEx()
> nameEx("mcarlo")
> ### * mcarlo
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: mcarlo
> ### Title: Monte Carlo simulation of dissimilarities
> ### Aliases: mcarlo mcarlo.default mcarlo.mat mcarlo.analog print.mcarlo
> ### Keywords: multivariate
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## perform the modified method of Sawada (2004) - paired sampling,
> ## with replacement
> ik.mcarlo <- mcarlo(ImbrieKipp, method = "chord", nsamp = 1000,
+                     type = "paired", replace = FALSE)
> ik.mcarlo

	Simulated Dissimilarities

Simulation type : paired 
No. simulations : 1000 
Coefficient     : chord 

Summary of simulated distribution:
    Min 1st Qu.  Median    Mean 3rd Qu.     Max 
 0.0917  1.2921  1.3694  1.2293  1.4052  1.4119 

Percentiles of simulated distribution:
    1%   2.5%     5%    10%    90%    95%  97.5%    99% 
0.0917 0.1035 0.1343 0.6572 1.4111 1.4115 1.4116 1.4119 

> 
> ## plot the simulated distribution
> layout(matrix(1:2, ncol = 1))
> plot(ik.mcarlo)
> layout(1)
> 
> 
> 
> cleanEx()
> nameEx("minDC")
> ### * minDC
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: minDC
> ### Title: Extract minimum dissimilarities
> ### Aliases: minDC minDC.default minDC.predict.mat minDC.analog minDC.wa
> ###   print.minDC
> ### Keywords: utilities manip methods
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## fit the MAT model using the squared chord distance measure
> ik.mat <- mat(ImbrieKipp, SumSST, method = "SQchord")
> ik.mat

	Modern Analogue Technique

Call:
mat(x = ImbrieKipp, y = SumSST, method = "SQchord") 

Percentiles of the dissimilarities for the training set:

    1%     2%     5%    10%    20% 
0.0483 0.0786 0.1163 0.1710 0.2512 

Inferences based on the mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.875 0.931    0.284    6.000
  3 1.713 0.941    0.133    5.167
  4 1.796 0.935    0.177    5.125
  5 1.748 0.939    0.209    5.100
  6 1.716 0.943    0.284    5.667
  7 1.763 0.943    0.381    6.429
  8 1.831 0.941    0.390    6.625
  9 1.913 0.940    0.449    7.222
 10 2.040 0.935    0.577    7.500

Inferences based on the weighted mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.926 0.927    0.244    6.364
  3 1.770 0.937    0.139    5.771
  4 1.772 0.937    0.166    5.674
  5 1.758 0.938    0.172    5.667
  6 1.717 0.941    0.186    5.688
  7 1.717 0.941    0.200    5.705
  8 1.753 0.939    0.197    5.712
  9 1.765 0.938    0.205    5.729
 10 1.822 0.934    0.262    5.740

> 
> ## reconstruct for the V12-122 core data
> v12.mat <- predict(ik.mat, V12.122)
> 
> ## extract the minimum DC values
> v12.mdc <- minDC(v12.mat)
> v12.mdc

	Minimum dissimilarity per sample

Dissimilarity: SQchord 

    0    10    20    30    40    50    60    70    80    90   100   110   120 
0.810 0.814 0.816 0.817 0.817 0.822 0.823 0.825 0.824 0.825 0.828 0.825 0.829 
  130   140   150   160   170   180   190   200   210   220   230   240   250 
0.826 0.830 0.825 0.824 0.821 0.825 0.826 0.821 0.823 0.822 0.820 0.821 0.821 
  260   270   280   290   300   310   320   330   340   350   360   370   380 
0.821 0.826 0.828 0.823 0.823 0.831 0.828 0.829 0.823 0.825 0.824 0.828 0.825 
  390   400   410   420   430   440   450   460   470   480   490   500   510 
0.827 0.822 0.830 0.822 0.826 0.819 0.822 0.823 0.821 0.826 0.823 0.822 0.829 
  520   530   540   550   560   570   580   590   600   610   620   630   640 
0.823 0.828 0.829 0.828 0.824 0.823 0.822 0.818 0.821 0.829 0.834 0.821 0.823 
  650   660   670   680   690   700   710   720   730   740   750   760   770 
0.822 0.828 0.830 0.833 0.822 0.826 0.827 0.832 0.835 0.825 0.823 0.826 0.830 
  780   790   800   810   820   830   840   850   860   870   880   890   900 
0.835 0.823 0.823 0.824 0.825 0.821 0.823 0.828 0.829 0.828 0.826 0.833 0.832 
  910   920   930   940   950   960   970   980   990  1000  1010  1020  1030 
0.825 0.826 0.826 0.822 0.828 0.827 0.824 0.822 0.830 0.824 0.833 0.829 0.829 
 1040  1050  1060  1070  1080  1090 
0.832 0.821 0.828 0.828 0.824 0.823 
> 
> ## draw a plot of minimum DC by time
> plot(v12.mdc, use.labels = TRUE, xlab = "Depth (cm.)")
> 
> 
> 
> cleanEx()
> nameEx("optima")
> ### * optima
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: optima
> ### Title: Weighted averaging optima and tolerance ranges
> ### Aliases: optima optima.default print.optima print.tolerance
> ###   tolerance.default as.data.frame.optima as.data.frame.tolerance
> ### Keywords: methods
> 
> ### ** Examples
> 
> ## Load the Imbrie & Kipp data and
> ## summer sea-surface temperatures
> data(ImbrieKipp)
> data(SumSST)
> 
> ## WA optima
> (opt <- optima(ImbrieKipp, SumSST))

	Weighted Average Optima For: SumSST

   O.univ   G.cglob   G.ruber   G.tenel   G.saccu   G.rubes    G.pacL    G.pacR 
24.337228 25.726081 26.067809 25.574791 26.180014 26.274793  7.333465 16.980489 
  G.bullo   G.falco   G.calid   G.aequi   G.gluti   G.duter   G.infla    G.trnL 
17.514873 23.287148 24.527161 25.541789 22.265921 26.490136 19.873421 22.378081 
   G.trnR   G.crasf   G.scitu   G.mentu   P.obliq   C.nitid   S.dehis   G.digit 
24.552945 24.863128 22.617220 26.137781 26.943196 26.410054 24.077808 25.114701 
    Other    G.quin   G.hirsu 
22.716838 12.878463 22.279986 
> 
> ## WA tolerances
> (tol <- tolerance(ImbrieKipp, SumSST, useN2 = TRUE))

	Weighted Average Tolerances For: SumSST

  O.univ  G.cglob  G.ruber  G.tenel  G.saccu  G.rubes   G.pacL   G.pacR 
3.746359 1.895600 1.909561 2.124799 1.979651 1.968294 3.941352 5.181162 
 G.bullo  G.falco  G.calid  G.aequi  G.gluti  G.duter  G.infla   G.trnL 
5.827980 3.109193 2.973112 2.561697 5.898256 1.998304 4.723884 4.161704 
  G.trnR  G.crasf  G.scitu  G.mentu  P.obliq  C.nitid  S.dehis  G.digit 
3.434920 3.354021 3.990673 2.386584 1.554762 1.461725 3.844730 3.108881 
   Other   G.quin  G.hirsu 
5.112464 4.268777 3.942135 
> 
> ## convert to data frame
> as.data.frame(opt)
              Opt
O.univ  24.337228
G.cglob 25.726081
G.ruber 26.067809
G.tenel 25.574791
G.saccu 26.180014
G.rubes 26.274793
G.pacL   7.333465
G.pacR  16.980489
G.bullo 17.514873
G.falco 23.287148
G.calid 24.527161
G.aequi 25.541789
G.gluti 22.265921
G.duter 26.490136
G.infla 19.873421
G.trnL  22.378081
G.trnR  24.552945
G.crasf 24.863128
G.scitu 22.617220
G.mentu 26.137781
P.obliq 26.943196
C.nitid 26.410054
S.dehis 24.077808
G.digit 25.114701
Other   22.716838
G.quin  12.878463
G.hirsu 22.279986
> as.data.frame(tol)
             Tol
O.univ  3.746359
G.cglob 1.895600
G.ruber 1.909561
G.tenel 2.124799
G.saccu 1.979651
G.rubes 1.968294
G.pacL  3.941352
G.pacR  5.181162
G.bullo 5.827980
G.falco 3.109193
G.calid 2.973112
G.aequi 2.561697
G.gluti 5.898256
G.duter 1.998304
G.infla 4.723884
G.trnL  4.161704
G.trnR  3.434920
G.crasf 3.354021
G.scitu 3.990673
G.mentu 2.386584
P.obliq 1.554762
C.nitid 1.461725
S.dehis 3.844730
G.digit 3.108881
Other   5.112464
G.quin  4.268777
G.hirsu 3.942135
> 
> 
> 
> cleanEx()
> nameEx("pcr")
> ### * pcr
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: pcr
> ### Title: Prinicpal component regression transfer function models
> ### Aliases: pcr pcr.default pcr.formula print.pcr Hellinger ChiSquare
> ###   performance.pcr fitted.pcr coef.pcr residuals.pcr screeplot.pcr
> ###   eigenvals.pcr
> ### Keywords: methods
> 
> ### ** Examples
> 
> ## Load the Imbrie & Kipp data and
> ## summer sea-surface temperatures
> data(ImbrieKipp)
> data(SumSST)
> 
> ## normal interface and apply Hellinger transformation
> mod <- pcr(ImbrieKipp, SumSST, tranFun = Hellinger)
> mod

	Principal Component Regression Model

Call:
pcr(x = ImbrieKipp, y = SumSST, tranFun = Hellinger)

No. of Components: 27

RMSE (Apparent):
     PC1      PC2      PC3      PC4      PC5      PC6      PC7      PC8 
2.381215 1.707588 1.680896 1.679774 1.608903 1.535145 1.507995 1.496939 
     PC9     PC10     PC11     PC12     PC13     PC14     PC15     PC16 
1.496908 1.432142 1.426444 1.405155 1.391348 1.349172 1.349172 1.315284 
    PC17     PC18     PC19     PC20     PC21     PC22     PC23     PC24 
1.313187 1.311801 1.291201 1.206484 1.188438 1.187503 1.171215 1.170947 
    PC25     PC26     PC27 
1.170380 1.162497 1.162355 
> 
> ## formula interface, but as above
> mod2 <- pcr(SumSST ~ ., data = ImbrieKipp, tranFun = Hellinger)
> mod2

	Principal Component Regression Model

Call:
pcr(formula = SumSST ~ ., data = ImbrieKipp, tranFun = Hellinger)

No. of Components: 27

RMSE (Apparent):
     PC1      PC2      PC3      PC4      PC5      PC6      PC7      PC8 
2.381215 1.707588 1.680896 1.679774 1.608903 1.535145 1.507995 1.496939 
     PC9     PC10     PC11     PC12     PC13     PC14     PC15     PC16 
1.496908 1.432142 1.426444 1.405155 1.391348 1.349172 1.349172 1.315284 
    PC17     PC18     PC19     PC20     PC21     PC22     PC23     PC24 
1.313187 1.311801 1.291201 1.206484 1.188438 1.187503 1.171215 1.170947 
    PC25     PC26     PC27 
1.170380 1.162497 1.162355 
> 
> ## Several standard methods are available
> fitted(mod, comps = 1:4)
               PC1       PC2       PC3       PC4
V14.61   10.555808  6.619315  6.231607  6.223489
V17.196  10.426913  6.642886  6.321525  6.331140
V18.110  10.046044  6.588254  6.229915  6.213675
V16.227   9.934414  6.385660  6.125620  6.122140
V14.47   10.344901  8.688447  8.462348  8.415080
V23.22    9.380071  7.894699  8.078653  8.121775
V2.12    10.327887  6.574059  6.254559  6.245294
V23.29   11.220420 11.010411 11.624394 11.747316
V12.43   10.262113 10.898128 11.104700 11.068104
R9.7     12.341125 12.821689 13.524704 13.647164
A157.3   11.858419 12.965630 13.111907 13.066726
V23.81   14.593051 16.556046 17.227016 17.277798
V23.82   13.336231 14.880487 15.434312 15.449878
V12.53   13.710271 16.082667 16.071022 16.031209
V23.83   12.848861 14.545725 15.164077 15.181428
V12.56   16.776159 19.280888 18.991744 18.968327
A152.84  17.077391 19.199983 19.242103 19.297802
V16.50   16.263966 18.370537 18.123056 18.017602
V22.122  14.919350 17.161238 17.120519 16.994304
V16.41   21.781309 23.324942 23.009634 22.922366
V4.32    20.986958 22.505015 22.408206 22.462948
V12.66   19.028806 20.660237 20.722466 20.672507
V19.245  21.247213 22.864519 22.688461 22.571391
V4.8     20.751607 22.455502 22.271175 22.373501
A180.15  19.780414 21.697544 21.557218 21.601158
V18.34   21.872722 23.281368 22.901843 22.877120
V20.213  22.441029 23.899982 23.607650 23.642023
V19.222  22.079376 23.527630 23.455039 23.419094
A180.39  24.324601 25.324928 25.201835 25.156614
V16.189  26.545437 26.689606 26.485185 26.482065
V12.18   25.921284 26.412748 26.169977 26.243723
V7.67    22.963671 24.469206 24.259184 24.257127
V17.165  22.963501 24.371047 23.989180 24.069959
V19.310  22.547546 24.259671 24.000703 24.001026
V16.190  24.465707 25.339617 25.171419 25.161826
A153.154 25.998933 26.517402 26.140467 26.233199
V19.308  26.524374 26.827078 26.364425 26.460970
V22.172  27.461512 27.008179 27.100808 27.101809
V10.98   23.296429 24.340573 24.058102 24.033477
V22.219  25.575392 26.028292 25.614264 25.698634
V16.33   26.871770 26.473815 26.393492 26.301020
V22.204  26.415256 26.199712 26.432944 26.417952
V20.167  28.638137 27.643128 27.607118 27.617569
V10.89   27.604368 27.152325 27.013009 27.101828
V12.79   26.985569 26.512017 26.775884 26.753831
V19.216  26.318526 26.447055 26.447463 26.376106
V14.90   26.549162 25.911084 26.210126 26.227570
A180.72  27.195719 26.297326 26.561474 26.539114
V16.21   28.761788 27.523073 27.513898 27.575058
A180.76  28.066329 26.901275 27.191136 27.188959
V15.164  28.684206 27.361226 27.427899 27.467281
A180.78  25.584535 24.635575 25.160030 25.050603
V14.5    28.541053 27.094016 27.361091 27.330425
V3.128   28.020994 26.998395 27.075575 27.024086
A179.13  27.854058 26.920927 26.758398 26.900515
V9.31    26.315023 25.337387 25.675590 25.682354
V20.230  27.958050 26.757884 27.073016 27.065162
V20.7    28.472945 26.743289 26.778757 26.706427
V20.234  28.285842 26.960325 27.241527 27.229153
V18.21   28.619852 27.033444 27.307550 27.256230
V12.122  28.375604 27.024886 27.273001 27.225971
> resid(mod, comps = 1:4)
                 PC1         PC2         PC3         PC4
V14.61   -8.55580828 -4.61931539 -4.23160689 -4.22348927
V17.196  -5.42691346 -1.64288550 -1.32152484 -1.33114042
V18.110  -4.54604377 -1.08825356 -0.72991536 -0.71367516
V16.227  -2.93441364  0.61433992  0.87437956  0.87785995
V14.47   -3.34490101 -1.68844684 -1.46234814 -1.41507982
V23.22    1.11992858  2.60530095  2.42134659  2.37822477
V2.12     0.67211261  4.42594079  4.74544141  4.75470567
V23.29   -1.22042034 -1.01041144 -1.62439376 -1.74731557
V12.43    2.73788748  2.10187177  1.89529962  1.93189598
R9.7     -0.34112536 -0.82168936 -1.52470351 -1.64716394
A157.3    2.14158093  1.03436954  0.88809328  0.93327443
V23.81   -0.09305088 -2.05604621 -2.72701564 -2.77779830
V23.82    1.66376884  0.11951252 -0.43431226 -0.44987757
V12.53    0.78972926 -1.58266660 -1.57102151 -1.53120873
V23.83    3.15113866  1.45427521  0.83592257  0.81857207
V12.56    1.22384150 -1.28088823 -0.99174384 -0.96832655
A152.84   2.92260950  0.80001714  0.75789671  0.70219785
V16.50    1.73603415 -0.37053699 -0.12305564 -0.01760185
V22.122   4.08064989  1.83876237  1.87948061  2.00569618
V16.41   -3.28130912 -4.82494212 -4.50963378 -4.42236632
V4.32     0.51304180 -1.00501470 -0.90820579 -0.96294823
V12.66    1.97119373  0.33976296  0.27753388  0.32749338
V19.245  -0.24721268 -1.86451920 -1.68846065 -1.57139122
V4.8      3.24839261  1.54449833  1.72882462  1.62649913
A180.15   4.21958575  2.30245555  2.44278198  2.39884202
V18.34    1.12727837 -0.28136770  0.09815736  0.12288040
V20.213   1.55897133  0.10001846  0.39235035  0.35797682
V19.222   0.92062407 -0.52762978 -0.45503949 -0.41909357
A180.39  -1.32460093 -2.32492753 -2.20183543 -2.15661410
V16.189  -2.54543712 -2.68960583 -2.48518493 -2.48206451
V12.18   -0.92128430 -1.41274773 -1.16997716 -1.24372269
V7.67     3.03632898  1.53079362  1.74081620  1.74287253
V17.165   3.03649858  1.62895270  2.01081972  1.93004135
V19.310   3.45245449  1.74032881  1.99929681  1.99897351
V16.190   0.53429312 -0.33961708 -0.17141935 -0.16182624
A153.154  0.00106744 -0.51740153 -0.14046678 -0.23319938
V19.308  -0.52437386 -0.82707755 -0.36442472 -0.46096976
V22.172  -2.96151168 -2.50817888 -2.60080768 -2.60180880
V10.98    3.70357142  2.65942657  2.94189846  2.96652266
V22.219   0.62460843  0.17170781  0.58573582  0.50136556
V16.33   -1.87177023 -1.47381459 -1.39349177 -1.30101973
V22.204   0.08474448  0.30028792  0.06705632  0.08204839
V20.167  -2.43813701 -1.44312826 -1.40711830 -1.41756903
V10.89   -1.60436848 -1.15232531 -1.01300912 -1.10182847
V12.79   -0.98556944 -0.51201684 -0.77588414 -0.75383126
V19.216   0.68147388  0.55294527  0.55253680  0.62389450
V14.90    0.45083830  1.08891559  0.78987351  0.77242971
A180.72   0.30428130  1.20267358  0.93852585  0.96088599
V16.21   -1.76178778 -0.52307300 -0.51389825 -0.57505766
A180.76  -1.06632860  0.09872517 -0.19113579 -0.18895925
V15.164  -1.68420625 -0.36122600 -0.42789930 -0.46728143
A180.78   1.41546459  2.36442498  1.83997023  1.94939711
V14.5    -1.54105274 -0.09401624 -0.36109103 -0.33042474
V3.128    0.97900593  2.00160534  1.92442533  1.97591411
A179.13   0.64594244  1.57907275  1.74160153  1.59948509
V9.31     1.18497719  2.16261291  1.82440952  1.81764617
V20.230  -0.45805035  0.74211555  0.42698439  0.43483780
V20.7    -0.97294453  0.75671106  0.72124311  0.79357341
V20.234  -1.28584195  0.03967503 -0.24152719 -0.22915280
V18.21   -1.61985198 -0.03344370 -0.30754956 -0.25622958
V12.122  -0.37560386  0.97511353  0.72699945  0.77402942
> coef(mod, comps = 1:4)
                PC1        PC2          PC3         PC4
O.univ   0.97960861  1.2016603   1.13015179   1.1128268
G.cglob  1.13276639  1.1471271   1.00706123   1.0353731
G.ruber  8.65297976  8.4754988   8.14705363   8.2402103
G.tenel  1.24482761  1.3677458   1.21179400   1.3121058
G.saccu  4.75959547  4.2246275   4.52885172   4.3579999
G.rubes  1.02476239  0.9544143   0.94733705   0.9961300
G.pacL  -7.17321578 -9.9353151 -10.45254750 -10.4565564
G.pacR  -3.90121839 -2.3776793  -1.67789328  -1.7008174
G.bullo -3.13326388 -1.4979098  -1.17933855  -1.0882139
G.falco  0.73594411  2.1020478   1.54570170   1.6164401
G.calid  1.19625271  1.5937153   1.39718760   1.4306745
G.aequi  2.43986501  2.5052818   2.46842828   2.4770908
G.gluti  1.14851354  1.7835416   2.39612953   2.5787239
G.duter  1.69404223  1.5003410   1.70327333   1.5826949
G.infla -2.20267657  0.5541993   0.08307447  -0.1458796
G.trnL  -0.03914596  1.1190751   0.58123923   0.5835277
G.trnR   1.08435617  1.5664182   1.37083689   1.4156359
G.crasf  0.54353847  0.7381725   0.62418317   0.5621548
G.scitu  0.22989678  0.7283892   0.72644944   0.7652869
G.mentu  2.22457439  1.9158889   2.20559117   2.0235286
P.obliq  1.52543742  1.1961121   1.53168829   1.4341713
C.nitid  0.40742311  0.3362025   0.31750482   0.3386641
S.dehis  0.24717152  0.2328456   0.24478974   0.2258191
G.digit  0.41418305  0.4783198   0.43292016   0.4492291
Other    0.42771518  0.9316359   0.96369184   0.9914426
G.quin  -1.41219311 -1.0681350  -0.74369293  -0.6525037
G.hirsu -0.19363169  0.7346868   0.44297993   0.4546855
> 
> ## Eigenvalues can be extracted
> eigenvals(mod)
        PC1         PC2         PC3         PC4         PC5         PC6 
12.83557461  6.36679233  1.95151000  1.01340354  0.55172707  0.43074829 
        PC7         PC8         PC9        PC10        PC11        PC12 
 0.34535328  0.26040498  0.23688898  0.21194092  0.17845946  0.17727005 
       PC13        PC14        PC15        PC16        PC17        PC18 
 0.15110942  0.13603337  0.09872344  0.08822732  0.08410382  0.06901474 
       PC19        PC20        PC21        PC22        PC23        PC24 
 0.06059469  0.05572210  0.04438095  0.04006814  0.03096008  0.02463006 
       PC25        PC26        PC27 
 0.01848773  0.01713097  0.01028315 
> 
> ## screeplot method
> screeplot(mod)
> 
> 
> 
> cleanEx()
> nameEx("performance")
> ### * performance
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: performance
> ### Title: Transfer function model performance statistics
> ### Aliases: performance print.performance performance.wa
> ###   performance.predict.wa performance.bootstrap.wa
> ### Keywords: methods utilities
> 
> ### ** Examples
> 
> ## continue the example from ?wa
> example(wa)

wa> data(ImbrieKipp)

wa> data(SumSST)

wa> ## fit the WA model
wa> mod <- wa(SumSST ~., data = ImbrieKipp)

wa> mod

	Weighted Averaging Transfer Function

Call:
wa(formula = SumSST ~ ., data = ImbrieKipp) 

Deshrinking  : Inverse 
Tolerance DW : No 
No. samples  : 61 
No. species  : 27 

Performance:
     RMSE  R-squared  Avg. Bias  Max. Bias  
   2.0188     0.9173     0.0000    -3.8155  


wa> ## extract the fitted values
wa> fitted(mod)
   V14.61   V17.196   V18.110   V16.227    V14.47    V23.22     V2.12    V23.29 
 3.730960  3.859921  4.107664  4.293906  8.287580  9.244409  4.076131 13.815481 
   V12.43      R9.7    A157.3    V23.81    V23.82    V12.53    V23.83    V12.56 
14.334514 16.521301 15.804396 18.736542 18.289596 18.458708 17.388560 20.401983 
  A152.84    V16.50   V22.122    V16.41     V4.32    V12.66   V19.245      V4.8 
19.969421 19.708591 18.781540 22.789225 22.407882 20.785492 22.454368 22.181405 
  A180.15    V18.34   V20.213   V19.222   A180.39   V16.189    V12.18     V7.67 
21.562333 23.337938 23.360786 22.844542 24.219277 25.625657 25.498810 23.377913 
  V17.165   V19.310   V16.190  A153.154   V19.308   V22.172    V10.98   V22.219 
23.747234 23.112465 24.516578 25.383739 25.796840 26.258495 24.162462 25.464444 
   V16.33   V22.204   V20.167    V10.89    V12.79   V19.216    V14.90   A180.72 
26.240175 25.824031 26.677965 26.394526 26.091336 25.719139 25.862682 26.338544 
   V16.21   A180.76   V15.164   A180.78     V14.5    V3.128   A179.13     V9.31 
26.789758 26.696906 26.821669 25.987374 26.882435 26.906235 26.515335 26.067970 
  V20.230     V20.7   V20.234    V18.21   V12.122 
26.608829 27.231642 26.765410 26.945937 26.833012 

wa> ## residuals for the training set
wa> residuals(mod)
     V14.61     V17.196     V18.110     V16.227      V14.47      V23.22 
-1.73095992  1.14007886  1.39233574  2.70609421 -1.28758014  1.25559075 
      V2.12      V23.29      V12.43        R9.7      A157.3      V23.81 
 6.92386910 -3.81548071 -1.33451363 -4.52130053 -1.80439553 -4.23654166 
     V23.82      V12.53      V23.83      V12.56     A152.84      V16.50 
-3.28959647 -3.95870813 -1.38855980 -2.40198307  0.03057864 -1.70859145 
    V22.122      V16.41       V4.32      V12.66     V19.245        V4.8 
 0.21846025 -4.28922519 -0.90788238  0.21450778 -1.45436796  1.81859450 
    A180.15      V18.34     V20.213     V19.222     A180.39     V16.189 
 2.43766723 -0.33793825  0.63921359  0.15545775 -1.21927713 -1.62565746 
     V12.18       V7.67     V17.165     V19.310     V16.190    A153.154 
-0.49880978  2.62208666  2.25276621  2.88753454  0.48342160  0.61626144 
    V19.308     V22.172      V10.98     V22.219      V16.33     V22.204 
 0.20316050 -1.75849478  2.83753826  0.73555554 -1.24017489  0.67596920 
    V20.167      V10.89      V12.79     V19.216      V14.90     A180.72 
-0.47796506 -0.39452607 -0.09133632  1.28086084  1.13731805  1.16145583 
     V16.21     A180.76     V15.164     A180.78       V14.5      V3.128 
 0.21024193  0.30309427  0.17833109  1.01262616  0.11756523  2.09376547 
    A179.13       V9.31     V20.230       V20.7     V20.234      V18.21 
 1.98466463  1.43202977  0.89117138  0.26835826  0.23458963  0.05406326 
    V12.122 
 1.16698821 

wa> ## deshrinking coefficients
wa> coef(mod)
[1] -5.687554  1.265881

wa> ## diagnostics plots
wa> par(mfrow = c(1,2))

wa> plot(mod)

wa> par(mfrow = c(1,1))

wa> ## tolerance DW
wa> mod2 <- wa(SumSST ~ ., data = ImbrieKipp, tol.dw = TRUE,
wa+            min.tol = 2, small.tol = "min")

wa> mod2

	Weighted Averaging Transfer Function

Call:
wa(formula = SumSST ~ ., data = ImbrieKipp, tol.dw = TRUE, small.tol = "min",  

     min.tol = 2) 

Deshrinking  : Inverse 
Tolerance DW : Yes 
No. samples  : 61 
No. species  : 27 

Performance:
     RMSE  R-squared  Avg. Bias  Max. Bias  
   2.0268     0.9166     0.0000    -2.4507  


wa> ## compare actual tolerances to working values
wa> with(mod2, rbind(tolerances, model.tol))
             O.univ  G.cglob  G.ruber  G.tenel  G.saccu  G.rubes   G.pacL
tolerances 3.746359 1.895600 1.909561 2.124799 1.979651 1.968294 3.941352
model.tol  3.746359 2.124799 2.124799 2.124799 2.124799 2.124799 3.941352
             G.pacR G.bullo  G.falco  G.calid  G.aequi  G.gluti  G.duter
tolerances 5.181162 5.82798 3.109193 2.973112 2.561697 5.898256 1.998304
model.tol  5.181162 5.82798 3.109193 2.973112 2.561697 5.898256 2.124799
            G.infla   G.trnL  G.trnR  G.crasf  G.scitu  G.mentu  P.obliq
tolerances 4.723884 4.161704 3.43492 3.354021 3.990673 2.386584 1.554762
model.tol  4.723884 4.161704 3.43492 3.354021 3.990673 2.386584 2.124799
            C.nitid S.dehis  G.digit    Other   G.quin  G.hirsu
tolerances 1.461725 3.84473 3.108881 5.112464 4.268777 3.942135
model.tol  2.124799 3.84473 3.108881 5.112464 4.268777 3.942135
> 
> ## the model performance statistics
> performance(mod)
      RMSE         R2   Avg.Bias   Max.Bias 
 2.019e+00  9.173e-01  2.228e-14 -3.815e+00 
> 
> 
> 
> cleanEx()
> nameEx("plot.dissimilarities")
> ### * plot.dissimilarities
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plot.dissimilarities
> ### Title: Plots the distribution of extracted dissimilarities
> ### Aliases: plot.dissimilarities
> ### Keywords: hplot
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## analog matching between SWAPImbrie & Kipp and V12.122 core
> ik.analog <- analog(ImbrieKipp, V12.122, method = "chord")
> ik.analog

	Analogue matching for fossil samples

Call: analog(x = ImbrieKipp, y = V12.122, method = "chord") 
Dissimilarity: chord 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

	Minimum dissimilarity per sample

Dissimilarity: chord 

    0    10    20    30    40    50    60    70    80    90   100   110   120 
0.900 0.902 0.903 0.904 0.904 0.907 0.907 0.908 0.908 0.908 0.910 0.908 0.910 
  130   140   150   160   170   180   190   200   210   220   230   240   250 
0.909 0.911 0.908 0.908 0.906 0.908 0.909 0.906 0.907 0.906 0.906 0.906 0.906 
  260   270   280   290   300   310   320   330   340   350   360   370   380 
0.906 0.909 0.910 0.907 0.907 0.912 0.910 0.911 0.907 0.908 0.908 0.910 0.908 
  390   400   410   420   430   440   450   460   470   480   490   500   510 
0.910 0.907 0.911 0.906 0.909 0.905 0.906 0.907 0.906 0.909 0.907 0.906 0.911 
  520   530   540   550   560   570   580   590   600   610   620   630   640 
0.907 0.910 0.910 0.910 0.907 0.907 0.906 0.904 0.906 0.910 0.913 0.906 0.907 
  650   660   670   680   690   700   710   720   730   740   750   760   770 
0.906 0.910 0.911 0.913 0.907 0.909 0.909 0.912 0.914 0.908 0.907 0.909 0.911 
  780   790   800   810   820   830   840   850   860   870   880   890   900 
0.914 0.907 0.907 0.908 0.908 0.906 0.907 0.910 0.910 0.910 0.909 0.913 0.912 
  910   920   930   940   950   960   970   980   990  1000  1010  1020  1030 
0.908 0.909 0.909 0.907 0.910 0.909 0.908 0.907 0.911 0.908 0.913 0.910 0.910 
 1040  1050  1060  1070  1080  1090 
0.912 0.906 0.910 0.910 0.908 0.907 

> summary(ik.analog)

	Analogue matching for fossil samples

Call: analog(x = ImbrieKipp, y = V12.122, method = "chord") 
Dissimilarity: chord 
k-closest: 10 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

k-closest analogues

   k         0        10        20        30        40        50        60
   1  V12.122   V12.122   V12.122   V20.230   V22.172   V22.172   V22.172 
   2  V14.5     V20.234   V20.234   V14.90    V20.167   V20.167   A153.154
   3  V20.234   V14.5     V16.21    V22.172   V19.216   V19.216   V10.89  
   4  V18.21    V18.21    A180.76   V9.31     V10.89    V10.89    A179.13 
   5  A180.76   A180.76   V14.5     V12.79    V22.204   V16.21    V16.21  
   6  A180.72   A180.72   V15.164   V19.216   V16.21    V15.164   V20.167 
   7  V15.164   V20.230   V20.230   A180.72   V20.234   V20.234   V22.219 
   8  V16.21    V20.167   V14.90    V22.204   V20.230   A153.154  V19.308 
   9  V20.167   V16.21    A180.72   A180.76   V14.90    V20.230   V12.18  
  10  V20.230   V20.7     V20.167   V20.167   V15.164   A179.13   V19.216 
        70        80        90       100       110       120       130
  V10.89    V22.172   V19.216   V19.216   V9.31     V9.31     V9.31   
  V22.172   V19.216   V22.172   V22.204   V14.90    V19.216   V14.90  
  V16.21    V20.167   V22.204   V9.31     V20.230   V22.172   V19.216 
  V14.90    V16.21    V16.190   V22.172   V19.216   V14.90    V22.172 
  V19.216   V10.89    A153.154  V20.234   V22.204   V20.230   V20.230 
  A153.154  V15.164   V14.90    V14.90    V12.79    V20.167   V12.79  
  V20.167   A179.13   V9.31     V16.21    V22.172   A153.154  V22.204 
  V20.234   V20.230   V20.167   V10.89    A180.72   V22.204   A153.154
  V22.204   V20.234   V12.18    A153.154  A180.76   V12.79    V16.190 
  V9.31     V14.90    V10.89    V15.164   V20.234   V3.128    A180.72 
       140       150       160       170       180       190       200
  V9.31     V10.89    V20.167   V20.167   A179.13   V19.216   V20.230 
  V22.172   V22.172   V20.230   V10.89    V20.167   V20.230   V14.90  
  V20.230   V20.167   V10.89    V20.230   V14.90    V14.90    V22.172 
  V20.234   V19.216   V19.216   V16.21    V20.230   V9.31     V9.31   
  V14.90    V16.21    V9.31     V22.172   V10.89    V22.172   V20.167 
  V20.167   A153.154  V14.90    A153.154  V16.21    V20.167   V20.234 
  V12.122   V14.90    A153.154  V14.90    V22.172   V12.79    V12.122 
  V19.216   V20.234   V16.190   A179.13   V9.31     V12.122   V12.79  
  A180.72   V15.164   V16.33    V9.31     V15.164   V20.234   V16.21  
  V16.21    V20.230   V22.172   V22.219   V19.216   V3.128    A180.72 
       210       220       230       240       250       260       270
  V14.90    V12.122   V12.122   V3.128    V14.90    V14.90    V14.90  
  V22.172   V14.90    V18.21    V20.167   V22.204   V20.167   V22.172 
  V20.167   V20.230   V14.90    V12.122   V22.172   V22.172   A180.72 
  V3.128    V18.21    V14.5     V14.90    A180.72   V3.128    V12.122 
  V12.122   V20.167   A180.76   V18.21    V12.79    V12.122   V12.79  
  V20.230   V20.234   V20.234   V22.172   V12.122   A180.72   V22.204 
  V20.234   V14.5     V3.128    A180.76   A180.76   V22.204   V3.128  
  A180.72   V22.172   A180.72   V15.164   V20.167   V12.79    A180.78 
  V15.164   A180.72   V20.167   A180.72   V10.89    A180.76   V18.21  
  A180.76   A180.76   V15.164   V14.5     V15.164   V20.230   V20.167 
       280       290       300       310       320       330       340
  V22.172   V12.122   V22.172   V19.216   V19.216   V22.172   V19.216 
  V14.90    V14.90    V20.167   V16.33    V9.31     V19.216   V10.89  
  V12.122   A180.72   V19.216   V14.90    V22.172   V14.90    V22.172 
  V22.204   V14.5     V15.164   V22.172   V20.230   V10.89    A153.154
  V19.216   V20.167   V16.21    V9.31     V20.234   A153.154  V20.167 
  V15.164   V18.21    V10.89    V10.89    V20.167   V22.204   A179.13 
  V18.21    A180.76   V14.90    V20.167   V22.204   V9.31     V22.204 
  V12.79    V20.234   V20.234   V20.230   V14.90    A180.39   V19.308 
  V14.5     V3.128    V20.230   V16.190   V16.21    V16.190   V16.21  
  V20.234   V22.172   A179.13   V16.21    V10.89    V22.219   V22.219 
       350       360       370       380       390       400       410
  V20.230   V20.167   V19.216   V9.31     V19.216   V9.31     V3.128  
  V20.167   V22.172   V22.172   V12.122   V22.172   V14.90    V12.122 
  V9.31     V16.21    V20.167   V20.234   V3.128    V22.204   V20.167 
  V19.216   V10.89    V3.128    V14.90    V12.122   A180.76   V20.230 
  V14.90    V14.90    V22.204   V20.230   V14.90    V20.230   V14.90  
  V16.21    V20.234   V12.122   A180.76   V9.31     A180.72   V9.31   
  V22.172   V15.164   V20.234   V3.128    V20.234   V22.172   V22.172 
  V16.33    V12.122   V20.230   A180.72   V16.33    V12.79    V20.7   
  V10.89    A179.13   V15.164   V22.204   V20.167   V19.216   V20.234 
  V15.164   V20.230   V16.33    V20.167   V22.204   V20.234   V19.216 
       420       430       440       450       460       470       480
  V9.31     V12.122   V9.31     A180.76   V20.167   V20.167   V14.90  
  V20.234   V9.31     V14.90    V18.21    V3.128    V22.172   A180.76 
  V14.90    V14.90    V20.234   V20.234   V14.5     V20.234   V22.204 
  V20.230   V20.234   V20.230   A180.72   V18.21    V3.128    V22.172 
  V22.172   A180.76   V12.122   V12.122   A180.76   V14.90    A180.72 
  V12.122   V20.230   A180.72   V14.5     V20.234   V20.230   V12.79  
  V20.167   V3.128    V22.204   V20.230   V12.122   A180.76   V20.230 
  V15.164   A180.72   A180.76   V15.164   V20.230   A180.72   V20.234 
  V3.128    V20.167   V12.79    V3.128    A180.72   V22.204   V3.128  
  A180.76   V22.172   V19.216   V14.90    V15.164   V19.216   A180.78 
       490       500       510       520       530       540       550
  V20.234   V12.122   V9.31     V14.90    V20.167   V10.89    V22.204 
  V3.128    V20.234   V22.204   V22.204   V19.216   A153.154  V16.190 
  A180.76   A180.76   V14.90    V9.31     V22.172   V22.219   V19.216 
  A180.72   V20.230   V20.234   V3.128    V10.89    V19.216   V22.172 
  V12.122   V18.21    V20.230   V19.216   V16.21    V12.18    V14.90  
  V22.204   A180.72   V12.122   A180.76   V22.204   V16.190   V20.230 
  V18.21    V3.128    A180.72   A180.72   V12.122   V22.172   V12.79  
  V14.90    V14.5     V19.216   A180.78   V15.164   V16.21    V9.31   
  V14.5     V20.7     A180.76   V12.79    V20.234   V20.167   A180.72 
  V20.230   V20.167   V22.172   V22.172   V20.230   V22.204   V10.89  
       560       570       580       590       600       610       620
  V14.90    V20.230   V22.204   V20.167   V14.90    V20.167   V22.204 
  V20.230   V9.31     V12.79    V22.172   A180.72   V14.90    V20.167 
  A180.76   A180.78   V14.90    V15.164   A180.76   V22.204   V19.216 
  V9.31     V14.90    A180.72   V16.21    V22.204   V12.122   V12.122 
  A180.72   A180.72   V22.172   V10.89    V12.122   V22.172   V22.172 
  A180.78   V22.204   V20.230   V19.216   V9.31     V20.230   V3.128  
  V3.128    A180.76   A180.76   V20.230   V20.234   V19.216   V20.234 
  V12.79    V3.128    V9.31     V20.234   V22.172   V3.128    V14.90  
  V22.172   V12.79    V19.216   V3.128    V12.79    V12.79    V20.230 
  V22.204   V20.234   V20.234   V14.90    V20.230   A180.72   V16.33  
       630       640       650       660       670       680       690
  V14.90    V12.122   V22.204   V14.90    V9.31     V3.128    A179.13 
  V9.31     V14.90    V12.122   V19.216   V20.234   V14.90    V16.21  
  A180.76   V20.234   V20.234   V22.204   V22.204   V22.172   V10.89  
  A180.72   V20.167   V14.90    V20.167   V14.90    V20.167   V15.164 
  V12.122   V14.5     V22.172   V22.172   A180.72   V19.216   V20.167 
  V22.204   V22.204   A180.72   V9.31     V22.172   V9.31     V22.172 
  V20.230   A180.72   V20.167   V3.128    V20.230   V22.204   V22.204 
  V20.234   V3.128    V14.5     V16.33    V12.122   V16.190   V22.219 
  V22.172   V18.21    A180.76   A180.72   V20.167   V20.230   V12.18  
  V20.167   V20.230   V15.164   V10.89    V15.164   A180.72   V19.308 
       700       710       720       730       740       750       760
  V12.122   V20.167   V22.204   V14.90    V14.90    V22.204   V20.234 
  V22.204   V3.128    V22.172   V3.128    V22.204   V20.234   V22.204 
  V20.167   V16.21    V9.31     V9.31     A180.72   V14.90    V14.90  
  V20.234   V15.164   V20.230   V22.172   V12.122   A180.72   A180.76 
  V22.172   V10.89    V14.90    V22.204   V22.172   V12.79    A180.72 
  V19.216   V20.234   V3.128    V20.230   V20.234   V22.172   V3.128  
  V16.21    V12.122   V10.89    V20.167   V20.230   V20.230   V20.167 
  V10.89    V20.230   V19.216   V12.122   V12.79    V12.122   V12.122 
  V15.164   V22.172   V20.167   V19.216   V20.167   V9.31     V20.230 
  A180.72   V22.204   A180.72   V20.234   V3.128    A180.76   V9.31   
       770       780       790       800       810       820       830
  V3.128    V3.128    V18.21    V12.122   V12.122   V14.90    V19.216 
  V20.167   V18.21    V12.122   V18.21    V14.90    V22.204   V22.172 
  V15.164   A180.78   V14.5     V14.5     V22.172   V19.216   V20.167 
  V20.230   V14.90    V20.167   V20.234   V22.204   V12.79    V16.33  
  V14.90    V12.122   V14.90    V20.167   V15.164   V22.172   V22.204 
  V16.21    V22.172   A180.72   V15.164   V20.234   V20.230   V14.90  
  V22.204   V20.167   V3.128    A180.72   V12.79    A180.72   V12.122 
  A180.76   A180.72   A180.76   V14.90    V14.5     V20.167   V16.190 
  V9.31     V20.230   V20.234   V12.79    V18.21    V10.89    V12.79  
  V12.122   V14.5     V15.164   V16.21    A180.72   A180.76   V10.89  
       840       850       860       870       880       890       900
  V19.216   V22.204   V22.204   V19.216   V19.216   V19.216   V19.216 
  V16.33    V20.234   V14.90    V22.172   V9.31     V19.222   V9.31   
  V22.204   V19.216   V22.172   V20.167   V22.172   V16.190   V12.79  
  V20.167   V9.31     V20.167   V22.204   V20.230   V10.98    V22.204 
  V20.234   V14.90    V19.216   V15.164   V12.122   V22.204   V14.90  
  V10.89    V12.122   V10.89    V14.90    V14.90    A180.39   V22.172 
  V22.172   V20.167   A179.13   V3.128    V20.234   V14.90    V20.230 
  A180.72   V20.230   V15.164   V10.89    V12.79    V22.172   V16.190 
  V9.31     A180.76   V12.18    V20.230   V20.167   V12.79    A180.39 
  V14.90    A180.72   V9.31     V16.21    A180.72   V9.31     V19.222 
       910       920       930       940       950       960       970
  V19.216   V19.216   V9.31     V19.216   V20.167   V20.230   V9.31   
  V22.204   V9.31     V20.230   V20.230   V14.90    V12.122   V20.234 
  V16.190   V16.190   V19.216   V9.31     V16.21    V20.234   V20.230 
  V22.172   V14.90    V22.204   V20.167   V20.230   V12.79    V22.172 
  V19.222   V22.204   V22.172   V14.90    V12.122   V22.172   A180.76 
  V12.79    V22.172   V14.90    V22.172   V9.31     V16.21    V19.216 
  A180.39   V20.230   V20.234   V12.79    V20.234   V19.216   V16.21  
  V14.90    A180.39   V20.167   V16.21    V15.164   V9.31     V20.167 
  A153.154  V10.98    V12.79    A180.72   V22.172   V14.90    A180.72 
  V9.31     V12.79    A180.72   V20.234   A179.13   A180.72   V14.90  
       980       990      1000      1010      1020      1030      1040
  V9.31     V9.31     V19.216   V14.90    V19.216   V14.90    V9.31   
  V20.230   V20.234   V14.90    V9.31     V16.190   V19.216   V14.90  
  V14.90    V20.230   V22.172   V20.230   V22.204   V22.172   V22.204 
  V20.234   V14.90    V9.31     V22.172   V22.172   V22.204   V19.216 
  A180.76   V22.172   V20.230   V12.79    V19.222   V9.31     V20.234 
  V22.172   V22.204   V12.79    A180.72   V14.90    V12.79    V12.79  
  A180.72   V12.79    V20.167   V19.216   A180.39   V16.190   V22.172 
  V12.79    V12.122   A180.72   V22.204   V12.66    A180.72   A180.72 
  V19.216   V19.216   V22.204   A180.39   V10.98    V20.234   A180.78 
  V12.122   A180.72   V16.21    V12.122   V12.79    V20.230   A180.76 
      1050      1060      1070      1080      1090
  V19.216   V22.204   V16.190   V19.216   V22.172 
  V22.204   V19.216   V19.216   V12.122   V22.204 
  V14.90    V14.90    V22.172   V22.172   V14.90  
  V22.172   V12.122   V22.204   V14.90    V19.216 
  V12.79    V22.172   V14.90    V22.204   V10.89  
  V9.31     V12.79    V12.18    V20.167   V20.167 
  V12.122   A180.72   V10.89    V12.79    V12.79  
  A180.72   V9.31     V20.167   A180.72   V20.234 
  V16.33    V20.234   V22.219   V20.230   V9.31   
  V16.190   A180.78   V9.31     V20.234   A180.72 

Dissimilarities for k-closest analogues

   k      0     10     20     30     40     50     60     70     80     90
   1  0.900  0.902  0.903  0.904  0.904  0.907  0.907  0.908  0.908  0.908
   2  0.903  0.904  0.904  0.904  0.905  0.908  0.908  0.909  0.908  0.910
   3  0.903  0.904  0.906  0.904  0.906  0.908  0.909  0.910  0.909  0.913
   4  0.903  0.906  0.906  0.905  0.906  0.909  0.910  0.910  0.909  0.913
   5  0.905  0.906  0.906  0.905  0.908  0.909  0.910  0.910  0.909  0.914
   6  0.905  0.907  0.906  0.905  0.908  0.909  0.910  0.911  0.910  0.914
   7  0.907  0.907  0.907  0.906  0.908  0.911  0.910  0.911  0.910  0.914
   8  0.907  0.908  0.907  0.906  0.908  0.911  0.911  0.911  0.910  0.914
   9  0.907  0.909  0.907  0.906  0.908  0.911  0.911  0.911  0.911  0.915
  10  0.908  0.910  0.907  0.906  0.908  0.912  0.911  0.911  0.911  0.915
    100    110    120    130    140    150    160    170    180    190    200
  0.910  0.908  0.910  0.909  0.911  0.908  0.908  0.906  0.908  0.909  0.906
  0.911  0.910  0.910  0.909  0.911  0.909  0.910  0.907  0.910  0.910  0.908
  0.911  0.912  0.911  0.910  0.912  0.909  0.910  0.907  0.910  0.910  0.908
  0.912  0.913  0.911  0.911  0.912  0.910  0.910  0.907  0.911  0.910  0.908
  0.913  0.914  0.912  0.911  0.914  0.910  0.910  0.907  0.911  0.912  0.908
  0.913  0.914  0.914  0.913  0.914  0.910  0.910  0.908  0.911  0.912  0.909
  0.913  0.914  0.914  0.913  0.915  0.911  0.910  0.908  0.911  0.912  0.909
  0.913  0.915  0.914  0.914  0.915  0.911  0.910  0.908  0.912  0.913  0.910
  0.914  0.915  0.915  0.914  0.915  0.911  0.911  0.909  0.913  0.914  0.910
  0.914  0.915  0.915  0.914  0.915  0.912  0.911  0.910  0.914  0.914  0.910
    210    220    230    240    250    260    270    280    290    300    310
  0.907  0.906  0.906  0.906  0.906  0.906  0.909  0.910  0.907  0.907  0.912
  0.908  0.909  0.908  0.910  0.908  0.908  0.910  0.911  0.908  0.908  0.913
  0.908  0.909  0.908  0.911  0.909  0.908  0.911  0.911  0.909  0.908  0.913
  0.908  0.909  0.908  0.911  0.910  0.908  0.912  0.911  0.909  0.909  0.914
  0.909  0.909  0.909  0.911  0.910  0.908  0.912  0.912  0.910  0.909  0.915
  0.910  0.909  0.909  0.912  0.911  0.909  0.912  0.912  0.910  0.909  0.916
  0.910  0.909  0.910  0.912  0.911  0.909  0.913  0.912  0.910  0.909  0.916
  0.910  0.910  0.910  0.913  0.911  0.910  0.913  0.912  0.911  0.910  0.916
  0.910  0.910  0.910  0.913  0.911  0.910  0.913  0.913  0.912  0.910  0.916
  0.910  0.910  0.911  0.913  0.911  0.910  0.914  0.914  0.912  0.910  0.917
    320    330    340    350    360    370    380    390    400    410    420
  0.910  0.911  0.907  0.908  0.908  0.910  0.908  0.910  0.907  0.911  0.906
  0.911  0.911  0.908  0.909  0.909  0.910  0.909  0.910  0.907  0.911  0.907
  0.911  0.911  0.908  0.909  0.909  0.911  0.909  0.912  0.909  0.912  0.907
  0.912  0.911  0.909  0.910  0.909  0.912  0.909  0.912  0.910  0.912  0.907
  0.912  0.912  0.909  0.910  0.909  0.912  0.910  0.912  0.910  0.912  0.908
  0.912  0.912  0.910  0.910  0.909  0.912  0.911  0.912  0.910  0.912  0.908
  0.913  0.913  0.911  0.911  0.909  0.913  0.911  0.913  0.910  0.913  0.909
  0.913  0.913  0.911  0.911  0.909  0.913  0.911  0.913  0.911  0.913  0.909
  0.913  0.913  0.911  0.912  0.910  0.914  0.911  0.913  0.911  0.913  0.909
  0.913  0.913  0.911  0.912  0.910  0.914  0.911  0.913  0.911  0.914  0.909
    430    440    450    460    470    480    490    500    510    520    530
  0.909  0.905  0.906  0.907  0.906  0.909  0.907  0.906  0.911  0.907  0.910
  0.911  0.908  0.907  0.907  0.906  0.909  0.907  0.907  0.912  0.910  0.911
  0.911  0.909  0.907  0.909  0.907  0.909  0.908  0.908  0.912  0.910  0.911
  0.911  0.909  0.908  0.910  0.907  0.910  0.908  0.908  0.913  0.911  0.911
  0.911  0.910  0.908  0.911  0.907  0.910  0.908  0.908  0.914  0.911  0.911
  0.912  0.911  0.908  0.912  0.907  0.911  0.908  0.909  0.914  0.912  0.911
  0.913  0.911  0.908  0.912  0.907  0.911  0.908  0.909  0.914  0.912  0.912
  0.913  0.911  0.909  0.912  0.907  0.911  0.909  0.910  0.915  0.912  0.912
  0.913  0.911  0.909  0.912  0.908  0.912  0.909  0.911  0.915  0.913  0.913
  0.914  0.911  0.909  0.912  0.908  0.912  0.909  0.911  0.915  0.913  0.913
    540    550    560    570    580    590    600    610    620    630    640
  0.910  0.910  0.907  0.907  0.906  0.904  0.906  0.910  0.913  0.906  0.907
  0.911  0.910  0.908  0.907  0.907  0.907  0.908  0.911  0.913  0.910  0.908
  0.911  0.911  0.910  0.909  0.907  0.907  0.908  0.911  0.914  0.910  0.909
  0.911  0.911  0.910  0.909  0.907  0.907  0.909  0.911  0.914  0.910  0.909
  0.912  0.911  0.910  0.909  0.908  0.907  0.910  0.911  0.915  0.910  0.909
  0.912  0.912  0.911  0.909  0.908  0.907  0.910  0.912  0.915  0.910  0.909
  0.913  0.913  0.911  0.910  0.910  0.907  0.910  0.913  0.915  0.911  0.910
  0.913  0.914  0.912  0.910  0.910  0.908  0.911  0.913  0.916  0.911  0.910
  0.913  0.914  0.912  0.910  0.911  0.908  0.911  0.913  0.916  0.912  0.910
  0.914  0.914  0.913  0.911  0.911  0.908  0.911  0.914  0.916  0.912  0.910
    650    660    670    680    690    700    710    720    730    740    750
  0.906  0.910  0.911  0.913  0.907  0.909  0.909  0.912  0.914  0.908  0.907
  0.907  0.910  0.911  0.913  0.909  0.909  0.911  0.913  0.914  0.909  0.909
  0.909  0.910  0.912  0.914  0.909  0.910  0.911  0.914  0.915  0.910  0.909
  0.909  0.910  0.912  0.916  0.909  0.911  0.912  0.914  0.915  0.910  0.910
  0.910  0.911  0.913  0.916  0.910  0.912  0.912  0.914  0.915  0.910  0.910
  0.910  0.911  0.913  0.916  0.914  0.913  0.913  0.915  0.915  0.910  0.910
  0.910  0.911  0.913  0.917  0.914  0.913  0.913  0.915  0.916  0.911  0.910
  0.911  0.912  0.913  0.918  0.914  0.913  0.913  0.916  0.916  0.911  0.911
  0.911  0.912  0.914  0.918  0.914  0.913  0.913  0.916  0.917  0.911  0.911
  0.911  0.913  0.914  0.919  0.915  0.913  0.914  0.916  0.917  0.911  0.911
    760    770    780    790    800    810    820    830    840    850    860
  0.909  0.911  0.914  0.907  0.907  0.908  0.908  0.906  0.907  0.910  0.910
  0.910  0.911  0.914  0.908  0.908  0.908  0.910  0.910  0.909  0.911  0.911
  0.910  0.913  0.917  0.910  0.909  0.909  0.910  0.910  0.911  0.911  0.912
  0.910  0.913  0.917  0.910  0.910  0.909  0.911  0.910  0.911  0.911  0.912
  0.910  0.913  0.917  0.911  0.910  0.909  0.912  0.911  0.912  0.912  0.912
  0.910  0.913  0.918  0.911  0.911  0.909  0.912  0.912  0.912  0.912  0.912
  0.911  0.914  0.918  0.911  0.911  0.909  0.913  0.912  0.913  0.913  0.913
  0.911  0.914  0.919  0.911  0.911  0.910  0.913  0.913  0.913  0.913  0.914
  0.912  0.914  0.919  0.911  0.912  0.910  0.914  0.913  0.914  0.913  0.914
  0.912  0.914  0.919  0.912  0.912  0.910  0.914  0.913  0.914  0.913  0.915
    870    880    890    900    910    920    930    940    950    960    970
  0.910  0.909  0.913  0.912  0.908  0.909  0.909  0.907  0.910  0.909  0.908
  0.910  0.912  0.914  0.915  0.912  0.913  0.910  0.908  0.910  0.910  0.908
  0.910  0.912  0.914  0.916  0.912  0.915  0.912  0.909  0.911  0.910  0.909
  0.911  0.913  0.915  0.916  0.913  0.916  0.913  0.909  0.911  0.911  0.909
  0.912  0.913  0.915  0.917  0.913  0.917  0.914  0.909  0.911  0.911  0.909
  0.913  0.913  0.915  0.918  0.913  0.917  0.915  0.910  0.911  0.911  0.909
  0.913  0.914  0.917  0.918  0.914  0.917  0.915  0.911  0.911  0.911  0.909
  0.913  0.914  0.918  0.918  0.914  0.917  0.915  0.911  0.912  0.911  0.910
  0.915  0.914  0.918  0.919  0.915  0.918  0.915  0.912  0.912  0.912  0.910
  0.915  0.915  0.918  0.920  0.915  0.918  0.916  0.912  0.913  0.912  0.910
    980    990   1000   1010   1020   1030   1040   1050   1060   1070   1080
  0.907  0.911  0.908  0.913  0.910  0.910  0.912  0.906  0.910  0.910  0.908
  0.909  0.912  0.908  0.913  0.914  0.911  0.914  0.909  0.911  0.910  0.908
  0.909  0.912  0.909  0.914  0.914  0.911  0.916  0.909  0.914  0.911  0.909
  0.911  0.912  0.909  0.915  0.915  0.912  0.917  0.909  0.915  0.911  0.909
  0.911  0.913  0.909  0.915  0.915  0.912  0.917  0.911  0.915  0.912  0.910
  0.912  0.914  0.910  0.916  0.916  0.914  0.917  0.912  0.915  0.913  0.911
  0.912  0.914  0.912  0.916  0.916  0.915  0.917  0.912  0.916  0.913  0.911
  0.912  0.915  0.912  0.917  0.917  0.916  0.918  0.912  0.916  0.914  0.911
  0.912  0.915  0.912  0.918  0.918  0.916  0.918  0.913  0.917  0.914  0.911
  0.913  0.915  0.913  0.918  0.918  0.916  0.918  0.913  0.917  0.915  0.911
   1090
  0.907
  0.908
  0.908
  0.908
  0.910
  0.910
  0.911
  0.911
  0.911
  0.911

> 
> ## compare training set dissimilarities with normals
> ## and derive cut-offs
> ik.dij <- dissim(ik.analog)
> plot(ik.dij)
> 
> 
> 
> cleanEx()
> nameEx("plot.mat")
> ### * plot.mat
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plot.mat
> ### Title: Plot diagnostics for a mat object
> ### Aliases: plot.mat
> ### Keywords: hplot methods
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## MAT
> ik.mat <- mat(ImbrieKipp, SumSST, method = "chord")
> ik.mat

	Modern Analogue Technique

Call:
mat(x = ImbrieKipp, y = SumSST, method = "chord") 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

Inferences based on the mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.875 0.931    0.284    6.000
  3 1.713 0.941    0.133    5.167
  4 1.796 0.935    0.177    5.125
  5 1.748 0.939    0.209    5.100
  6 1.716 0.943    0.284    5.667
  7 1.763 0.943    0.381    6.429
  8 1.831 0.941    0.390    6.625
  9 1.913 0.940    0.449    7.222
 10 2.040 0.935    0.577    7.500

Inferences based on the weighted mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.894 0.929    0.263    6.183
  3 1.733 0.940    0.138    5.470
  4 1.773 0.937    0.173    5.384
  5 1.750 0.939    0.187    5.366
  6 1.709 0.942    0.218    5.493
  7 1.712 0.942    0.254    5.635
  8 1.758 0.940    0.253    5.693
  9 1.777 0.939    0.274    5.838
 10 1.857 0.935    0.362    5.927

> summary(ik.mat)

	Modern Analogue Technique

Call:
mat(x = ImbrieKipp, y = SumSST, method = "chord") 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

Inferences based on the mean of k-closest analogues:

  k RMSEP   R2 Avg Bias Max Bias
  1  2.50 0.88     0.32     9.00
  2  1.87 0.93     0.28     6.00
  3  1.71 0.94     0.13     5.17
  4  1.80 0.94     0.18     5.12
  5  1.75 0.94     0.21     5.10
  6  1.72 0.94     0.28     5.67
  7  1.76 0.94     0.38     6.43
  8  1.83 0.94     0.39     6.62
  9  1.91 0.94     0.45     7.22
 10  2.04 0.93     0.58     7.50

Inferences based on the weighted mean of k-closest analogues:

  k RMSEP   R2 Avg Bias Max Bias
  1  2.50 0.88     0.32     9.00
  2  1.89 0.93     0.26     6.18
  3  1.73 0.94     0.14     5.47
  4  1.77 0.94     0.17     5.38
  5  1.75 0.94     0.19     5.37
  6  1.71 0.94     0.22     5.49
  7  1.71 0.94     0.25     5.63
  8  1.76 0.94     0.25     5.69
  9  1.78 0.94     0.27     5.84
 10  1.86 0.94     0.36     5.93

Results for training set

  * (W.)Est and (W.)Resi are based on k=10-closest analogues
  * minDC is the minimum distance to another sample in the training set
  * min(W.)Resi is the minimum residual for a k-closest model,
    where k = 1,...,10. Column k(.W) displays which k has minResi

           Obs    Est   Resi  W.Est   W.Resi  minDC  minResi   k  minW.Resi
V14.61     2.0   9.50   7.50   7.93   5.9273  0.104   5.1000   5   5.37e+00
V17.196    5.0   9.20   4.20   6.86   1.8572  0.130   0.1667   3   4.61e-01
V18.110    5.5   9.15   3.65   7.13   1.6290  0.134   0.5000   1   4.84e-01
V16.227    7.0   9.00   2.00   7.16   0.1554  0.134   0.1667   3   2.62e-02
V14.47     7.0   9.00   2.00   8.66   1.6594  0.452   0.0000   4   3.63e-02
V23.22    10.5   8.65  -1.85   8.68  -1.8229  0.467   0.5000   3   7.43e-01
V2.12     11.0   8.60  -2.40   5.70  -5.2971  0.119   2.4000  10   5.30e+00
V23.29    10.0  13.65   3.65  13.33   3.3347  0.467   1.2500   2   1.41e+00
V12.43    13.0  13.25   0.25  13.31   0.3135  0.490   0.0000   5   1.71e-01
R9.7      12.0  14.85   2.85  14.29   2.2876  0.432   1.0000   2   4.65e-01
A157.3    14.0  16.30   2.30  16.04   2.0418  0.407   0.5000   2   3.14e-01
V23.81    14.5  15.45   0.95  15.40   0.8996  0.299   0.1667   3   8.08e-02
V23.82    15.0  16.20   1.20  15.84   0.8369  0.299   0.1429   7   1.40e-01
V12.53    14.5  17.80   3.30  17.76   3.2607  0.442   2.3571   7   2.55e+00
V23.83    16.0  15.30  -0.70  15.02  -0.9814  0.295   0.7000  10   9.81e-01
V12.56    18.0  20.90   2.90  20.78   2.7832  0.380   1.0000   2   1.03e+00
A152.84   20.0  21.60   1.60  21.64   1.6374  0.361   0.1429   7   5.77e-01
V16.50    18.0  20.50   2.50  20.28   2.2759  0.429   0.0000   1   0.00e+00
V22.122   19.0  17.95  -1.05  17.58  -1.4223  0.429   1.0500  10   1.42e+00
V16.41    18.5  23.90   5.40  23.64   5.1402  0.380   2.5000   1   2.50e+00
V4.32     21.5  23.60   2.10  23.62   2.1185  0.333   1.6250   8   1.73e+00
V12.66    21.0  21.10   0.10  21.12   0.1228  0.421   0.0000   1   0.00e+00
V19.245   21.0  23.20   2.20  22.72   1.7177  0.331   0.1667   3   4.41e-01
V4.8      24.0  23.35  -0.65  23.38  -0.6203  0.280   0.0000   1   0.00e+00
A180.15   24.0  22.95  -1.05  22.99  -1.0083  0.292   0.0000   1   0.00e+00
V18.34    23.0  24.35   1.35  24.49   1.4904  0.411   1.3500  10   1.49e+00
V20.213   24.0  24.57   0.57  24.56   0.5565  0.326   0.0833   6   1.38e-01
V19.222   23.0  23.00   0.00  23.06   0.0580  0.384   0.0000  10   3.83e-02
A180.39   23.0  24.25   1.25  24.24   1.2366  0.347   0.4167   6   5.12e-01
V16.189   24.0  25.89   1.89  25.85   1.8495  0.399   1.0000   1   1.00e+00
V12.18    25.0  25.39   0.39  25.48   0.4751  0.289   0.3000   9   4.19e-01
V7.67     26.0  23.45  -2.55  23.76  -2.2436  0.308   0.0000   1   0.00e+00
V17.165   26.0  24.77  -1.23  24.80  -1.2021  0.308   0.0000   1   0.00e+00
V19.310   26.0  23.75  -2.25  23.97  -2.0257  0.296   0.0000   1   0.00e+00
V16.190   25.0  25.32   0.32  25.34   0.3424  0.324   0.0000   2   3.98e-02
A153.154  26.0  25.67  -0.33  25.73  -0.2694  0.222   0.1000   2   1.11e-01
V19.308   26.0  25.99  -0.01  25.98  -0.0223  0.222   0.0100  10   2.23e-02
V22.172   24.5  26.72   2.22  26.71   2.2110  0.307   1.5000   1   1.50e+00
V10.98    27.0  24.82  -2.18  24.77  -2.2349  0.330   2.0000   1   2.00e+00
V22.219   26.2  25.65  -0.55  25.63  -0.5709  0.189   0.2000   1   2.00e-01
V16.33    25.0  26.37   1.37  26.37   1.3703  0.493   0.7333   3   7.48e-01
V22.204   26.5  26.80   0.30  26.74   0.2362  0.325   0.0000   6   3.12e-02
V20.167   26.2  26.90   0.70  26.87   0.6732  0.257   0.0333   3   1.17e-02
V10.89    26.0  26.04   0.04  26.12   0.1184  0.308   0.0400  10   1.18e-01
V12.79    26.0  26.90   0.90  26.88   0.8813  0.249   0.3750   4   5.16e-01
V19.216   27.0  25.27  -1.73  25.32  -1.6776  0.363   0.9000   7   9.65e-01
V14.90    27.0  26.95  -0.05  26.89  -0.1113  0.249   0.0000   4   2.56e-02
A180.72   27.5  26.75  -0.75  26.74  -0.7623  0.185   0.4286   7   5.18e-01
V16.21    27.0  26.87  -0.13  26.85  -0.1453  0.247   0.0000   1   0.00e+00
A180.76   27.0  27.15   0.15  27.16   0.1582  0.233   0.0000   6   3.86e-02
V15.164   27.0  26.82  -0.18  26.79  -0.2081  0.257   0.0000   1   0.00e+00
A180.78   27.0  27.20   0.20  27.19   0.1940  0.405   0.0000   5   1.03e-04
V14.5     27.0  27.02   0.02  27.07   0.0730  0.219   0.0000   1   3.55e-15
V3.128    29.0  26.72  -2.28  26.69  -2.3050  0.366   2.1500   2   2.17e+00
A179.13   28.5  26.09  -2.41  26.13  -2.3699  0.327   1.8333   3   1.85e+00
V9.31     27.5  26.87  -0.63  26.92  -0.5805  0.309   0.0000   1   0.00e+00
V20.230   27.5  26.87  -0.63  26.90  -0.6015  0.291   0.1667   3   1.77e-01
V20.7     27.5  27.27  -0.23  27.25  -0.2452  0.431   0.0000   2   1.06e-03
V20.234   27.0  27.02   0.02  27.08   0.0788  0.228   0.0000   1   0.00e+00
V18.21    27.0  26.77  -0.23  26.87  -0.1318  0.252   0.0000   1   3.55e-15
V12.122   28.0  26.92  -1.08  26.94  -1.0561  0.228   0.9000   5   9.17e-01
          k.W
V14.61      5
V17.196     3
V18.110     2
V16.227     9
V14.47      6
V23.22      3
V2.12      10
V23.29      2
V12.43      5
R9.7        2
A157.3      2
V23.81      4
V23.82      7
V12.53      7
V23.83     10
V12.56      2
A152.84     7
V16.50      1
V22.122    10
V16.41      1
V4.32       8
V12.66      1
V19.245     4
V4.8        1
A180.15     1
V18.34     10
V20.213     6
V19.222     9
A180.39     6
V16.189     1
V12.18      9
V7.67       1
V17.165     1
V19.310     1
V16.190     3
A153.154    2
V19.308    10
V22.172     1
V10.98      1
V22.219     2
V16.33      3
V22.204     7
V20.167     4
V10.89     10
V12.79      4
V19.216     7
V14.90      4
A180.72     7
V16.21      1
A180.76     7
V15.164     1
A180.78     5
V14.5       1
V3.128      2
A179.13     3
V9.31       1
V20.230     3
V20.7       2
V20.234     1
V18.21      1
V12.122     5

> 
> ## summary plot of MAT model
> layout(matrix(1:4, ncol = 2, byrow = TRUE))
> plot(ik.mat)
> layout(1)
> 
> 
> 
> 
> cleanEx()
> nameEx("plot.mcarlo")
> ### * plot.mcarlo
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plot.mcarlo
> ### Title: Plot Monte Carlo simulated dissimilarity distributions
> ### Aliases: plot.mcarlo
> ### Keywords: hplot multivariate
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## perform the modified method of Sawada (2004) - paired sampling,
> ## with replacement
> ik.mcarlo <- mcarlo(ImbrieKipp, method = "chord", nsamp = 1000,
+                     type = "paired", replace = FALSE)
> ik.mcarlo

	Simulated Dissimilarities

Simulation type : paired 
No. simulations : 1000 
Coefficient     : chord 

Summary of simulated distribution:
    Min 1st Qu.  Median    Mean 3rd Qu.     Max 
 0.0917  1.2921  1.3694  1.2293  1.4052  1.4119 

Percentiles of simulated distribution:
    1%   2.5%     5%    10%    90%    95%  97.5%    99% 
0.0917 0.1035 0.1343 0.6572 1.4111 1.4115 1.4116 1.4119 

> 
> ## plot the simulated distribution
> layout(matrix(1:2, ncol = 1))
> plot(ik.mcarlo)
> layout(1)
> 
> 
> 
> cleanEx()
> nameEx("plot.minDC")
> ### * plot.minDC
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plot.minDC
> ### Title: Plot of minimum dissimilarity per sample
> ### Aliases: plot.minDC
> ### Keywords: hplot methods
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## fit the MAT model using the chord distance measure
> (ik.mat <- mat(ImbrieKipp, SumSST, method = "chord"))

	Modern Analogue Technique

Call:
mat(x = ImbrieKipp, y = SumSST, method = "chord") 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

Inferences based on the mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.875 0.931    0.284    6.000
  3 1.713 0.941    0.133    5.167
  4 1.796 0.935    0.177    5.125
  5 1.748 0.939    0.209    5.100
  6 1.716 0.943    0.284    5.667
  7 1.763 0.943    0.381    6.429
  8 1.831 0.941    0.390    6.625
  9 1.913 0.940    0.449    7.222
 10 2.040 0.935    0.577    7.500

Inferences based on the weighted mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.894 0.929    0.263    6.183
  3 1.733 0.940    0.138    5.470
  4 1.773 0.937    0.173    5.384
  5 1.750 0.939    0.187    5.366
  6 1.709 0.942    0.218    5.493
  7 1.712 0.942    0.254    5.635
  8 1.758 0.940    0.253    5.693
  9 1.777 0.939    0.274    5.838
 10 1.857 0.935    0.362    5.927

> 
> ## reconstruct for the RLGH core data
> v12.mat <- predict(ik.mat, V12.122)
> 
> ## extract the minimum DC values
> v12.mdc <- minDC(v12.mat)
> v12.mdc

	Minimum dissimilarity per sample

Dissimilarity: chord 

    0    10    20    30    40    50    60    70    80    90   100   110   120 
0.900 0.902 0.903 0.904 0.904 0.907 0.907 0.908 0.908 0.908 0.910 0.908 0.910 
  130   140   150   160   170   180   190   200   210   220   230   240   250 
0.909 0.911 0.908 0.908 0.906 0.908 0.909 0.906 0.907 0.906 0.906 0.906 0.906 
  260   270   280   290   300   310   320   330   340   350   360   370   380 
0.906 0.909 0.910 0.907 0.907 0.912 0.910 0.911 0.907 0.908 0.908 0.910 0.908 
  390   400   410   420   430   440   450   460   470   480   490   500   510 
0.910 0.907 0.911 0.906 0.909 0.905 0.906 0.907 0.906 0.909 0.907 0.906 0.911 
  520   530   540   550   560   570   580   590   600   610   620   630   640 
0.907 0.910 0.910 0.910 0.907 0.907 0.906 0.904 0.906 0.910 0.913 0.906 0.907 
  650   660   670   680   690   700   710   720   730   740   750   760   770 
0.906 0.910 0.911 0.913 0.907 0.909 0.909 0.912 0.914 0.908 0.907 0.909 0.911 
  780   790   800   810   820   830   840   850   860   870   880   890   900 
0.914 0.907 0.907 0.908 0.908 0.906 0.907 0.910 0.910 0.910 0.909 0.913 0.912 
  910   920   930   940   950   960   970   980   990  1000  1010  1020  1030 
0.908 0.909 0.909 0.907 0.910 0.909 0.908 0.907 0.911 0.908 0.913 0.910 0.910 
 1040  1050  1060  1070  1080  1090 
0.912 0.906 0.910 0.910 0.908 0.907 
> 
> ## draw a plot of minimum DC by time
> plot(v12.mdc, use.labels = TRUE, xlab = "Depth (cm.)")
> 
> 
> 
> cleanEx()
> nameEx("plot.prcurve")
> ### * plot.prcurve
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plot.prcurve
> ### Title: Plot a fitted principal curve in PCA space
> ### Aliases: plot.prcurve
> ### Keywords: hplot
> 
> ### ** Examples
> 
> ## Load the Abernethy Forest data
> data(abernethy)
> 
> ## Remove the Depth and Age variables
> abernethy2 <- abernethy[, -(37:38)]
> 
> ## Fit the principal curve using varying complexity of smoothers
> ## for each species
> aber.pc2 <- prcurve(abernethy2, method = "ca", trace = TRUE,
+                     vary = TRUE, penalty = 1.4)
--------------------------------------------------------------------------------
Initial curve: d.sq: 103233.4502
Iteration   1: d.sq: 4283.4308
Iteration   2: d.sq: 4312.2976
Iteration   3: d.sq: 4340.6911
Iteration   4: d.sq: 4355.3876
Iteration   5: d.sq: 4366.4975
Iteration   6: d.sq: 4369.9444
--------------------------------------------------------------------------------
PC Converged in 6 iterations.
--------------------------------------------------------------------------------
> 
> ## Plot the curve
> plot(aber.pc2, abernethy2)
> 
> 
> 
> cleanEx()
> nameEx("plot.residLen")
> ### * plot.residLen
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plot.residLen
> ### Title: Plot method for residual lengths
> ### Aliases: plot.residLen
> ### Keywords: hplot methods
> 
> ### ** Examples
> 
> ## load the Imbrie and Kipp example data
> data(ImbrieKipp, SumSST, V12.122)
> 
> ## squared residual lengths for Core V12.122
> rlens <- residLen(ImbrieKipp, SumSST, V12.122)
> rlens

	Squared residual lengths

Call: residLen(X = ImbrieKipp, env = SumSST, passive = V12.122)

Ordination Method: cca

Quantiles of residual lengths:

                50%  75%  90%  95%  99%
Training Set: 0.854 1.56 2.45 2.61 3.72
Passive:      1.004 1.50 1.87 2.17 2.55
> 
> ## plot a histogram of the residual distances
> plot(rlens)
> 
> 
> 
> 
> cleanEx()
> nameEx("plot.wa")
> ### * plot.wa
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plot.wa
> ### Title: Plot diagnostics for a weighted averaging model
> ### Aliases: plot.wa
> ### Keywords: hplot methods
> 
> ### ** Examples
> 
> ## continue the RLGH example from ?wa
> example(wa)

wa> data(ImbrieKipp)

wa> data(SumSST)

wa> ## fit the WA model
wa> mod <- wa(SumSST ~., data = ImbrieKipp)

wa> mod

	Weighted Averaging Transfer Function

Call:
wa(formula = SumSST ~ ., data = ImbrieKipp) 

Deshrinking  : Inverse 
Tolerance DW : No 
No. samples  : 61 
No. species  : 27 

Performance:
     RMSE  R-squared  Avg. Bias  Max. Bias  
   2.0188     0.9173     0.0000    -3.8155  


wa> ## extract the fitted values
wa> fitted(mod)
   V14.61   V17.196   V18.110   V16.227    V14.47    V23.22     V2.12    V23.29 
 3.730960  3.859921  4.107664  4.293906  8.287580  9.244409  4.076131 13.815481 
   V12.43      R9.7    A157.3    V23.81    V23.82    V12.53    V23.83    V12.56 
14.334514 16.521301 15.804396 18.736542 18.289596 18.458708 17.388560 20.401983 
  A152.84    V16.50   V22.122    V16.41     V4.32    V12.66   V19.245      V4.8 
19.969421 19.708591 18.781540 22.789225 22.407882 20.785492 22.454368 22.181405 
  A180.15    V18.34   V20.213   V19.222   A180.39   V16.189    V12.18     V7.67 
21.562333 23.337938 23.360786 22.844542 24.219277 25.625657 25.498810 23.377913 
  V17.165   V19.310   V16.190  A153.154   V19.308   V22.172    V10.98   V22.219 
23.747234 23.112465 24.516578 25.383739 25.796840 26.258495 24.162462 25.464444 
   V16.33   V22.204   V20.167    V10.89    V12.79   V19.216    V14.90   A180.72 
26.240175 25.824031 26.677965 26.394526 26.091336 25.719139 25.862682 26.338544 
   V16.21   A180.76   V15.164   A180.78     V14.5    V3.128   A179.13     V9.31 
26.789758 26.696906 26.821669 25.987374 26.882435 26.906235 26.515335 26.067970 
  V20.230     V20.7   V20.234    V18.21   V12.122 
26.608829 27.231642 26.765410 26.945937 26.833012 

wa> ## residuals for the training set
wa> residuals(mod)
     V14.61     V17.196     V18.110     V16.227      V14.47      V23.22 
-1.73095992  1.14007886  1.39233574  2.70609421 -1.28758014  1.25559075 
      V2.12      V23.29      V12.43        R9.7      A157.3      V23.81 
 6.92386910 -3.81548071 -1.33451363 -4.52130053 -1.80439553 -4.23654166 
     V23.82      V12.53      V23.83      V12.56     A152.84      V16.50 
-3.28959647 -3.95870813 -1.38855980 -2.40198307  0.03057864 -1.70859145 
    V22.122      V16.41       V4.32      V12.66     V19.245        V4.8 
 0.21846025 -4.28922519 -0.90788238  0.21450778 -1.45436796  1.81859450 
    A180.15      V18.34     V20.213     V19.222     A180.39     V16.189 
 2.43766723 -0.33793825  0.63921359  0.15545775 -1.21927713 -1.62565746 
     V12.18       V7.67     V17.165     V19.310     V16.190    A153.154 
-0.49880978  2.62208666  2.25276621  2.88753454  0.48342160  0.61626144 
    V19.308     V22.172      V10.98     V22.219      V16.33     V22.204 
 0.20316050 -1.75849478  2.83753826  0.73555554 -1.24017489  0.67596920 
    V20.167      V10.89      V12.79     V19.216      V14.90     A180.72 
-0.47796506 -0.39452607 -0.09133632  1.28086084  1.13731805  1.16145583 
     V16.21     A180.76     V15.164     A180.78       V14.5      V3.128 
 0.21024193  0.30309427  0.17833109  1.01262616  0.11756523  2.09376547 
    A179.13       V9.31     V20.230       V20.7     V20.234      V18.21 
 1.98466463  1.43202977  0.89117138  0.26835826  0.23458963  0.05406326 
    V12.122 
 1.16698821 

wa> ## deshrinking coefficients
wa> coef(mod)
[1] -5.687554  1.265881

wa> ## diagnostics plots
wa> par(mfrow = c(1,2))

wa> plot(mod)

wa> par(mfrow = c(1,1))

wa> ## tolerance DW
wa> mod2 <- wa(SumSST ~ ., data = ImbrieKipp, tol.dw = TRUE,
wa+            min.tol = 2, small.tol = "min")

wa> mod2

	Weighted Averaging Transfer Function

Call:
wa(formula = SumSST ~ ., data = ImbrieKipp, tol.dw = TRUE, small.tol = "min",  

     min.tol = 2) 

Deshrinking  : Inverse 
Tolerance DW : Yes 
No. samples  : 61 
No. species  : 27 

Performance:
     RMSE  R-squared  Avg. Bias  Max. Bias  
   2.0268     0.9166     0.0000    -2.4507  


wa> ## compare actual tolerances to working values
wa> with(mod2, rbind(tolerances, model.tol))
             O.univ  G.cglob  G.ruber  G.tenel  G.saccu  G.rubes   G.pacL
tolerances 3.746359 1.895600 1.909561 2.124799 1.979651 1.968294 3.941352
model.tol  3.746359 2.124799 2.124799 2.124799 2.124799 2.124799 3.941352
             G.pacR G.bullo  G.falco  G.calid  G.aequi  G.gluti  G.duter
tolerances 5.181162 5.82798 3.109193 2.973112 2.561697 5.898256 1.998304
model.tol  5.181162 5.82798 3.109193 2.973112 2.561697 5.898256 2.124799
            G.infla   G.trnL  G.trnR  G.crasf  G.scitu  G.mentu  P.obliq
tolerances 4.723884 4.161704 3.43492 3.354021 3.990673 2.386584 1.554762
model.tol  4.723884 4.161704 3.43492 3.354021 3.990673 2.386584 2.124799
            C.nitid S.dehis  G.digit    Other   G.quin  G.hirsu
tolerances 1.461725 3.84473 3.108881 5.112464 4.268777 3.942135
model.tol  2.124799 3.84473 3.108881 5.112464 4.268777 3.942135
> 
> ## diagnostics for the WA model
> par(mfrow = c(1,2))
> plot(mod)
> par(mfrow = c(1,1))
> 
> 
> 
> 
> graphics::par(get("par.postscript", pos = 'CheckExEnv'))
> cleanEx()
> nameEx("prcurve")
> ### * prcurve
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: prcurve
> ### Title: Fits a principal curve to m-dimensional data
> ### Aliases: prcurve initCurve smoothSpline
> ### Keywords: multivariate nonparametric smooth
> 
> ### ** Examples
> 
> data(abernethy)
> 
> ## Plot the most common taxa
> Stratiplot(Age ~ . - Depth, data =
+            chooseTaxa(abernethy, max.abun = 15, n.occ = 10),
+            type = c("g","poly"), sort = "wa")
> 
> ## Remove the Depth and Age variables
> abernethy2 <- abernethy[, -(37:38)]
> 
> ## Fit PCA and CA
> aber.pca <- rda(abernethy2)
> aber.ca <- cca(abernethy2)
> 
> ## Fit the principal curve using the median complexity over
> ## all species
> aber.pc <- prcurve(abernethy2, method = "ca", trace = TRUE,
+                    vary = FALSE, penalty = 1.4)
--------------------------------------------------------------------------------
Initial curve: d.sq: 103233.4502
Iteration   1: d.sq: 4853.7911
Iteration   2: d.sq: 5013.4971
Iteration   3: d.sq: 5109.9732
Iteration   4: d.sq: 5135.6541
Iteration   5: d.sq: 5137.9439
--------------------------------------------------------------------------------
PC Converged in 5 iterations.
--------------------------------------------------------------------------------
> 
> ## Fit the principal curve using varying complexity of smoothers
> ## for each species
> aber.pc2 <- prcurve(abernethy2, method = "ca", trace = TRUE,
+                     vary = TRUE, penalty = 1.4)
--------------------------------------------------------------------------------
Initial curve: d.sq: 103233.4502
Iteration   1: d.sq: 4283.4308
Iteration   2: d.sq: 4312.2976
Iteration   3: d.sq: 4340.6911
Iteration   4: d.sq: 4355.3876
Iteration   5: d.sq: 4366.4975
Iteration   6: d.sq: 4369.9444
--------------------------------------------------------------------------------
PC Converged in 6 iterations.
--------------------------------------------------------------------------------
> 
> 
> 
> cleanEx()
> nameEx("predict.mat")
> ### * predict.mat
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: predict.mat
> ### Title: Predict method for Modern Analogue Technique models
> ### Aliases: predict.mat print.predict.mat
> ### Keywords: methods
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## fit the MAT model using the chord distance measure
> (ik.mat <- mat(ImbrieKipp, SumSST, method = "chord"))

	Modern Analogue Technique

Call:
mat(x = ImbrieKipp, y = SumSST, method = "chord") 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

Inferences based on the mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.875 0.931    0.284    6.000
  3 1.713 0.941    0.133    5.167
  4 1.796 0.935    0.177    5.125
  5 1.748 0.939    0.209    5.100
  6 1.716 0.943    0.284    5.667
  7 1.763 0.943    0.381    6.429
  8 1.831 0.941    0.390    6.625
  9 1.913 0.940    0.449    7.222
 10 2.040 0.935    0.577    7.500

Inferences based on the weighted mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.894 0.929    0.263    6.183
  3 1.733 0.940    0.138    5.470
  4 1.773 0.937    0.173    5.384
  5 1.750 0.939    0.187    5.366
  6 1.709 0.942    0.218    5.493
  7 1.712 0.942    0.254    5.635
  8 1.758 0.940    0.253    5.693
  9 1.777 0.939    0.274    5.838
 10 1.857 0.935    0.362    5.927

> 
> ## predict for V12.122 data
> predict(ik.mat, V12.122)

	Modern Analogue Technique predictions

Dissimilarity: chord 
k-closest analogues: 3,	Chosen automatically? TRUE
Weighted mean: FALSE 
Bootstrap estimates: FALSE 

Model error estimates:
    RMSEP r.squared  avg.bias  max.bias 
   1.7130    0.9409    0.1328    5.1667 

Predicted values:
    0    10    20    30    40    50    60    70    80    90   100   110   120 
27.33 27.33 27.33 26.33 25.90 25.90 25.50 25.83 25.90 26.00 27.00 27.33 26.33 
  130   140   150   160   170   180   190   200   210   220   230   240   250 
27.17 26.50 25.57 26.57 26.57 27.23 27.17 26.33 25.90 27.50 27.33 27.73 26.00 
  260   270   280   290   300   310   320   330   340   350   360   370   380 
25.90 26.33 26.50 27.50 25.90 26.33 26.33 26.17 25.83 27.07 25.90 25.90 27.50 
  390   400   410   420   430   440   450   460   470   480   490   500   510 
26.83 27.00 27.73 27.17 27.50 27.17 27.00 27.40 25.90 26.83 27.67 27.33 27.00 
  520   530   540   550   560   570   580   590   600   610   620   630   640 
27.00 25.90 26.07 26.17 27.17 27.33 26.50 25.90 27.17 26.57 26.57 27.17 27.33 
  650   660   670   680   690   700   710   720   730   740   750   760   770 
27.17 26.83 27.00 26.83 27.17 26.90 27.40 26.17 27.83 27.00 26.83 26.83 27.40 
  780   790   800   810   820   830   840   850   860   870   880   890   900 
27.67 27.33 27.33 26.50 26.83 25.90 26.17 26.83 26.00 25.90 26.33 25.00 26.83 
  910   920   930   940   950   960   970   980   990  1000  1010  1020  1030 
26.17 26.50 27.33 27.33 26.73 27.50 27.33 27.33 27.33 26.17 27.33 26.17 26.17 
 1040  1050  1060  1070  1080  1090 
27.00 26.83 26.83 25.50 26.50 26.00 
> 
> 
> 
> 
> cleanEx()
> nameEx("predict.wa")
> ### * predict.wa
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: predict.wa
> ### Title: Predict from a weighted average model
> ### Aliases: predict.wa print.predict.wa
> ### Keywords: methods
> 
> ### ** Examples
> 
> ## Not run: 
> ##D ## Imbrie and Kipp
> ##D data(ImbrieKipp)
> ##D data(SumSST)
> ##D ik.wa <- wa(SumSST ~ ., data = ImbrieKipp, tol.dw = TRUE,
> ##D             min.tol = 2, small.tol = "min")
> ##D ik.wa
> ##D 
> ##D ## load V12.122 core data
> ##D data(V12.122)
> ##D V12.122 <- V12.122 / 100
> ##D 
> ##D ## predict summer sea-surface temperature for V12.122 core
> ##D v12.pred <- predict(ik.wa, V12.122, CV = "bootstrap", n.boot = 100)
> ##D 
> ##D ## draw the fitted reconstruction
> ##D reconPlot(v12.pred, use.labels = TRUE, display = "bars")
> ##D 
> ##D ## extract the model performance stats
> ##D performance(v12.pred)
> ## End(Not run)
> 
> 
> 
> 
> cleanEx()
> nameEx("reconPlot")
> ### * reconPlot
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: reconPlot
> ### Title: Stratigraphic plots of palaeoenvironmental reconstructions
> ### Aliases: reconPlot reconPlot.default reconPlot.predict.mat
> ###   reconPlot.predict.wa
> ### Keywords: hplot
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## Fit a MAT model
> (ik.mat <- mat(ImbrieKipp, SumSST, method = "chord"))

	Modern Analogue Technique

Call:
mat(x = ImbrieKipp, y = SumSST, method = "chord") 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

Inferences based on the mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.875 0.931    0.284    6.000
  3 1.713 0.941    0.133    5.167
  4 1.796 0.935    0.177    5.125
  5 1.748 0.939    0.209    5.100
  6 1.716 0.943    0.284    5.667
  7 1.763 0.943    0.381    6.429
  8 1.831 0.941    0.390    6.625
  9 1.913 0.940    0.449    7.222
 10 2.040 0.935    0.577    7.500

Inferences based on the weighted mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.894 0.929    0.263    6.183
  3 1.733 0.940    0.138    5.470
  4 1.773 0.937    0.173    5.384
  5 1.750 0.939    0.187    5.366
  6 1.709 0.942    0.218    5.493
  7 1.712 0.942    0.254    5.635
  8 1.758 0.940    0.253    5.693
  9 1.777 0.939    0.274    5.838
 10 1.857 0.935    0.362    5.927

> 
> ## Reconstruct pH for the RLGH core
> v12.pH <- predict(ik.mat, V12.122)
> 
> ## draw the reconstruction
> reconPlot(v12.pH, use.labels = TRUE, display.error = "bars",
+           xlab = "Depth", ylab = "Summer Seas-surface Temperature")
> 
> 
> 
> cleanEx()
> nameEx("residLen")
> ### * residLen
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: residLen
> ### Title: Squared residual length diagnostics
> ### Aliases: residLen print.residLen fittedY sqrlLinear sqrlUnimodal
> ### Keywords: methods multivariate
> 
> ### ** Examples
> 
> ## load the Imbrie and Kipp example data
> data(ImbrieKipp, SumSST, V12.122)
> 
> ## squared residual lengths for Core V12.122
> rlens <- residLen(ImbrieKipp, SumSST, V12.122)
> rlens

	Squared residual lengths

Call: residLen(X = ImbrieKipp, env = SumSST, passive = V12.122)

Ordination Method: cca

Quantiles of residual lengths:

                50%  75%  90%  95%  99%
Training Set: 0.854 1.56 2.45 2.61 3.72
Passive:      1.004 1.50 1.87 2.17 2.55
> 
> ## as before but using linear RDA
> residLen(ImbrieKipp, SumSST, V12.122, method = "rda")

	Squared residual lengths

Call: residLen(X = ImbrieKipp, env = SumSST, passive = V12.122, method
= "rda")

Ordination Method: rda

Quantiles of residual lengths:

                   50%      75%     90%    95%      99%
Training Set: 17.44163 40.33589 80.6058 85.394 103.8648
Passive:       0.00773  0.00909  0.0107  0.011   0.0123
> 
> 
> 
> cleanEx()
> nameEx("rlgh")
> ### * rlgh
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rlgh
> ### Title: Round Loch of Glenhead Diatoms
> ### Aliases: rlgh
> ### Keywords: datasets
> 
> ### ** Examples
> 
> data(rlgh)
> 
> 
> 
> cleanEx()
> nameEx("roc")
> ### * roc
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: roc
> ### Title: ROC curve analysis
> ### Aliases: roc roc.default roc.mat roc.analog print.roc summary.roc
> ###   print.summary.roc
> ### Keywords: models multivariate methods
> 
> ### ** Examples
> 
> ## load the example data
> data(swapdiat, swappH, rlgh)
> 
> ## merge training and test set on columns
> dat <- join(swapdiat, rlgh, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:  167  277
Data set 2:  101  139
Merged:      268  277

> 
> ## extract the merged data sets and convert to proportions
> swapdiat <- dat[[1]] / 100
> rlgh <- dat[[2]] / 100
> 
> ## fit an analogue matching (AM) model using the squared chord distance
> ## measure - need to keep the training set dissimilarities
> swap.ana <- analog(swapdiat, rlgh, method = "SQchord",
+                    keep.train = TRUE)
> 
> ## fit the ROC curve to the SWAP diatom data using the AM results
> ## Generate a grouping for the SWAP lakes
> clust <- hclust(as.dist(swap.ana$train), method = "ward")
> grps <- cutree(clust, 12)
> 
> ## fit the ROC curve
> swap.roc <- roc(swap.ana, groups = grps)
> swap.roc

	ROC curve of dissimilarities

Discrimination for all groups:

Optimal Dissimilarity = 0.575 

AUC = 0.998, p-value: < 2.22e-16
No. within: 167   No. outside: 1837 

> 
> ## draw the ROC curve
> plot(swap.roc, 1)
> 
> ## draw the four default diagnostic plots
> layout(matrix(1:4, ncol = 2))
> plot(swap.roc)
> layout(1)
> 
> 
> 
> cleanEx()
> nameEx("screeplot")
> ### * screeplot
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: screeplot
> ### Title: Screeplots of model results
> ### Aliases: screeplot.mat screeplot.bootstrap.mat
> ### Keywords: hplot methods
> 
> ### ** Examples
> 
> ## Imbrie and Kipp example
> ## load the example data
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training and test set on columns
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> V12.122 <- dat[[2]] / 100
> 
> ## fit the MAT model using the chord distance measure
> (ik.mat <- mat(ImbrieKipp, SumSST, method = "chord"))

	Modern Analogue Technique

Call:
mat(x = ImbrieKipp, y = SumSST, method = "chord") 

Percentiles of the dissimilarities for the training set:

   1%    2%    5%   10%   20% 
0.220 0.280 0.341 0.414 0.501 

Inferences based on the mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.875 0.931    0.284    6.000
  3 1.713 0.941    0.133    5.167
  4 1.796 0.935    0.177    5.125
  5 1.748 0.939    0.209    5.100
  6 1.716 0.943    0.284    5.667
  7 1.763 0.943    0.381    6.429
  8 1.831 0.941    0.390    6.625
  9 1.913 0.940    0.449    7.222
 10 2.040 0.935    0.577    7.500

Inferences based on the weighted mean of k-closest analogues:

  k RMSEP    R2 Avg Bias Max Bias
  1 2.501 0.880    0.321    9.000
  2 1.894 0.929    0.263    6.183
  3 1.733 0.940    0.138    5.470
  4 1.773 0.937    0.173    5.384
  5 1.750 0.939    0.187    5.366
  6 1.709 0.942    0.218    5.493
  7 1.712 0.942    0.254    5.635
  8 1.758 0.940    0.253    5.693
  9 1.777 0.939    0.274    5.838
 10 1.857 0.935    0.362    5.927

> 
> screeplot(ik.mat)
> 
> 
> 
> cleanEx()
> nameEx("stdError")
> ### * stdError
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: stdError
> ### Title: Standard error of MAT fitted and predicted values
> ### Aliases: stdError stdError.mat stdError.predict.mat
> ### Keywords: methods univar
> 
> ### ** Examples
> 
> ## Imbrie and Kipp Sea Surface Temperature
> data(ImbrieKipp)
> data(SumSST)
> data(V12.122)
> 
> ## merge training set and core samples
> dat <- join(ImbrieKipp, V12.122, verbose = TRUE)

Summary:

            Rows Cols
Data set 1:   61   27
Data set 2:  110   30
Merged:      171   30

> 
> ## extract the merged data sets and convert to proportions
> ImbrieKipp <- dat[[1]] / 100
> ImbrieKippCore <- dat[[2]] / 100
> 
> ## fit the MAT model using the squared chord distance measure
> ik.mat <- mat(ImbrieKipp, SumSST, method = "SQchord")
> 
> ## standard errors
> stdError(ik.mat)
   V14.61   V17.196   V18.110   V16.227    V14.47    V23.22     V2.12    V23.29 
2.9570077 2.2342181 2.0330039 2.8513418 2.2138447 2.4593532 2.3161163 0.8285100 
   V12.43      R9.7    A157.3    V23.81    V23.82    V12.53    V23.83    V12.56 
1.8521500 2.9870952 1.3093628 1.4874007 1.5322853 2.1145062 0.4004632 2.4418377 
  A152.84    V16.50   V22.122    V16.41     V4.32    V12.66   V19.245      V4.8 
2.7213261 1.8144450 1.6398700 2.2182611 0.0000000 0.8432195 1.9932477 1.7840542 
  A180.15    V18.34   V20.213   V19.222   A180.39   V16.189    V12.18     V7.67 
2.3981335 1.3210885 2.0899961 1.8534830 0.8091183 0.5628718 0.1068089 0.8383123 
  V17.165   V19.310   V16.190  A153.154   V19.308   V22.172    V10.98   V22.219 
0.9361208 0.8748343 1.6496071 0.4790917 0.4814322 0.4293269 1.2054665 0.4599242 
   V16.33   V22.204   V20.167    V10.89    V12.79   V19.216    V14.90   A180.72 
1.2390022 1.1486092 1.1037839 0.9112438 0.4250058 0.8771831 0.6509596 0.4911457 
   V16.21   A180.76   V15.164   A180.78     V14.5    V3.128   A179.13     V9.31 
0.4907379 0.2565399 0.3519882 0.6308207 0.4650968 1.1928807 0.4847921 0.2452820 
  V20.230     V20.7   V20.234    V18.21   V12.122 
0.2428485 0.4741689 0.4771624 0.4564864 0.0000000 
attr(,"class")
[1] "stdError"
> 
> ## reconstruct for the V12-122 core data
> coreV12.mat <- predict(ik.mat, V12.122, k = 3)
> ## standard errors
> stdError(coreV12.mat)
        0        10        20        30        40        50        60        70 
0.6666560 0.5127652 0.4940833 1.3084467 1.0824814 1.0650554 0.7312066 1.0129625 
       80        90       100       110       120       130       140       150 
1.1916917 1.1149534 0.4033714 0.2334125 1.3081399 0.2394602 1.4197788 0.7572307 
      160       170       180       190       200       210       220       230 
0.6499565 0.6538152 0.9742193 0.2401338 1.3854266 1.8150936 0.4194549 0.5012481 
      240       250       260       270       280       290       300       310 
1.1805085 1.0541290 1.0460351 1.2970070 1.5004813 0.4862513 1.0462475 0.9377745 
      320       330       340       350       360       370       380       390 
1.2997606 1.1837605 1.0368135 0.6092353 1.0319833 1.0469552 0.4029888 1.8028169 
      400       410       420       430       440       450       460       470 
0.3996499 1.1499003 0.2427915 0.4139073 0.2583339 0.0000000 1.2141587 1.0439356 
      480       490       500       510       520       530       540       550 
0.2338637 0.9428443 0.4827475 0.4148127 0.3879866 1.0328590 0.0937982 0.8497036 
      560       570       580       590       600       610       620       630 
0.2416557 0.2278804 0.4058629 0.9718368 0.2303837 0.7352933 0.3277687 0.2261525 
      640       650       660       670       680       690       700       710 
0.4791844 0.6390568 0.2347800 0.4065762 1.8441614 1.0495782 0.7924059 1.1846794 
      720       730       740       750       760       770       780       790 
1.2390412 0.8534425 0.4012654 0.2426828 0.2340115 1.1977802 0.9582384 0.4754369 
      800       810       820       830       840       850       860       870 
0.4855805 1.4611535 0.2325244 1.1660600 0.8679123 0.4122362 1.0629969 1.0521058 
      880       890       900       910       920       930       940       950 
1.2560759 1.6556741 0.5943474 0.8451956 0.9962813 0.2244707 0.2450447 0.3782048 
      960       970       980       990      1000      1010      1020      1030 
0.4063936 0.2338417 0.2274927 0.2340763 1.1603260 0.2382300 0.8493407 1.1706837 
     1040      1050      1060      1070      1080      1090 
0.4089408 1.0715114 0.2426835 1.0801634 1.4499069 1.0887329 
attr(,"class")
[1] "stdError"
attr(,"k")
[1] 3
attr(,"k")attr(,"auto")
[1] FALSE
attr(,"k")attr(,"weighted")
[1] FALSE
attr(,"auto")
[1] FALSE
> 
> 
> 
> cleanEx()
> nameEx("summary.analog")
> ### * summary.analog
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summary.analog
> ### Title: Summarise analogue matching results
> ### Aliases: summary.analog print.summary.analog
> ### Keywords: methods
> 
> ### ** Examples
> 
> ## Not run: 
> ##D ## continue the RLGH example from ?join
> ##D example(join)
> ##D 
> ##D ## analog matching between SWAP and RLGH core
> ##D swap.analog <- analog(swapdiat, rlgh, method = "chord")
> ##D swap.analog
> ##D summary(swap.analog)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("summary.bootstrap.mat")
> ### * summary.bootstrap.mat
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summary.bootstrap.mat
> ### Title: Summarise bootstrap resampling for MAT models
> ### Aliases: summary.bootstrap.mat print.summary.bootstrap.mat
> ### Keywords: methods
> 
> ### ** Examples
> 
> ## Not run: 
> ##D ## continue the RLGH example from ?join
> ##D example(join)
> ##D 
> ##D ## fit the MAT model using the squared chord distance measure
> ##D swap.mat <- mat(swapdiat, swappH, method = "SQchord")
> ##D 
> ##D ## bootstrap training set
> ##D swap.boot <- bootstrap(swap.mat, k = 10, n.boot = 100)
> ##D swap.boot
> ##D summary(swap.boot)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("summary.cma")
> ### * summary.cma
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summary.cma
> ### Title: Summarise the extraction of close modern analogues
> ### Aliases: summary.cma print.summary.cma
> ### Keywords: methods
> 
> ### ** Examples
> 
> ## Not run: 
> ##D ## continue the RLGH example from ?join
> ##D example(join)
> ##D 
> ##D ## analog matching between SWAP and RLGH core
> ##D swap.analog <- analog(swapdiat, rlgh, method = "chord")
> ##D swap.analog
> ##D summary(swap.analog)
> ##D 
> ##D ## close modern analogues
> ##D swap.cma <- cma(swap.analog, cutoff = 0.6)
> ##D swap.cma
> ##D summary(swap.cma)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("summary.mat")
> ### * summary.mat
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summary.mat
> ### Title: Summarise Modern Analogue Technique models
> ### Aliases: summary.mat print.summary.mat
> ### Keywords: methods
> 
> ### ** Examples
> 
> ## Not run: 
> ##D ## continue the RLGH example from ?join
> ##D example(join)
> ##D 
> ##D ## fit the MAT model using the squared chord distance measure
> ##D swap.mat <- mat(swapdiat, swappH, method = "SQchord")
> ##D swap.mat
> ##D 
> ##D ## model summary
> ##D summary(swap.mat)
> ##D 
> ##D ## model summary - evaluating models using k = 1, ..., 20
> ##D ## analogues instead of the default, 10.
> ##D summary(swap.mat, k = 20)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("summary.predict.mat")
> ### * summary.predict.mat
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summary.predict.mat
> ### Title: Summarise MAT model predictions
> ### Aliases: summary.predict.mat print.summary.predict.mat
> ### Keywords: methods
> 
> ### ** Examples
> 
> ## Not run: 
> ##D ## continue the RLGH example from ?join
> ##D example(join)
> ##D 
> ##D ## fit the MAT model using the squared chord distance measure
> ##D swap.mat <- mat(swapdiat, swappH, method = "SQchord")
> ##D 
> ##D ## predict for RLGH data
> ##D swap.pred <- predict(swap.mat, rlgh, bootstrap = FALSE)
> ##D summary(swap.pred)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("swapdiat")
> ### * swapdiat
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: swapdiat
> ### Title: SWAP sub-fossil diatom and pH training set
> ### Aliases: swapdiat
> ### Keywords: datasets
> 
> ### ** Examples
> 
> data(swapdiat)
> 
> 
> 
> cleanEx()
> nameEx("swappH")
> ### * swappH
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: swappH
> ### Title: SWAP sub-fossil diatom and pH training set
> ### Aliases: swappH
> ### Keywords: datasets
> 
> ### ** Examples
> 
> data(swappH)
> str(swappH)
 Named num [1:167] 4.49 5.26 4.9 6.43 5.68 ...
 - attr(*, "names")= chr [1:167] "1.21" "10.21" "11" "113.21" ...
> 
> 
> 
> cleanEx()
> nameEx("timetrack")
> ### * timetrack
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: timetrack
> ### Title: Timetracks of change in species composition
> ### Aliases: timetrack print.timetrack plot.timetrack fitted.timetrack
> ### Keywords: methods hplot
> 
> ### ** Examples
> 
> ## load the RLGH and SWAP data sets
> data(rlgh, swapdiat)
> 
> ## Fit the timetrack ordination
> mod <- timetrack(swapdiat, rlgh, transform = "hellinger",
+                  method = "rda")
> mod

	Timetrack Ordination

Call: timetrack(X = swapdiat, passive = rlgh, method = "rda", transform
= "hellinger")

Ordination Output:
Call: rda(X = X)

              Inertia Rank
Total          0.6163     
Unconstrained  0.6163  166
Inertia is variance 

Eigenvalues for unconstrained axes:
    PC1     PC2     PC3     PC4     PC5     PC6     PC7     PC8 
0.11915 0.05669 0.03734 0.03336 0.02803 0.02362 0.01917 0.01520 
(Showed only 8 of all 166 unconstrained eigenvalues)

> 
> ## Plot the timetrack
> plot(mod)
> 
> 
> 
> cleanEx()
> nameEx("tran")
> ### * tran
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: tran
> ### Title: Common data transformations and standardizations
> ### Aliases: tran tran.default tran.formula
> ### Keywords: multivariate manip methods
> 
> ### ** Examples
> 
> data(swapdiat)
> ## convert percentages to proportions
> sptrans <- tran(swapdiat, "pcent2prop")
> 
> ## apply Hellinger transformation
> spHell <- tran(swapdiat, "hellinger")
> 
> ## Dummy data to illustrate formula method
> d <- data.frame(A = runif(10), B = runif(10), C = runif(10))
> ## simulate some missings
> d[sample(10,3), 1] <- NA
> ## apply tran using formula
> tran(~ . - B, data = d, na.action = na.pass,
+      method = "missing", na.value = 0)
            A          C
1  0.26550866 0.93470523
2  0.37212390 0.21214252
3  0.57285336 0.65167377
4  0.00000000 0.12555510
5  0.00000000 0.26722067
6  0.00000000 0.38611409
7  0.94467527 0.01339033
8  0.66079779 0.38238796
9  0.62911404 0.86969085
10 0.06178627 0.34034900
> 
> 
> 
> cleanEx()
> nameEx("varExpl")
> ### * varExpl
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: varExpl
> ### Title: Variance explained by ordination axes
> ### Aliases: varExpl varExpl.default varExpl.cca varExpl.prcurve
> ### Keywords: multivariate utility
> 
> ### ** Examples
> 
> 
> data(abernethy)
> 
> ## Remove the Depth and Age variables
> abernethy2 <- abernethy[, -(37:38)]
> 
> ## Fit PCA
> aber.pca <- rda(abernethy2)
> 
> ## Distance along the first PCA axis
> varExpl(aber.pca)
      PC1 
0.4649883 
> 
> 
> 
> cleanEx()
> nameEx("wa")
> ### * wa
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: wa
> ### Title: Weighted averaging transfer functions
> ### Aliases: wa wa.default wa.formula print.wa fitted.wa residuals.wa
> ###   coef.wa waFit
> ### Keywords: methods models regression multivariate
> 
> ### ** Examples
> 
> data(ImbrieKipp)
> data(SumSST)
> 
> ## fit the WA model
> mod <- wa(SumSST ~., data = ImbrieKipp)
> mod

	Weighted Averaging Transfer Function

Call:
wa(formula = SumSST ~ ., data = ImbrieKipp) 

Deshrinking  : Inverse 
Tolerance DW : No 
No. samples  : 61 
No. species  : 27 

Performance:
     RMSE  R-squared  Avg. Bias  Max. Bias  
   2.0188     0.9173     0.0000    -3.8155  

> 
> ## extract the fitted values
> fitted(mod)
   V14.61   V17.196   V18.110   V16.227    V14.47    V23.22     V2.12    V23.29 
 3.730960  3.859921  4.107664  4.293906  8.287580  9.244409  4.076131 13.815481 
   V12.43      R9.7    A157.3    V23.81    V23.82    V12.53    V23.83    V12.56 
14.334514 16.521301 15.804396 18.736542 18.289596 18.458708 17.388560 20.401983 
  A152.84    V16.50   V22.122    V16.41     V4.32    V12.66   V19.245      V4.8 
19.969421 19.708591 18.781540 22.789225 22.407882 20.785492 22.454368 22.181405 
  A180.15    V18.34   V20.213   V19.222   A180.39   V16.189    V12.18     V7.67 
21.562333 23.337938 23.360786 22.844542 24.219277 25.625657 25.498810 23.377913 
  V17.165   V19.310   V16.190  A153.154   V19.308   V22.172    V10.98   V22.219 
23.747234 23.112465 24.516578 25.383739 25.796840 26.258495 24.162462 25.464444 
   V16.33   V22.204   V20.167    V10.89    V12.79   V19.216    V14.90   A180.72 
26.240175 25.824031 26.677965 26.394526 26.091336 25.719139 25.862682 26.338544 
   V16.21   A180.76   V15.164   A180.78     V14.5    V3.128   A179.13     V9.31 
26.789758 26.696906 26.821669 25.987374 26.882435 26.906235 26.515335 26.067970 
  V20.230     V20.7   V20.234    V18.21   V12.122 
26.608829 27.231642 26.765410 26.945937 26.833012 
> 
> ## residuals for the training set
> residuals(mod)
     V14.61     V17.196     V18.110     V16.227      V14.47      V23.22 
-1.73095992  1.14007886  1.39233574  2.70609421 -1.28758014  1.25559075 
      V2.12      V23.29      V12.43        R9.7      A157.3      V23.81 
 6.92386910 -3.81548071 -1.33451363 -4.52130053 -1.80439553 -4.23654166 
     V23.82      V12.53      V23.83      V12.56     A152.84      V16.50 
-3.28959647 -3.95870813 -1.38855980 -2.40198307  0.03057864 -1.70859145 
    V22.122      V16.41       V4.32      V12.66     V19.245        V4.8 
 0.21846025 -4.28922519 -0.90788238  0.21450778 -1.45436796  1.81859450 
    A180.15      V18.34     V20.213     V19.222     A180.39     V16.189 
 2.43766723 -0.33793825  0.63921359  0.15545775 -1.21927713 -1.62565746 
     V12.18       V7.67     V17.165     V19.310     V16.190    A153.154 
-0.49880978  2.62208666  2.25276621  2.88753454  0.48342160  0.61626144 
    V19.308     V22.172      V10.98     V22.219      V16.33     V22.204 
 0.20316050 -1.75849478  2.83753826  0.73555554 -1.24017489  0.67596920 
    V20.167      V10.89      V12.79     V19.216      V14.90     A180.72 
-0.47796506 -0.39452607 -0.09133632  1.28086084  1.13731805  1.16145583 
     V16.21     A180.76     V15.164     A180.78       V14.5      V3.128 
 0.21024193  0.30309427  0.17833109  1.01262616  0.11756523  2.09376547 
    A179.13       V9.31     V20.230       V20.7     V20.234      V18.21 
 1.98466463  1.43202977  0.89117138  0.26835826  0.23458963  0.05406326 
    V12.122 
 1.16698821 
> 
> ## deshrinking coefficients
> coef(mod)
[1] -5.687554  1.265881
> 
> ## diagnostics plots
> par(mfrow = c(1,2))
> plot(mod)
> par(mfrow = c(1,1))
> 
> ## tolerance DW
> mod2 <- wa(SumSST ~ ., data = ImbrieKipp, tol.dw = TRUE,
+            min.tol = 2, small.tol = "min")
> mod2

	Weighted Averaging Transfer Function

Call:
wa(formula = SumSST ~ ., data = ImbrieKipp, tol.dw = TRUE, small.tol = "min",  

     min.tol = 2) 

Deshrinking  : Inverse 
Tolerance DW : Yes 
No. samples  : 61 
No. species  : 27 

Performance:
     RMSE  R-squared  Avg. Bias  Max. Bias  
   2.0268     0.9166     0.0000    -2.4507  

> 
> ## compare actual tolerances to working values
> with(mod2, rbind(tolerances, model.tol))
             O.univ  G.cglob  G.ruber  G.tenel  G.saccu  G.rubes   G.pacL
tolerances 3.746359 1.895600 1.909561 2.124799 1.979651 1.968294 3.941352
model.tol  3.746359 2.124799 2.124799 2.124799 2.124799 2.124799 3.941352
             G.pacR G.bullo  G.falco  G.calid  G.aequi  G.gluti  G.duter
tolerances 5.181162 5.82798 3.109193 2.973112 2.561697 5.898256 1.998304
model.tol  5.181162 5.82798 3.109193 2.973112 2.561697 5.898256 2.124799
            G.infla   G.trnL  G.trnR  G.crasf  G.scitu  G.mentu  P.obliq
tolerances 4.723884 4.161704 3.43492 3.354021 3.990673 2.386584 1.554762
model.tol  4.723884 4.161704 3.43492 3.354021 3.990673 2.386584 2.124799
            C.nitid S.dehis  G.digit    Other   G.quin  G.hirsu
tolerances 1.461725 3.84473 3.108881 5.112464 4.268777 3.942135
model.tol  2.124799 3.84473 3.108881 5.112464 4.268777 3.942135
> 
> 
> 
> graphics::par(get("par.postscript", pos = 'CheckExEnv'))
> cleanEx()
> nameEx("weightedCor")
> ### * weightedCor
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: weightedCor
> ### Title: Weighted correlation test of WA reconstruction
> ### Aliases: weightedCor weightedCor.default print.weightedCor
> ###   plot.weightedCor
> ### Keywords: ~kwd1 ~kwd2
> 
> ### ** Examples
> 
> data(ImbrieKipp, SumSST, V12.122)
> 
> Cor <- weightedCor(ImbrieKipp, env = SumSST,
+                    fossil = V12.122, type = "simulate", sim = 49)
Simulating 49 Weighted Correlations:
  |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   8%  |                                                                              |=======                                                               |  10%  |                                                                              |=========                                                             |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |=============                                                         |  18%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  31%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  35%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  39%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  45%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  53%  |                                                                              |=======================================                               |  55%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  59%  |                                                                              |===========================================                           |  61%  |                                                                              |============================================                          |  63%  |                                                                              |==============================================                        |  65%  |                                                                              |===============================================                       |  67%  |                                                                              |=================================================                     |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  73%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  78%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  82%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |===================================================================   |  96%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%

> Cor

	Weighted correlation of WA Transfer Function

Call:
weightedCor(x = ImbrieKipp, env = SumSST, fossil = V12.122, type = "simulate", 
    sim = 49)

Test Type           : Simulation
Weighted Correlation: 0.491 (p = 0.56)
Correlation         : 0.437 (p = < 2.22e-16)

> 
> plot(Cor)
> plot(Cor, type = "null")
> 
> 
> 
> ### * <FOOTER>
> ###
> cat("Time elapsed: ", proc.time() - get("ptime", pos = 'CheckExEnv'),"\n")
Time elapsed:  25.603 1.419 27.033 0 0 
> grDevices::dev.off()
null device 
          1 
> ###
> ### Local variables: ***
> ### mode: outline-minor ***
> ### outline-regexp: "\\(> \\)?### [*]+" ***
> ### End: ***
> quit('no')
